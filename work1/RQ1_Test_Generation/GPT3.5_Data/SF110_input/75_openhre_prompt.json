[
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_0Test.java",
    "test_prompt": "// ClientHttpRequest_0Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post()} method.\n*/\nclass ClientHttpRequest_0Test {",
    "method_signature": "post()",
    "suffix": "0"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_1Test.java",
    "test_prompt": "// ClientHttpRequest_1Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(Map)} method.\n*/\nclass ClientHttpRequest_1Test {",
    "method_signature": "post(Map)",
    "suffix": "1"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_2Test.java",
    "test_prompt": "// ClientHttpRequest_2Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(Object[])} method.\n*/\nclass ClientHttpRequest_2Test {",
    "method_signature": "post(Object[])",
    "suffix": "2"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_3Test.java",
    "test_prompt": "// ClientHttpRequest_3Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(Map, Map)} method.\n*/\nclass ClientHttpRequest_3Test {",
    "method_signature": "post(Map, Map)",
    "suffix": "3"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_4Test.java",
    "test_prompt": "// ClientHttpRequest_4Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(String[], Object[])} method.\n*/\nclass ClientHttpRequest_4Test {",
    "method_signature": "post(String[], Object[])",
    "suffix": "4"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_5Test.java",
    "test_prompt": "// ClientHttpRequest_5Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(String, Object)} method.\n*/\nclass ClientHttpRequest_5Test {",
    "method_signature": "post(String, Object)",
    "suffix": "5"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_6Test.java",
    "test_prompt": "// ClientHttpRequest_6Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(String, Object, String, Object)} method.\n*/\nclass ClientHttpRequest_6Test {",
    "method_signature": "post(String, Object, String, Object)",
    "suffix": "6"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_7Test.java",
    "test_prompt": "// ClientHttpRequest_7Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(String, Object, String, Object, String, Object)} method.\n*/\nclass ClientHttpRequest_7Test {",
    "method_signature": "post(String, Object, String, Object, String, Object)",
    "suffix": "7"
  },
  {
    "numberTests": "ten",
    "original_code": "// ClientHttpRequest.java\n/*\n *   CVS $Id: ClientHttpRequest.java,v 1.1 2007/01/11 04:14:37 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006, 2007 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\n\n/**\n * \u003cp\u003eTitle: Client HTTP Request class\u003c/p\u003e\n * \u003cp\u003eDescription: this class helps to send POST HTTP requests with various form data,\n * including files. Cookies can be added to be included in the request.\u003c/p\u003e\n *\n * @author Vlad Patryshev\n * @version 1.0\n */\npublic class ClientHttpRequest {\n\n    URLConnection connection;\n\n    OutputStream os \u003d null;\n\n    Map cookies \u003d new HashMap();\n\n    protected void connect() throws IOException {\n        if (os \u003d\u003d null)\n            os \u003d connection.getOutputStream();\n    }\n\n    protected void write(char c) throws IOException {\n        connect();\n        os.write(c);\n    }\n\n    protected void write(String s) throws IOException {\n        connect();\n        os.write(s.getBytes());\n    }\n\n    protected void newline() throws IOException {\n        connect();\n        write(\"\\r\\n\");\n    }\n\n    protected void writeln(String s) throws IOException {\n        connect();\n        write(s);\n        newline();\n    }\n\n    private static Random random \u003d new Random();\n\n    protected static String randomString() {\n        return Long.toString(random.nextLong(), 36);\n    }\n\n    String boundary \u003d \"---------------------------\" + randomString() + randomString() + randomString();\n\n    private void boundary() throws IOException {\n        write(\"--\");\n        write(boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request on a freshly opened URLConnection\n     *\n     * @param connection an already open URL connection\n     * @throws IOException\n     */\n    public ClientHttpRequest(URLConnection connection) throws IOException {\n        this.connection \u003d connection;\n        connection.setDoOutput(true);\n        connection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary\u003d\" + boundary);\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL\n     *\n     * @param url the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(URL url) throws IOException {\n        this(url.openConnection());\n    }\n\n    /**\n     * Creates a new multipart POST HTTP request for a specified URL string\n     *\n     * @param urlString the string representation of the URL to send request to\n     * @throws IOException\n     */\n    public ClientHttpRequest(String urlString) throws IOException {\n        this(new URL(urlString));\n    }\n\n    private void postCookies() {\n        StringBuffer cookieList \u003d new StringBuffer();\n        for (Iterator i \u003d cookies.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) (i.next());\n            cookieList.append(entry.getKey().toString() + \"\u003d\" + entry.getValue());\n            if (i.hasNext()) {\n                cookieList.append(\"; \");\n            }\n        }\n        if (cookieList.length() \u003e 0) {\n            connection.setRequestProperty(\"Cookie\", cookieList.toString());\n        }\n    }\n\n    /**\n     * adds a cookie to the requst\n     * @param name cookie name\n     * @param value cookie value\n     * @throws IOException\n     */\n    public void setCookie(String name, String value) throws IOException {\n        cookies.put(name, value);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies the cookie \"name-to-value\" map\n     * @throws IOException\n     */\n    public void setCookies(Map cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        this.cookies.putAll(cookies);\n    }\n\n    /**\n     * adds cookies to the request\n     * @param cookies array of cookie names and values (cookies[2*i] is a name, cookies[2*i + 1] is a value)\n     * @throws IOException\n     */\n    public void setCookies(String[] cookies) throws IOException {\n        if (cookies \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c cookies.length - 1; i +\u003d 2) {\n            setCookie(cookies[i], cookies[i + 1]);\n        }\n    }\n\n    private void writeName(String name) throws IOException {\n        newline();\n        write(\"Content-Disposition: form-data; name\u003d\\\"\");\n        write(name);\n        write(\u0027\"\u0027);\n    }\n\n    /**\n     * adds a string parameter to the request\n     * @param name parameter name\n     * @param value parameter value\n     * @throws IOException\n     */\n    public void setParameter(String name, String value) throws IOException {\n        boundary();\n        writeName(name);\n        newline();\n        newline();\n        writeln(value);\n    }\n\n    private static void pipe(InputStream in, OutputStream out) throws IOException {\n        byte[] buf \u003d new byte[500000];\n        int nread;\n        int navailable;\n        int total \u003d 0;\n        synchronized (in) {\n            while ((nread \u003d in.read(buf, 0, buf.length)) \u003e\u003d 0) {\n                out.write(buf, 0, nread);\n                total +\u003d nread;\n            }\n        }\n        out.flush();\n        buf \u003d null;\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param filename the name of the file\n     * @param is input stream to read the contents of the file from\n     * @throws IOException\n     */\n    public void setParameter(String name, String filename, InputStream is) throws IOException {\n        boundary();\n        writeName(name);\n        write(\"; filename\u003d\\\"\");\n        write(filename);\n        write(\u0027\"\u0027);\n        newline();\n        write(\"Content-Type: \");\n        String type \u003d connection.guessContentTypeFromName(filename);\n        if (type \u003d\u003d null)\n            type \u003d \"application/octet-stream\";\n        writeln(type);\n        newline();\n        pipe(is, os);\n        newline();\n    }\n\n    /**\n     * adds a file parameter to the request\n     * @param name parameter name\n     * @param file the file to upload\n     * @throws IOException\n     */\n    public void setParameter(String name, File file) throws IOException {\n        setParameter(name, file.getPath(), new FileInputStream(file));\n    }\n\n    /**\n     * adds a parameter to the request; if the parameter is a File, the file is uploaded, otherwise the string value of the parameter is passed in the request\n     * @param name parameter name\n     * @param object parameter value, a File or anything else that can be stringified\n     * @throws IOException\n     */\n    public void setParameter(String name, Object object) throws IOException {\n        if (object instanceof File) {\n            setParameter(name, (File) object);\n        } else {\n            setParameter(name, object.toString());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters \"name-to-value\" map of parameters; if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Map parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (Iterator i \u003d parameters.entrySet().iterator(); i.hasNext(); ) {\n            Map.Entry entry \u003d (Map.Entry) i.next();\n            setParameter(entry.getKey().toString(), entry.getValue());\n        }\n    }\n\n    /**\n     * adds parameters to the request\n     * @param parameters array of parameter names and values (parameters[2*i] is a name, parameters[2*i + 1] is a value); if a value is a file, the file is uploaded, otherwise it is stringified and sent in the request\n     * @throws IOException\n     */\n    public void setParameters(Object[] parameters) throws IOException {\n        if (parameters \u003d\u003d null)\n            return;\n        for (int i \u003d 0; i \u003c parameters.length - 1; i +\u003d 2) {\n            setParameter(parameters[i].toString(), parameters[i + 1]);\n        }\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added\n     * @return input stream with the server response\n     * @throws IOException\n     */\n    public InputStream post() throws IOException {\n        boundary();\n        writeln(\"--\");\n        os.close();\n        return connection.getInputStream();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Map parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public InputStream post(Object[] parameters) throws IOException {\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(Map cookies, Map parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * posts the requests to the server, with all the cookies and parameters that were added before (if any), and with cookies and parameters that are passed in the arguments\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     * @see setCookies\n     */\n    public InputStream post(String[] cookies, Object[] parameters) throws IOException {\n        setCookies(cookies);\n        setParameters(parameters);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name, Object value) throws IOException {\n        setParameter(name, value);\n        return post();\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to the server, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public InputStream post(String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        setParameter(name1, value1);\n        return post(name2, value2, name3, value3, name4, value4);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with parameters that are passed in the argument\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, Map cookies, Map parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * posts a new request to specified URL, with cookies and parameters that are passed in the argument\n     * @param cookies request cookies\n     * @param parameters request parameters\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setCookies\n     * @see setParameters\n     */\n    public static InputStream post(URL url, String[] cookies, Object[] parameters) throws IOException {\n        return new ClientHttpRequest(url).post(cookies, parameters);\n    }\n\n    /**\n     * post the POST request specified URL, with the specified parameter\n     * @param name parameter name\n     * @param value parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3);\n    }\n\n    /**\n     * post the POST request to specified URL, with the specified parameters\n     * @param name1 first parameter name\n     * @param value1 first parameter value\n     * @param name2 second parameter name\n     * @param value2 second parameter value\n     * @param name3 third parameter name\n     * @param value3 third parameter value\n     * @param name4 fourth parameter name\n     * @param value4 fourth parameter value\n     * @return input stream with the server response\n     * @throws IOException\n     * @see setParameter\n     */\n    public static InputStream post(URL url, String name1, Object value1, String name2, Object value2, String name3, Object value3, String name4, Object value4) throws IOException {\n        return new ClientHttpRequest(url).post(name1, value1, name2, value2, name3, value3, name4, value4);\n    }\n}\n",
    "package": "com.browsersoft.servlet.util",
    "classname": "ClientHttpRequest",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/servlet/util/ClientHttpRequest_8Test.java",
    "test_prompt": "// ClientHttpRequest_8Test.java\npackage com.browsersoft.servlet.util;\n\nimport java.net.URLConnection;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.io.File;\nimport java.io.InputStream;\nimport java.util.Random;\nimport java.io.OutputStream;\nimport java.io.FileInputStream;\nimport java.util.Iterator;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link ClientHttpRequest}.\n* It contains ten unit test cases for the {@link ClientHttpRequest#post(String, Object, String, Object, String, Object, String, Object)} method.\n*/\nclass ClientHttpRequest_8Test {",
    "method_signature": "post(String, Object, String, Object, String, Object, String, Object)",
    "suffix": "8"
  },
  {
    "numberTests": "ten",
    "original_code": "// SimpleUserMgr.java\n/*\n *   CVS $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\n\n/**\n * This class manages a persistent storage of Users. It can add users from a file in\n * LDAP\u0027s LDIF format.  The values required are dn (Distinguished Name), cn (Common Name), userPassword, email,\n * ou and employeeType.\n * This is intended as an interface for LDAP, but provides a simple persistent Hashtables using JDBM.\n *\n * The id Hashtable (name \"userids\") contains the User objects with the email address as the key\n * The country (name \"countries\") Hashtable contains a HashSet of all the organizations in a given country\n * To get a list of all supported countries simply get the keys of the countries Hashtable\n * There also is a persistent Hashtable for each organization with is LDAP \"o\" value as its name\n * It returns a Hashtable of users within that organization, with key the \"cn\" (Username) and value \"email\"\n * Thus a user can be looked up by username and organization and return the \"key\" email address from which\n * the full User object can be obtained from the id Hashtable\n *\n * When a new organization is encountered (with a user with \"o\" and \"c\" dn parameters, it is registered\n * into the list of organizations for that country in the country Hashtable\n *\n * JDBM (http://jdbm.sourceforge.net) persistent hashtable implemenation is used for persistence\n *\n * @author $Author: grodecki $\n * @version $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n */\npublic class SimpleUserMgr implements UserMgr {\n\n    //private JDBMHashtable dn;\n    private JDBMHashtable id \u003d null;\n\n    private JDBMHashtable users;\n\n    private JDBMHashtable country;\n\n    private String username \u003d \"\";\n\n    // private String password \u003d \"\";\n    // private String email \u003d \"\";\n    private static String userfile \u003d \"login.users\";\n\n    private String userdb \u003d \"users\";\n\n    private static String configFile \u003d \"test\";\n\n    private JDBMRecordManager recman;\n\n    private static Properties props \u003d new Properties();\n\n    private Vector profile_vec \u003d null;\n\n    // private Hashtable users \u003d null;\n    private User user;\n\n    private static org.apache.log4j.Logger cat \u003d org.apache.log4j.Logger.getLogger(SimpleUserMgr.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public SimpleUserMgr() {\n        // Defer initialization for servlets\n        //  init();\n    }\n\n    /**\n     * Constructor which specifies the configProperties to be read\n     */\n    public SimpleUserMgr(String configProperties) {\n        setConfigFile(configProperties);\n        init();\n    }\n\n    /**\n     * Initialize Persistent storage\n     * There are two primary hashtables.   The first (country) contains a list of the organizations which are keys\n     * to user hashtables for each organization.  The organization hashtable is a map from the username\n     * key to the userId (email address).  The second (id) is the hashtable based on the email address\n     * which is used as a userId since the email address is supposed to be unique.  For each organization\n     * there is a separate hashtable of the users for that organization.  Thus one can look a user up\n     * across organizations or within an organization.  All the user objects are contained in the second (id) hashtable.\n     */\n    public void init() {\n        //  ResourceBundle bundle \u003d ResourceBundle.getBundle(configFile);\n        Login.loadProperties(props, configFile);\n        userdb \u003d props.getProperty(\"users\", userdb);\n        //      New code to find the actual db file, as long as it is on the classpath\n        String tmpDb \u003d \"/\" + userdb + \".db\";\n        URL fileUrl \u003d UserMgr.class.getResource(tmpDb);\n        String pathAndFile \u003d fileUrl.getFile();\n        // Now remove the final \u0027.db\u0027 from the returned string.\n        userdb \u003d pathAndFile.substring(0, pathAndFile.length() - 3);\n        cat.debug(\"init: accessing: \" + userdb);\n        try {\n            recman \u003d new JDBMRecordManager(userdb);\n            //dn \u003d recman.getHashtable(\"usernames\");\n            id \u003d recman.getHashtable(\"userids\");\n            if (cat.isDebugEnabled()) {\n                for (JDBMEnumeration en \u003d id.keys(); en.hasMoreElements(); ) {\n                    String key \u003d (String) en.nextElement();\n                    cat.debug(\"Key \u003d \" + key);\n                }\n            }\n            country \u003d recman.getHashtable(\"countries\");\n        } catch (IOException e) {\n            cat.error(\"init: \" + e);\n        }\n    }\n\n    /**\n     * add Users from previously defined userfile\n     */\n    public void addUsers() {\n        addUsers(userfile);\n    }\n\n    /**\n     *  Add users from an input file\n     * @param userfile\n     */\n    public void addUsers(String userfile) {\n        // Query using JNDI to get list of users, not implemented correctly yet.\n        // Read from file to get users (in ldif format)\n        // e.g.:\n        //  dn: cn\u003d David Forslund, o\u003dLANL, c\u003dUS\n        //\tcn: David Forslund\n        //\temail: dwf@lanl.gov\n        //  userPassword: test\n        // Results are put into a User object and the User into a hashtable with email/userId\n        // as the key\n        // various arrays are created for listing the users as needed.\n        // userfile \u003d props.getProperty(\"login.users\", userfile);\n        // String country \u003d props.getProperty(\"country\",\"US\");\n        try {\n            // orgs \u003d recman.getHashtable(country);\n            // Read in user list if not already done      ###\n            String line \u003d null;\n            InputStream is \u003d getClass().getResourceAsStream(userfile);\n            //if (theFile.exists()) {\n            if (is !\u003d null) {\n                cat.debug(\"Reading  \" + userfile);\n                //\tFileReader inFile \u003d new FileReader(theFile);\n                InputStreamReader inFile \u003d new InputStreamReader(is);\n                BufferedReader inReader \u003d new BufferedReader(inFile);\n                profile_vec \u003d new Vector();\n                user \u003d null;\n                // unique set of organizations in a country\n                HashSet set \u003d null;\n                while (((line \u003d inReader.readLine()) !\u003d null)) {\n                    parseLine(line);\n                }\n                //HashSet set \u003d (HashSet) orgs.get(country);\n                //if (set \u003d\u003d null) set \u003d new HashSet();\n                inReader.close();\n                if ((profile_vec !\u003d null)) {\n                    addProfile();\n                    for (int i \u003d 0; i \u003c profile_vec.size(); i++) {\n                        User u \u003d (User) profile_vec.elementAt(i);\n                        String c \u003d u.getCountry();\n                        //cat.debug(\"addUsers\\n \"+u.toString());\n                        String org \u003d u.getOrg();\n                        if (c !\u003d null)\n                            set \u003d (HashSet) country.get(c);\n                        if (set \u003d\u003d null)\n                            set \u003d new HashSet();\n                        // get the hashtable for that organization\n                        // Update list  of organizations for a country\n                        set.add(org);\n                        //  cat.debug(\"organization \u003d \" + org);\n                        JDBMHashtable users \u003d recman.getHashtable(org);\n                        // insert userID in users table with userName as key\n                        // put userId in dn with dn as key\n                        users.put(u.getUserName(), u.getUserId());\n                        // put user in id with mail as key\n                        id.put(u.getUserId(), u);\n                        country.put(c, set);\n                    }\n                    // put the list of names into the organization hashtable\n                    // cat.debug(set.size() + \" organizations\");\n                }\n            }\n        } catch (IOException e) {\n            cat.error(\"UserMgr reading error adding users \" + e, e);\n        }\n        //}\n    }\n\n    /**\n     * parse the line and add the user to the list\n     * @param line to be parsed\n     */\n    public void parseLine(String line) {\n        try {\n            //user \u003d null;\n            if (line.startsWith(\"#\") || line.startsWith(\"//\"))\n                return;\n            StringTokenizer tmp_st \u003d new StringTokenizer(line, \":\");\n            if (tmp_st.countTokens() \u003d\u003d 0)\n                return;\n            String tmp_tok \u003d tmp_st.nextToken();\n            //   System.out.println(\"parseLine: \"+tmp_tok);\n            if (tmp_tok.equals(\"dn\")) {\n                // We have a new defined person so save old data and reset\n                if (user \u003d\u003d null) {\n                    user \u003d new User();\n                } else {\n                    // user is complete so store it\n                    addProfile();\n                }\n                user.setDN(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"cn\")) {\n                user.setUserName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"email\")) {\n                user.setUserId(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"userPassword\")) {\n                //user.setPassword(tmp_st.nextToken().trim());\n                user.encodePassword(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"employeeType\")) {\n                // specify role(s) of user\n                user.addRole(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ou\")) {\n                // specify group(s) of user\n                user.addGroup(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"sn\")) {\n                user.setSurName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ip\")) {\n                // specify ip Addr of user\n                user.setIpAddr(tmp_st.nextToken().trim());\n            }\n        } catch (Exception e) {\n            cat.error(\"parseLine failed:\" + e);\n        }\n    }\n\n    /**\n     * Add the user profile\n     */\n    private void addProfile() {\n        profile_vec.addElement(user);\n        //  cat.debug(\"name: \"+user.getUserName()+\", email: \"+user.getUserId()+\", passwd: \"+user.getPassword());\n        user \u003d new User();\n    }\n\n    /**\n     * addUser\n     * @param u String with multiple lines with all the data for a user\n     */\n    public void addUser(String u) {\n        BufferedReader reader \u003d new BufferedReader(new StringReader(u));\n        String line \u003d null;\n        User saveUser \u003d user;\n        try {\n            while ((line \u003d reader.readLine()) !\u003d null) parseLine(line);\n            if (user !\u003d null)\n                addUser(user);\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n        user \u003d saveUser;\n    }\n\n    /**\n     * add User to the Persistent Hashtable\n     * @param theDN The distinguished name (cn\u003d \"name\", o\u003d\"organization\", c\u003d\"country\")\n     * @param cn  LDAP username\n     * @param sn   LDAP surname\n     * @param email   LDAP email address (userId)\n     * @param role\n     * @param password\n     */\n    public void addUser(String theDN, String cn, String sn, String email, String role, String password) {\n        User newUser \u003d new User(email, cn);\n        newUser.addRole(role);\n        newUser.setPassword(password);\n        newUser.setSurName(sn);\n        newUser.setDN(theDN);\n        addUser(newUser);\n    }\n\n    /**\n     *  Add a User already constructed\n     * @param newUser\n     */\n    public void addUser(User newUser) {\n        String c \u003d newUser.getCountry();\n        String org \u003d newUser.getOrg();\n        String userName \u003d newUser.getUserName();\n        String email \u003d newUser.getUserId();\n        cat.debug(\"addUser: \" + newUser.toString());\n        User oldUser \u003d getUser(newUser);\n        if (oldUser \u003d\u003d null)\n            oldUser \u003d new User();\n        oldUser.update(newUser);\n        try {\n            // First make sure the organization is in the country list\n            HashSet set \u003d (HashSet) country.get(c);\n            if (set \u003d\u003d null)\n                set \u003d new HashSet();\n            set.add(org);\n            country.put(c, set);\n            // get the users Hashtable based on the organization\n            users \u003d recman.getHashtable(org);\n            users.put(userName, email);\n            id.put(email, oldUser);\n            cat.debug(\"User: \" + oldUser.toString() + \" added!\");\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n    }\n\n    /**\n     * delete User based on the unique UserId\n     * @param userId corresponding to email address\n     */\n    public void delUser(String userId) {\n        try {\n            cat.debug(\"delUser trying to remove: \" + userId);\n            User delUser \u003d (User) id.get(userId);\n            if (delUser !\u003d null) {\n                id.remove(userId);\n                cat.debug(\"delUser removed from id: \" + userId);\n                String uName \u003d delUser.getUserName();\n                users \u003d recman.getHashtable(delUser.getOrg());\n                cat.debug(\"removing \" + uName + \" from dn\");\n                String u \u003d (String) users.get(uName);\n                if (u !\u003d null) {\n                    users.remove(uName);\n                    cat.debug(\"delUser removed from dn: \" + uName);\n                }\n            } else\n                cat.debug(\"delUser: id\u003d\u0027\" + userId + \"\u0027 not found\");\n        } catch (IOException e) {\n            cat.error(\"delUser: \" + userId + \" \" + e);\n        }\n    }\n\n    /**\n     * get the User based on name and organization\n     * @param userName\n     * @param org\n     * @return User\n     */\n    public User getUser(String userName, String org) {\n        User user \u003d null;\n        try {\n            users \u003d recman.getHashtable(org);\n            String userId \u003d (String) users.get(username);\n            if (userId !\u003d null)\n                user \u003d (User) id.get(userId);\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + userName + \",\" + org + \"): not found\");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    public User getUser() {\n        cat.debug(\"userID: \" + user.getUserId());\n        cat.debug(\"userName: \" + user.getUserName());\n        return user;\n    }\n\n    /**\n     * get User by the unique userId (email)\n     * @param userId\n     * @return User\n     */\n    public User getUser(String userId) {\n        cat.debug(\"getUser: \" + userId);\n        User user \u003d null;\n        try {\n            user \u003d (User) id.get(userId);\n            cat.debug(\"getUser: found user \" + user.toString());\n        } catch (Exception e) {\n            user \u003d null;\n            cat.error(\"getUser: user not found \" + e);\n        }\n        //cat.debug(\"getUser: found user \" + user.toString());\n        return user;\n    }\n\n    /**\n     * get User with username, org and email\n     * @param username  cn variable\n     * @param org       o variable\n     * @param email       email variable\n     * @return User\n     */\n    public User getUser(String username, String org, String email) {\n        User user \u003d null;\n        try {\n            // try unique email first (this should always return the user)\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (org !\u003d null) \u0026\u0026 (username !\u003d null)) {\n                // get the user list for the organization\n                users \u003d recman.getHashtable(org);\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + username + \",\" + org + \",\" + email + \"): user not found, \");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Find a User given a partially completed User object as a template\n     * @param findUser\n     * @return User\n     */\n    public User getUser(User findUser) {\n        User user \u003d new User();\n        String email \u003d findUser.getUserId();\n        try {\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (findUser.getOrg() !\u003d null) \u0026\u0026 findUser.getUserName() !\u003d null) {\n                users \u003d recman.getHashtable(findUser.getOrg());\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null) {\n                cat.warn(\"getUser(\" + findUser.toString() + \"): user not found\");\n            }\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Get all the userNames for a given organization\n     * @param org the organization name (o field in LDAP);\n     * @return String[] list of names within the organization\n     */\n    public String[] getNamesbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.keys();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getNamesbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get the email addresses of all users in an organization\n     * @param org name of the organization (o LDAP field)\n     * @return String[] array of email addresses\n     */\n    public String[] getMailbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.values();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getMailbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get list of all UserIds in DB\n     * @return String[] list of UserIds\n     */\n    public String[] getUserIds() {\n        String[] mail;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.keys();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserIds: \" + e1);\n            return new String[0];\n        }\n        mail \u003d new String[v.size()];\n        v.toArray(mail);\n        // cat.debug(\"getUserIds: \"+mail.length +\" mail: \"+mail[0]);\n        return mail;\n    }\n\n    /**\n     * obtain list of valid users\n     * @return String[] list of known users\n     */\n    public String[] getUserNames() {\n        String[] names;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.values();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(((User) e.nextElement()).getUserName());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserNames: \" + e1);\n            return new String[0];\n        }\n        // for (int i \u003d 0;i\u003c v.size(); i++)\n        //      cat.debug(\"name: \"+v.get(i));\n        names \u003d new String[v.size()];\n        cat.debug(\"getUserNames: found \" + names.length + \" elements\");\n        v.toArray(names);\n        return names;\n    }\n\n    /**\n     * Bean setter  and getter methods\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     *  set the file of users to be read.\n     * @param file to be read\n     */\n    public static void setUserfile(String file) {\n        userfile \u003d file;\n    }\n\n    /**\n     * get all the users in in the persistent hashtable\n     * @return String\n     */\n    public String export() {\n        try {\n            JDBMEnumeration c \u003d id.values();\n            StringBuffer buff \u003d new StringBuffer();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n            return buff.toString();\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n            return null;\n        }\n    }\n\n    public boolean checkSecret(String userid, String password, String authType) {\n        user \u003d getUser(userid);\n        if (user !\u003d null) {\n            String passwd \u003d user.getPassword();\n            if (passwd \u003d\u003d null)\n                return false;\n            return user.checkDigest(passwd, password);\n        } else\n            return false;\n    }\n\n    public void logOut() {\n        return;\n    }\n\n    public static void main(String[] argv) {\n        if (argv.length \u003c 1) {\n            System.out.println(\"usage: SimpleUserMgr \u0027file\u0027 where \u0027file\u0027 is a ResourceBundle (file.properties)\\n\" + \"that has an optional property \u0027users\u0027 which is the name of the database to be created or read\\n\" + \"and a property \u0027login.users\u0027 is a ldif text file containing the users to be added.\");\n            System.exit(0);\n        }\n        SimpleUserMgr.setConfigFile(argv[0]);\n        System.out.println(\"Config Resource is \" + argv[0] + \".properties\");\n        SimpleUserMgr userMgr \u003d new SimpleUserMgr();\n        userMgr.init();\n        String file \u003d props.getProperty(userfile, \"/users.txt\");\n        System.out.println(\"User File is \" + file);\n        if (file !\u003d null \u0026\u0026 file !\u003d \"\")\n            userMgr.addUsers(file);\n        System.out.println(\"Users Added:\\n\" + userMgr.export());\n    }\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "SimpleUserMgr",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/SimpleUserMgr_2Test.java",
    "test_prompt": "// SimpleUserMgr_2Test.java\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link SimpleUserMgr}.\n* It contains ten unit test cases for the {@link SimpleUserMgr#getUser(String, String, String)} method.\n*/\nclass SimpleUserMgr_2Test {",
    "method_signature": "getUser(String, String, String)",
    "suffix": "2"
  },
  {
    "numberTests": "ten",
    "original_code": "// SimpleUserMgr.java\n/*\n *   CVS $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\n\n/**\n * This class manages a persistent storage of Users. It can add users from a file in\n * LDAP\u0027s LDIF format.  The values required are dn (Distinguished Name), cn (Common Name), userPassword, email,\n * ou and employeeType.\n * This is intended as an interface for LDAP, but provides a simple persistent Hashtables using JDBM.\n *\n * The id Hashtable (name \"userids\") contains the User objects with the email address as the key\n * The country (name \"countries\") Hashtable contains a HashSet of all the organizations in a given country\n * To get a list of all supported countries simply get the keys of the countries Hashtable\n * There also is a persistent Hashtable for each organization with is LDAP \"o\" value as its name\n * It returns a Hashtable of users within that organization, with key the \"cn\" (Username) and value \"email\"\n * Thus a user can be looked up by username and organization and return the \"key\" email address from which\n * the full User object can be obtained from the id Hashtable\n *\n * When a new organization is encountered (with a user with \"o\" and \"c\" dn parameters, it is registered\n * into the list of organizations for that country in the country Hashtable\n *\n * JDBM (http://jdbm.sourceforge.net) persistent hashtable implemenation is used for persistence\n *\n * @author $Author: grodecki $\n * @version $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n */\npublic class SimpleUserMgr implements UserMgr {\n\n    //private JDBMHashtable dn;\n    private JDBMHashtable id \u003d null;\n\n    private JDBMHashtable users;\n\n    private JDBMHashtable country;\n\n    private String username \u003d \"\";\n\n    // private String password \u003d \"\";\n    // private String email \u003d \"\";\n    private static String userfile \u003d \"login.users\";\n\n    private String userdb \u003d \"users\";\n\n    private static String configFile \u003d \"test\";\n\n    private JDBMRecordManager recman;\n\n    private static Properties props \u003d new Properties();\n\n    private Vector profile_vec \u003d null;\n\n    // private Hashtable users \u003d null;\n    private User user;\n\n    private static org.apache.log4j.Logger cat \u003d org.apache.log4j.Logger.getLogger(SimpleUserMgr.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public SimpleUserMgr() {\n        // Defer initialization for servlets\n        //  init();\n    }\n\n    /**\n     * Constructor which specifies the configProperties to be read\n     */\n    public SimpleUserMgr(String configProperties) {\n        setConfigFile(configProperties);\n        init();\n    }\n\n    /**\n     * Initialize Persistent storage\n     * There are two primary hashtables.   The first (country) contains a list of the organizations which are keys\n     * to user hashtables for each organization.  The organization hashtable is a map from the username\n     * key to the userId (email address).  The second (id) is the hashtable based on the email address\n     * which is used as a userId since the email address is supposed to be unique.  For each organization\n     * there is a separate hashtable of the users for that organization.  Thus one can look a user up\n     * across organizations or within an organization.  All the user objects are contained in the second (id) hashtable.\n     */\n    public void init() {\n        //  ResourceBundle bundle \u003d ResourceBundle.getBundle(configFile);\n        Login.loadProperties(props, configFile);\n        userdb \u003d props.getProperty(\"users\", userdb);\n        //      New code to find the actual db file, as long as it is on the classpath\n        String tmpDb \u003d \"/\" + userdb + \".db\";\n        URL fileUrl \u003d UserMgr.class.getResource(tmpDb);\n        String pathAndFile \u003d fileUrl.getFile();\n        // Now remove the final \u0027.db\u0027 from the returned string.\n        userdb \u003d pathAndFile.substring(0, pathAndFile.length() - 3);\n        cat.debug(\"init: accessing: \" + userdb);\n        try {\n            recman \u003d new JDBMRecordManager(userdb);\n            //dn \u003d recman.getHashtable(\"usernames\");\n            id \u003d recman.getHashtable(\"userids\");\n            if (cat.isDebugEnabled()) {\n                for (JDBMEnumeration en \u003d id.keys(); en.hasMoreElements(); ) {\n                    String key \u003d (String) en.nextElement();\n                    cat.debug(\"Key \u003d \" + key);\n                }\n            }\n            country \u003d recman.getHashtable(\"countries\");\n        } catch (IOException e) {\n            cat.error(\"init: \" + e);\n        }\n    }\n\n    /**\n     * add Users from previously defined userfile\n     */\n    public void addUsers() {\n        addUsers(userfile);\n    }\n\n    /**\n     *  Add users from an input file\n     * @param userfile\n     */\n    public void addUsers(String userfile) {\n        // Query using JNDI to get list of users, not implemented correctly yet.\n        // Read from file to get users (in ldif format)\n        // e.g.:\n        //  dn: cn\u003d David Forslund, o\u003dLANL, c\u003dUS\n        //\tcn: David Forslund\n        //\temail: dwf@lanl.gov\n        //  userPassword: test\n        // Results are put into a User object and the User into a hashtable with email/userId\n        // as the key\n        // various arrays are created for listing the users as needed.\n        // userfile \u003d props.getProperty(\"login.users\", userfile);\n        // String country \u003d props.getProperty(\"country\",\"US\");\n        try {\n            // orgs \u003d recman.getHashtable(country);\n            // Read in user list if not already done      ###\n            String line \u003d null;\n            InputStream is \u003d getClass().getResourceAsStream(userfile);\n            //if (theFile.exists()) {\n            if (is !\u003d null) {\n                cat.debug(\"Reading  \" + userfile);\n                //\tFileReader inFile \u003d new FileReader(theFile);\n                InputStreamReader inFile \u003d new InputStreamReader(is);\n                BufferedReader inReader \u003d new BufferedReader(inFile);\n                profile_vec \u003d new Vector();\n                user \u003d null;\n                // unique set of organizations in a country\n                HashSet set \u003d null;\n                while (((line \u003d inReader.readLine()) !\u003d null)) {\n                    parseLine(line);\n                }\n                //HashSet set \u003d (HashSet) orgs.get(country);\n                //if (set \u003d\u003d null) set \u003d new HashSet();\n                inReader.close();\n                if ((profile_vec !\u003d null)) {\n                    addProfile();\n                    for (int i \u003d 0; i \u003c profile_vec.size(); i++) {\n                        User u \u003d (User) profile_vec.elementAt(i);\n                        String c \u003d u.getCountry();\n                        //cat.debug(\"addUsers\\n \"+u.toString());\n                        String org \u003d u.getOrg();\n                        if (c !\u003d null)\n                            set \u003d (HashSet) country.get(c);\n                        if (set \u003d\u003d null)\n                            set \u003d new HashSet();\n                        // get the hashtable for that organization\n                        // Update list  of organizations for a country\n                        set.add(org);\n                        //  cat.debug(\"organization \u003d \" + org);\n                        JDBMHashtable users \u003d recman.getHashtable(org);\n                        // insert userID in users table with userName as key\n                        // put userId in dn with dn as key\n                        users.put(u.getUserName(), u.getUserId());\n                        // put user in id with mail as key\n                        id.put(u.getUserId(), u);\n                        country.put(c, set);\n                    }\n                    // put the list of names into the organization hashtable\n                    // cat.debug(set.size() + \" organizations\");\n                }\n            }\n        } catch (IOException e) {\n            cat.error(\"UserMgr reading error adding users \" + e, e);\n        }\n        //}\n    }\n\n    /**\n     * parse the line and add the user to the list\n     * @param line to be parsed\n     */\n    public void parseLine(String line) {\n        try {\n            //user \u003d null;\n            if (line.startsWith(\"#\") || line.startsWith(\"//\"))\n                return;\n            StringTokenizer tmp_st \u003d new StringTokenizer(line, \":\");\n            if (tmp_st.countTokens() \u003d\u003d 0)\n                return;\n            String tmp_tok \u003d tmp_st.nextToken();\n            //   System.out.println(\"parseLine: \"+tmp_tok);\n            if (tmp_tok.equals(\"dn\")) {\n                // We have a new defined person so save old data and reset\n                if (user \u003d\u003d null) {\n                    user \u003d new User();\n                } else {\n                    // user is complete so store it\n                    addProfile();\n                }\n                user.setDN(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"cn\")) {\n                user.setUserName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"email\")) {\n                user.setUserId(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"userPassword\")) {\n                //user.setPassword(tmp_st.nextToken().trim());\n                user.encodePassword(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"employeeType\")) {\n                // specify role(s) of user\n                user.addRole(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ou\")) {\n                // specify group(s) of user\n                user.addGroup(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"sn\")) {\n                user.setSurName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ip\")) {\n                // specify ip Addr of user\n                user.setIpAddr(tmp_st.nextToken().trim());\n            }\n        } catch (Exception e) {\n            cat.error(\"parseLine failed:\" + e);\n        }\n    }\n\n    /**\n     * Add the user profile\n     */\n    private void addProfile() {\n        profile_vec.addElement(user);\n        //  cat.debug(\"name: \"+user.getUserName()+\", email: \"+user.getUserId()+\", passwd: \"+user.getPassword());\n        user \u003d new User();\n    }\n\n    /**\n     * addUser\n     * @param u String with multiple lines with all the data for a user\n     */\n    public void addUser(String u) {\n        BufferedReader reader \u003d new BufferedReader(new StringReader(u));\n        String line \u003d null;\n        User saveUser \u003d user;\n        try {\n            while ((line \u003d reader.readLine()) !\u003d null) parseLine(line);\n            if (user !\u003d null)\n                addUser(user);\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n        user \u003d saveUser;\n    }\n\n    /**\n     * add User to the Persistent Hashtable\n     * @param theDN The distinguished name (cn\u003d \"name\", o\u003d\"organization\", c\u003d\"country\")\n     * @param cn  LDAP username\n     * @param sn   LDAP surname\n     * @param email   LDAP email address (userId)\n     * @param role\n     * @param password\n     */\n    public void addUser(String theDN, String cn, String sn, String email, String role, String password) {\n        User newUser \u003d new User(email, cn);\n        newUser.addRole(role);\n        newUser.setPassword(password);\n        newUser.setSurName(sn);\n        newUser.setDN(theDN);\n        addUser(newUser);\n    }\n\n    /**\n     *  Add a User already constructed\n     * @param newUser\n     */\n    public void addUser(User newUser) {\n        String c \u003d newUser.getCountry();\n        String org \u003d newUser.getOrg();\n        String userName \u003d newUser.getUserName();\n        String email \u003d newUser.getUserId();\n        cat.debug(\"addUser: \" + newUser.toString());\n        User oldUser \u003d getUser(newUser);\n        if (oldUser \u003d\u003d null)\n            oldUser \u003d new User();\n        oldUser.update(newUser);\n        try {\n            // First make sure the organization is in the country list\n            HashSet set \u003d (HashSet) country.get(c);\n            if (set \u003d\u003d null)\n                set \u003d new HashSet();\n            set.add(org);\n            country.put(c, set);\n            // get the users Hashtable based on the organization\n            users \u003d recman.getHashtable(org);\n            users.put(userName, email);\n            id.put(email, oldUser);\n            cat.debug(\"User: \" + oldUser.toString() + \" added!\");\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n    }\n\n    /**\n     * delete User based on the unique UserId\n     * @param userId corresponding to email address\n     */\n    public void delUser(String userId) {\n        try {\n            cat.debug(\"delUser trying to remove: \" + userId);\n            User delUser \u003d (User) id.get(userId);\n            if (delUser !\u003d null) {\n                id.remove(userId);\n                cat.debug(\"delUser removed from id: \" + userId);\n                String uName \u003d delUser.getUserName();\n                users \u003d recman.getHashtable(delUser.getOrg());\n                cat.debug(\"removing \" + uName + \" from dn\");\n                String u \u003d (String) users.get(uName);\n                if (u !\u003d null) {\n                    users.remove(uName);\n                    cat.debug(\"delUser removed from dn: \" + uName);\n                }\n            } else\n                cat.debug(\"delUser: id\u003d\u0027\" + userId + \"\u0027 not found\");\n        } catch (IOException e) {\n            cat.error(\"delUser: \" + userId + \" \" + e);\n        }\n    }\n\n    /**\n     * get the User based on name and organization\n     * @param userName\n     * @param org\n     * @return User\n     */\n    public User getUser(String userName, String org) {\n        User user \u003d null;\n        try {\n            users \u003d recman.getHashtable(org);\n            String userId \u003d (String) users.get(username);\n            if (userId !\u003d null)\n                user \u003d (User) id.get(userId);\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + userName + \",\" + org + \"): not found\");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    public User getUser() {\n        cat.debug(\"userID: \" + user.getUserId());\n        cat.debug(\"userName: \" + user.getUserName());\n        return user;\n    }\n\n    /**\n     * get User by the unique userId (email)\n     * @param userId\n     * @return User\n     */\n    public User getUser(String userId) {\n        cat.debug(\"getUser: \" + userId);\n        User user \u003d null;\n        try {\n            user \u003d (User) id.get(userId);\n            cat.debug(\"getUser: found user \" + user.toString());\n        } catch (Exception e) {\n            user \u003d null;\n            cat.error(\"getUser: user not found \" + e);\n        }\n        //cat.debug(\"getUser: found user \" + user.toString());\n        return user;\n    }\n\n    /**\n     * get User with username, org and email\n     * @param username  cn variable\n     * @param org       o variable\n     * @param email       email variable\n     * @return User\n     */\n    public User getUser(String username, String org, String email) {\n        User user \u003d null;\n        try {\n            // try unique email first (this should always return the user)\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (org !\u003d null) \u0026\u0026 (username !\u003d null)) {\n                // get the user list for the organization\n                users \u003d recman.getHashtable(org);\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + username + \",\" + org + \",\" + email + \"): user not found, \");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Find a User given a partially completed User object as a template\n     * @param findUser\n     * @return User\n     */\n    public User getUser(User findUser) {\n        User user \u003d new User();\n        String email \u003d findUser.getUserId();\n        try {\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (findUser.getOrg() !\u003d null) \u0026\u0026 findUser.getUserName() !\u003d null) {\n                users \u003d recman.getHashtable(findUser.getOrg());\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null) {\n                cat.warn(\"getUser(\" + findUser.toString() + \"): user not found\");\n            }\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Get all the userNames for a given organization\n     * @param org the organization name (o field in LDAP);\n     * @return String[] list of names within the organization\n     */\n    public String[] getNamesbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.keys();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getNamesbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get the email addresses of all users in an organization\n     * @param org name of the organization (o LDAP field)\n     * @return String[] array of email addresses\n     */\n    public String[] getMailbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.values();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getMailbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get list of all UserIds in DB\n     * @return String[] list of UserIds\n     */\n    public String[] getUserIds() {\n        String[] mail;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.keys();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserIds: \" + e1);\n            return new String[0];\n        }\n        mail \u003d new String[v.size()];\n        v.toArray(mail);\n        // cat.debug(\"getUserIds: \"+mail.length +\" mail: \"+mail[0]);\n        return mail;\n    }\n\n    /**\n     * obtain list of valid users\n     * @return String[] list of known users\n     */\n    public String[] getUserNames() {\n        String[] names;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.values();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(((User) e.nextElement()).getUserName());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserNames: \" + e1);\n            return new String[0];\n        }\n        // for (int i \u003d 0;i\u003c v.size(); i++)\n        //      cat.debug(\"name: \"+v.get(i));\n        names \u003d new String[v.size()];\n        cat.debug(\"getUserNames: found \" + names.length + \" elements\");\n        v.toArray(names);\n        return names;\n    }\n\n    /**\n     * Bean setter  and getter methods\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     *  set the file of users to be read.\n     * @param file to be read\n     */\n    public static void setUserfile(String file) {\n        userfile \u003d file;\n    }\n\n    /**\n     * get all the users in in the persistent hashtable\n     * @return String\n     */\n    public String export() {\n        try {\n            JDBMEnumeration c \u003d id.values();\n            StringBuffer buff \u003d new StringBuffer();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n            return buff.toString();\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n            return null;\n        }\n    }\n\n    public boolean checkSecret(String userid, String password, String authType) {\n        user \u003d getUser(userid);\n        if (user !\u003d null) {\n            String passwd \u003d user.getPassword();\n            if (passwd \u003d\u003d null)\n                return false;\n            return user.checkDigest(passwd, password);\n        } else\n            return false;\n    }\n\n    public void logOut() {\n        return;\n    }\n\n    public static void main(String[] argv) {\n        if (argv.length \u003c 1) {\n            System.out.println(\"usage: SimpleUserMgr \u0027file\u0027 where \u0027file\u0027 is a ResourceBundle (file.properties)\\n\" + \"that has an optional property \u0027users\u0027 which is the name of the database to be created or read\\n\" + \"and a property \u0027login.users\u0027 is a ldif text file containing the users to be added.\");\n            System.exit(0);\n        }\n        SimpleUserMgr.setConfigFile(argv[0]);\n        System.out.println(\"Config Resource is \" + argv[0] + \".properties\");\n        SimpleUserMgr userMgr \u003d new SimpleUserMgr();\n        userMgr.init();\n        String file \u003d props.getProperty(userfile, \"/users.txt\");\n        System.out.println(\"User File is \" + file);\n        if (file !\u003d null \u0026\u0026 file !\u003d \"\")\n            userMgr.addUsers(file);\n        System.out.println(\"Users Added:\\n\" + userMgr.export());\n    }\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "SimpleUserMgr",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/SimpleUserMgr_4Test.java",
    "test_prompt": "// SimpleUserMgr_4Test.java\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link SimpleUserMgr}.\n* It contains ten unit test cases for the {@link SimpleUserMgr#getNamesbyOrg(String)} method.\n*/\nclass SimpleUserMgr_4Test {",
    "method_signature": "getNamesbyOrg(String)",
    "suffix": "4"
  },
  {
    "numberTests": "ten",
    "original_code": "// SimpleUserMgr.java\n/*\n *   CVS $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\n\n/**\n * This class manages a persistent storage of Users. It can add users from a file in\n * LDAP\u0027s LDIF format.  The values required are dn (Distinguished Name), cn (Common Name), userPassword, email,\n * ou and employeeType.\n * This is intended as an interface for LDAP, but provides a simple persistent Hashtables using JDBM.\n *\n * The id Hashtable (name \"userids\") contains the User objects with the email address as the key\n * The country (name \"countries\") Hashtable contains a HashSet of all the organizations in a given country\n * To get a list of all supported countries simply get the keys of the countries Hashtable\n * There also is a persistent Hashtable for each organization with is LDAP \"o\" value as its name\n * It returns a Hashtable of users within that organization, with key the \"cn\" (Username) and value \"email\"\n * Thus a user can be looked up by username and organization and return the \"key\" email address from which\n * the full User object can be obtained from the id Hashtable\n *\n * When a new organization is encountered (with a user with \"o\" and \"c\" dn parameters, it is registered\n * into the list of organizations for that country in the country Hashtable\n *\n * JDBM (http://jdbm.sourceforge.net) persistent hashtable implemenation is used for persistence\n *\n * @author $Author: grodecki $\n * @version $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n */\npublic class SimpleUserMgr implements UserMgr {\n\n    //private JDBMHashtable dn;\n    private JDBMHashtable id \u003d null;\n\n    private JDBMHashtable users;\n\n    private JDBMHashtable country;\n\n    private String username \u003d \"\";\n\n    // private String password \u003d \"\";\n    // private String email \u003d \"\";\n    private static String userfile \u003d \"login.users\";\n\n    private String userdb \u003d \"users\";\n\n    private static String configFile \u003d \"test\";\n\n    private JDBMRecordManager recman;\n\n    private static Properties props \u003d new Properties();\n\n    private Vector profile_vec \u003d null;\n\n    // private Hashtable users \u003d null;\n    private User user;\n\n    private static org.apache.log4j.Logger cat \u003d org.apache.log4j.Logger.getLogger(SimpleUserMgr.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public SimpleUserMgr() {\n        // Defer initialization for servlets\n        //  init();\n    }\n\n    /**\n     * Constructor which specifies the configProperties to be read\n     */\n    public SimpleUserMgr(String configProperties) {\n        setConfigFile(configProperties);\n        init();\n    }\n\n    /**\n     * Initialize Persistent storage\n     * There are two primary hashtables.   The first (country) contains a list of the organizations which are keys\n     * to user hashtables for each organization.  The organization hashtable is a map from the username\n     * key to the userId (email address).  The second (id) is the hashtable based on the email address\n     * which is used as a userId since the email address is supposed to be unique.  For each organization\n     * there is a separate hashtable of the users for that organization.  Thus one can look a user up\n     * across organizations or within an organization.  All the user objects are contained in the second (id) hashtable.\n     */\n    public void init() {\n        //  ResourceBundle bundle \u003d ResourceBundle.getBundle(configFile);\n        Login.loadProperties(props, configFile);\n        userdb \u003d props.getProperty(\"users\", userdb);\n        //      New code to find the actual db file, as long as it is on the classpath\n        String tmpDb \u003d \"/\" + userdb + \".db\";\n        URL fileUrl \u003d UserMgr.class.getResource(tmpDb);\n        String pathAndFile \u003d fileUrl.getFile();\n        // Now remove the final \u0027.db\u0027 from the returned string.\n        userdb \u003d pathAndFile.substring(0, pathAndFile.length() - 3);\n        cat.debug(\"init: accessing: \" + userdb);\n        try {\n            recman \u003d new JDBMRecordManager(userdb);\n            //dn \u003d recman.getHashtable(\"usernames\");\n            id \u003d recman.getHashtable(\"userids\");\n            if (cat.isDebugEnabled()) {\n                for (JDBMEnumeration en \u003d id.keys(); en.hasMoreElements(); ) {\n                    String key \u003d (String) en.nextElement();\n                    cat.debug(\"Key \u003d \" + key);\n                }\n            }\n            country \u003d recman.getHashtable(\"countries\");\n        } catch (IOException e) {\n            cat.error(\"init: \" + e);\n        }\n    }\n\n    /**\n     * add Users from previously defined userfile\n     */\n    public void addUsers() {\n        addUsers(userfile);\n    }\n\n    /**\n     *  Add users from an input file\n     * @param userfile\n     */\n    public void addUsers(String userfile) {\n        // Query using JNDI to get list of users, not implemented correctly yet.\n        // Read from file to get users (in ldif format)\n        // e.g.:\n        //  dn: cn\u003d David Forslund, o\u003dLANL, c\u003dUS\n        //\tcn: David Forslund\n        //\temail: dwf@lanl.gov\n        //  userPassword: test\n        // Results are put into a User object and the User into a hashtable with email/userId\n        // as the key\n        // various arrays are created for listing the users as needed.\n        // userfile \u003d props.getProperty(\"login.users\", userfile);\n        // String country \u003d props.getProperty(\"country\",\"US\");\n        try {\n            // orgs \u003d recman.getHashtable(country);\n            // Read in user list if not already done      ###\n            String line \u003d null;\n            InputStream is \u003d getClass().getResourceAsStream(userfile);\n            //if (theFile.exists()) {\n            if (is !\u003d null) {\n                cat.debug(\"Reading  \" + userfile);\n                //\tFileReader inFile \u003d new FileReader(theFile);\n                InputStreamReader inFile \u003d new InputStreamReader(is);\n                BufferedReader inReader \u003d new BufferedReader(inFile);\n                profile_vec \u003d new Vector();\n                user \u003d null;\n                // unique set of organizations in a country\n                HashSet set \u003d null;\n                while (((line \u003d inReader.readLine()) !\u003d null)) {\n                    parseLine(line);\n                }\n                //HashSet set \u003d (HashSet) orgs.get(country);\n                //if (set \u003d\u003d null) set \u003d new HashSet();\n                inReader.close();\n                if ((profile_vec !\u003d null)) {\n                    addProfile();\n                    for (int i \u003d 0; i \u003c profile_vec.size(); i++) {\n                        User u \u003d (User) profile_vec.elementAt(i);\n                        String c \u003d u.getCountry();\n                        //cat.debug(\"addUsers\\n \"+u.toString());\n                        String org \u003d u.getOrg();\n                        if (c !\u003d null)\n                            set \u003d (HashSet) country.get(c);\n                        if (set \u003d\u003d null)\n                            set \u003d new HashSet();\n                        // get the hashtable for that organization\n                        // Update list  of organizations for a country\n                        set.add(org);\n                        //  cat.debug(\"organization \u003d \" + org);\n                        JDBMHashtable users \u003d recman.getHashtable(org);\n                        // insert userID in users table with userName as key\n                        // put userId in dn with dn as key\n                        users.put(u.getUserName(), u.getUserId());\n                        // put user in id with mail as key\n                        id.put(u.getUserId(), u);\n                        country.put(c, set);\n                    }\n                    // put the list of names into the organization hashtable\n                    // cat.debug(set.size() + \" organizations\");\n                }\n            }\n        } catch (IOException e) {\n            cat.error(\"UserMgr reading error adding users \" + e, e);\n        }\n        //}\n    }\n\n    /**\n     * parse the line and add the user to the list\n     * @param line to be parsed\n     */\n    public void parseLine(String line) {\n        try {\n            //user \u003d null;\n            if (line.startsWith(\"#\") || line.startsWith(\"//\"))\n                return;\n            StringTokenizer tmp_st \u003d new StringTokenizer(line, \":\");\n            if (tmp_st.countTokens() \u003d\u003d 0)\n                return;\n            String tmp_tok \u003d tmp_st.nextToken();\n            //   System.out.println(\"parseLine: \"+tmp_tok);\n            if (tmp_tok.equals(\"dn\")) {\n                // We have a new defined person so save old data and reset\n                if (user \u003d\u003d null) {\n                    user \u003d new User();\n                } else {\n                    // user is complete so store it\n                    addProfile();\n                }\n                user.setDN(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"cn\")) {\n                user.setUserName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"email\")) {\n                user.setUserId(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"userPassword\")) {\n                //user.setPassword(tmp_st.nextToken().trim());\n                user.encodePassword(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"employeeType\")) {\n                // specify role(s) of user\n                user.addRole(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ou\")) {\n                // specify group(s) of user\n                user.addGroup(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"sn\")) {\n                user.setSurName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ip\")) {\n                // specify ip Addr of user\n                user.setIpAddr(tmp_st.nextToken().trim());\n            }\n        } catch (Exception e) {\n            cat.error(\"parseLine failed:\" + e);\n        }\n    }\n\n    /**\n     * Add the user profile\n     */\n    private void addProfile() {\n        profile_vec.addElement(user);\n        //  cat.debug(\"name: \"+user.getUserName()+\", email: \"+user.getUserId()+\", passwd: \"+user.getPassword());\n        user \u003d new User();\n    }\n\n    /**\n     * addUser\n     * @param u String with multiple lines with all the data for a user\n     */\n    public void addUser(String u) {\n        BufferedReader reader \u003d new BufferedReader(new StringReader(u));\n        String line \u003d null;\n        User saveUser \u003d user;\n        try {\n            while ((line \u003d reader.readLine()) !\u003d null) parseLine(line);\n            if (user !\u003d null)\n                addUser(user);\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n        user \u003d saveUser;\n    }\n\n    /**\n     * add User to the Persistent Hashtable\n     * @param theDN The distinguished name (cn\u003d \"name\", o\u003d\"organization\", c\u003d\"country\")\n     * @param cn  LDAP username\n     * @param sn   LDAP surname\n     * @param email   LDAP email address (userId)\n     * @param role\n     * @param password\n     */\n    public void addUser(String theDN, String cn, String sn, String email, String role, String password) {\n        User newUser \u003d new User(email, cn);\n        newUser.addRole(role);\n        newUser.setPassword(password);\n        newUser.setSurName(sn);\n        newUser.setDN(theDN);\n        addUser(newUser);\n    }\n\n    /**\n     *  Add a User already constructed\n     * @param newUser\n     */\n    public void addUser(User newUser) {\n        String c \u003d newUser.getCountry();\n        String org \u003d newUser.getOrg();\n        String userName \u003d newUser.getUserName();\n        String email \u003d newUser.getUserId();\n        cat.debug(\"addUser: \" + newUser.toString());\n        User oldUser \u003d getUser(newUser);\n        if (oldUser \u003d\u003d null)\n            oldUser \u003d new User();\n        oldUser.update(newUser);\n        try {\n            // First make sure the organization is in the country list\n            HashSet set \u003d (HashSet) country.get(c);\n            if (set \u003d\u003d null)\n                set \u003d new HashSet();\n            set.add(org);\n            country.put(c, set);\n            // get the users Hashtable based on the organization\n            users \u003d recman.getHashtable(org);\n            users.put(userName, email);\n            id.put(email, oldUser);\n            cat.debug(\"User: \" + oldUser.toString() + \" added!\");\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n    }\n\n    /**\n     * delete User based on the unique UserId\n     * @param userId corresponding to email address\n     */\n    public void delUser(String userId) {\n        try {\n            cat.debug(\"delUser trying to remove: \" + userId);\n            User delUser \u003d (User) id.get(userId);\n            if (delUser !\u003d null) {\n                id.remove(userId);\n                cat.debug(\"delUser removed from id: \" + userId);\n                String uName \u003d delUser.getUserName();\n                users \u003d recman.getHashtable(delUser.getOrg());\n                cat.debug(\"removing \" + uName + \" from dn\");\n                String u \u003d (String) users.get(uName);\n                if (u !\u003d null) {\n                    users.remove(uName);\n                    cat.debug(\"delUser removed from dn: \" + uName);\n                }\n            } else\n                cat.debug(\"delUser: id\u003d\u0027\" + userId + \"\u0027 not found\");\n        } catch (IOException e) {\n            cat.error(\"delUser: \" + userId + \" \" + e);\n        }\n    }\n\n    /**\n     * get the User based on name and organization\n     * @param userName\n     * @param org\n     * @return User\n     */\n    public User getUser(String userName, String org) {\n        User user \u003d null;\n        try {\n            users \u003d recman.getHashtable(org);\n            String userId \u003d (String) users.get(username);\n            if (userId !\u003d null)\n                user \u003d (User) id.get(userId);\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + userName + \",\" + org + \"): not found\");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    public User getUser() {\n        cat.debug(\"userID: \" + user.getUserId());\n        cat.debug(\"userName: \" + user.getUserName());\n        return user;\n    }\n\n    /**\n     * get User by the unique userId (email)\n     * @param userId\n     * @return User\n     */\n    public User getUser(String userId) {\n        cat.debug(\"getUser: \" + userId);\n        User user \u003d null;\n        try {\n            user \u003d (User) id.get(userId);\n            cat.debug(\"getUser: found user \" + user.toString());\n        } catch (Exception e) {\n            user \u003d null;\n            cat.error(\"getUser: user not found \" + e);\n        }\n        //cat.debug(\"getUser: found user \" + user.toString());\n        return user;\n    }\n\n    /**\n     * get User with username, org and email\n     * @param username  cn variable\n     * @param org       o variable\n     * @param email       email variable\n     * @return User\n     */\n    public User getUser(String username, String org, String email) {\n        User user \u003d null;\n        try {\n            // try unique email first (this should always return the user)\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (org !\u003d null) \u0026\u0026 (username !\u003d null)) {\n                // get the user list for the organization\n                users \u003d recman.getHashtable(org);\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + username + \",\" + org + \",\" + email + \"): user not found, \");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Find a User given a partially completed User object as a template\n     * @param findUser\n     * @return User\n     */\n    public User getUser(User findUser) {\n        User user \u003d new User();\n        String email \u003d findUser.getUserId();\n        try {\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (findUser.getOrg() !\u003d null) \u0026\u0026 findUser.getUserName() !\u003d null) {\n                users \u003d recman.getHashtable(findUser.getOrg());\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null) {\n                cat.warn(\"getUser(\" + findUser.toString() + \"): user not found\");\n            }\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Get all the userNames for a given organization\n     * @param org the organization name (o field in LDAP);\n     * @return String[] list of names within the organization\n     */\n    public String[] getNamesbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.keys();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getNamesbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get the email addresses of all users in an organization\n     * @param org name of the organization (o LDAP field)\n     * @return String[] array of email addresses\n     */\n    public String[] getMailbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.values();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getMailbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get list of all UserIds in DB\n     * @return String[] list of UserIds\n     */\n    public String[] getUserIds() {\n        String[] mail;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.keys();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserIds: \" + e1);\n            return new String[0];\n        }\n        mail \u003d new String[v.size()];\n        v.toArray(mail);\n        // cat.debug(\"getUserIds: \"+mail.length +\" mail: \"+mail[0]);\n        return mail;\n    }\n\n    /**\n     * obtain list of valid users\n     * @return String[] list of known users\n     */\n    public String[] getUserNames() {\n        String[] names;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.values();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(((User) e.nextElement()).getUserName());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserNames: \" + e1);\n            return new String[0];\n        }\n        // for (int i \u003d 0;i\u003c v.size(); i++)\n        //      cat.debug(\"name: \"+v.get(i));\n        names \u003d new String[v.size()];\n        cat.debug(\"getUserNames: found \" + names.length + \" elements\");\n        v.toArray(names);\n        return names;\n    }\n\n    /**\n     * Bean setter  and getter methods\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     *  set the file of users to be read.\n     * @param file to be read\n     */\n    public static void setUserfile(String file) {\n        userfile \u003d file;\n    }\n\n    /**\n     * get all the users in in the persistent hashtable\n     * @return String\n     */\n    public String export() {\n        try {\n            JDBMEnumeration c \u003d id.values();\n            StringBuffer buff \u003d new StringBuffer();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n            return buff.toString();\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n            return null;\n        }\n    }\n\n    public boolean checkSecret(String userid, String password, String authType) {\n        user \u003d getUser(userid);\n        if (user !\u003d null) {\n            String passwd \u003d user.getPassword();\n            if (passwd \u003d\u003d null)\n                return false;\n            return user.checkDigest(passwd, password);\n        } else\n            return false;\n    }\n\n    public void logOut() {\n        return;\n    }\n\n    public static void main(String[] argv) {\n        if (argv.length \u003c 1) {\n            System.out.println(\"usage: SimpleUserMgr \u0027file\u0027 where \u0027file\u0027 is a ResourceBundle (file.properties)\\n\" + \"that has an optional property \u0027users\u0027 which is the name of the database to be created or read\\n\" + \"and a property \u0027login.users\u0027 is a ldif text file containing the users to be added.\");\n            System.exit(0);\n        }\n        SimpleUserMgr.setConfigFile(argv[0]);\n        System.out.println(\"Config Resource is \" + argv[0] + \".properties\");\n        SimpleUserMgr userMgr \u003d new SimpleUserMgr();\n        userMgr.init();\n        String file \u003d props.getProperty(userfile, \"/users.txt\");\n        System.out.println(\"User File is \" + file);\n        if (file !\u003d null \u0026\u0026 file !\u003d \"\")\n            userMgr.addUsers(file);\n        System.out.println(\"Users Added:\\n\" + userMgr.export());\n    }\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "SimpleUserMgr",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/SimpleUserMgr_5Test.java",
    "test_prompt": "// SimpleUserMgr_5Test.java\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link SimpleUserMgr}.\n* It contains ten unit test cases for the {@link SimpleUserMgr#getMailbyOrg(String)} method.\n*/\nclass SimpleUserMgr_5Test {",
    "method_signature": "getMailbyOrg(String)",
    "suffix": "5"
  },
  {
    "numberTests": "ten",
    "original_code": "// SimpleUserMgr.java\n/*\n *   CVS $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\n\n/**\n * This class manages a persistent storage of Users. It can add users from a file in\n * LDAP\u0027s LDIF format.  The values required are dn (Distinguished Name), cn (Common Name), userPassword, email,\n * ou and employeeType.\n * This is intended as an interface for LDAP, but provides a simple persistent Hashtables using JDBM.\n *\n * The id Hashtable (name \"userids\") contains the User objects with the email address as the key\n * The country (name \"countries\") Hashtable contains a HashSet of all the organizations in a given country\n * To get a list of all supported countries simply get the keys of the countries Hashtable\n * There also is a persistent Hashtable for each organization with is LDAP \"o\" value as its name\n * It returns a Hashtable of users within that organization, with key the \"cn\" (Username) and value \"email\"\n * Thus a user can be looked up by username and organization and return the \"key\" email address from which\n * the full User object can be obtained from the id Hashtable\n *\n * When a new organization is encountered (with a user with \"o\" and \"c\" dn parameters, it is registered\n * into the list of organizations for that country in the country Hashtable\n *\n * JDBM (http://jdbm.sourceforge.net) persistent hashtable implemenation is used for persistence\n *\n * @author $Author: grodecki $\n * @version $Id: SimpleUserMgr.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n */\npublic class SimpleUserMgr implements UserMgr {\n\n    //private JDBMHashtable dn;\n    private JDBMHashtable id \u003d null;\n\n    private JDBMHashtable users;\n\n    private JDBMHashtable country;\n\n    private String username \u003d \"\";\n\n    // private String password \u003d \"\";\n    // private String email \u003d \"\";\n    private static String userfile \u003d \"login.users\";\n\n    private String userdb \u003d \"users\";\n\n    private static String configFile \u003d \"test\";\n\n    private JDBMRecordManager recman;\n\n    private static Properties props \u003d new Properties();\n\n    private Vector profile_vec \u003d null;\n\n    // private Hashtable users \u003d null;\n    private User user;\n\n    private static org.apache.log4j.Logger cat \u003d org.apache.log4j.Logger.getLogger(SimpleUserMgr.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public SimpleUserMgr() {\n        // Defer initialization for servlets\n        //  init();\n    }\n\n    /**\n     * Constructor which specifies the configProperties to be read\n     */\n    public SimpleUserMgr(String configProperties) {\n        setConfigFile(configProperties);\n        init();\n    }\n\n    /**\n     * Initialize Persistent storage\n     * There are two primary hashtables.   The first (country) contains a list of the organizations which are keys\n     * to user hashtables for each organization.  The organization hashtable is a map from the username\n     * key to the userId (email address).  The second (id) is the hashtable based on the email address\n     * which is used as a userId since the email address is supposed to be unique.  For each organization\n     * there is a separate hashtable of the users for that organization.  Thus one can look a user up\n     * across organizations or within an organization.  All the user objects are contained in the second (id) hashtable.\n     */\n    public void init() {\n        //  ResourceBundle bundle \u003d ResourceBundle.getBundle(configFile);\n        Login.loadProperties(props, configFile);\n        userdb \u003d props.getProperty(\"users\", userdb);\n        //      New code to find the actual db file, as long as it is on the classpath\n        String tmpDb \u003d \"/\" + userdb + \".db\";\n        URL fileUrl \u003d UserMgr.class.getResource(tmpDb);\n        String pathAndFile \u003d fileUrl.getFile();\n        // Now remove the final \u0027.db\u0027 from the returned string.\n        userdb \u003d pathAndFile.substring(0, pathAndFile.length() - 3);\n        cat.debug(\"init: accessing: \" + userdb);\n        try {\n            recman \u003d new JDBMRecordManager(userdb);\n            //dn \u003d recman.getHashtable(\"usernames\");\n            id \u003d recman.getHashtable(\"userids\");\n            if (cat.isDebugEnabled()) {\n                for (JDBMEnumeration en \u003d id.keys(); en.hasMoreElements(); ) {\n                    String key \u003d (String) en.nextElement();\n                    cat.debug(\"Key \u003d \" + key);\n                }\n            }\n            country \u003d recman.getHashtable(\"countries\");\n        } catch (IOException e) {\n            cat.error(\"init: \" + e);\n        }\n    }\n\n    /**\n     * add Users from previously defined userfile\n     */\n    public void addUsers() {\n        addUsers(userfile);\n    }\n\n    /**\n     *  Add users from an input file\n     * @param userfile\n     */\n    public void addUsers(String userfile) {\n        // Query using JNDI to get list of users, not implemented correctly yet.\n        // Read from file to get users (in ldif format)\n        // e.g.:\n        //  dn: cn\u003d David Forslund, o\u003dLANL, c\u003dUS\n        //\tcn: David Forslund\n        //\temail: dwf@lanl.gov\n        //  userPassword: test\n        // Results are put into a User object and the User into a hashtable with email/userId\n        // as the key\n        // various arrays are created for listing the users as needed.\n        // userfile \u003d props.getProperty(\"login.users\", userfile);\n        // String country \u003d props.getProperty(\"country\",\"US\");\n        try {\n            // orgs \u003d recman.getHashtable(country);\n            // Read in user list if not already done      ###\n            String line \u003d null;\n            InputStream is \u003d getClass().getResourceAsStream(userfile);\n            //if (theFile.exists()) {\n            if (is !\u003d null) {\n                cat.debug(\"Reading  \" + userfile);\n                //\tFileReader inFile \u003d new FileReader(theFile);\n                InputStreamReader inFile \u003d new InputStreamReader(is);\n                BufferedReader inReader \u003d new BufferedReader(inFile);\n                profile_vec \u003d new Vector();\n                user \u003d null;\n                // unique set of organizations in a country\n                HashSet set \u003d null;\n                while (((line \u003d inReader.readLine()) !\u003d null)) {\n                    parseLine(line);\n                }\n                //HashSet set \u003d (HashSet) orgs.get(country);\n                //if (set \u003d\u003d null) set \u003d new HashSet();\n                inReader.close();\n                if ((profile_vec !\u003d null)) {\n                    addProfile();\n                    for (int i \u003d 0; i \u003c profile_vec.size(); i++) {\n                        User u \u003d (User) profile_vec.elementAt(i);\n                        String c \u003d u.getCountry();\n                        //cat.debug(\"addUsers\\n \"+u.toString());\n                        String org \u003d u.getOrg();\n                        if (c !\u003d null)\n                            set \u003d (HashSet) country.get(c);\n                        if (set \u003d\u003d null)\n                            set \u003d new HashSet();\n                        // get the hashtable for that organization\n                        // Update list  of organizations for a country\n                        set.add(org);\n                        //  cat.debug(\"organization \u003d \" + org);\n                        JDBMHashtable users \u003d recman.getHashtable(org);\n                        // insert userID in users table with userName as key\n                        // put userId in dn with dn as key\n                        users.put(u.getUserName(), u.getUserId());\n                        // put user in id with mail as key\n                        id.put(u.getUserId(), u);\n                        country.put(c, set);\n                    }\n                    // put the list of names into the organization hashtable\n                    // cat.debug(set.size() + \" organizations\");\n                }\n            }\n        } catch (IOException e) {\n            cat.error(\"UserMgr reading error adding users \" + e, e);\n        }\n        //}\n    }\n\n    /**\n     * parse the line and add the user to the list\n     * @param line to be parsed\n     */\n    public void parseLine(String line) {\n        try {\n            //user \u003d null;\n            if (line.startsWith(\"#\") || line.startsWith(\"//\"))\n                return;\n            StringTokenizer tmp_st \u003d new StringTokenizer(line, \":\");\n            if (tmp_st.countTokens() \u003d\u003d 0)\n                return;\n            String tmp_tok \u003d tmp_st.nextToken();\n            //   System.out.println(\"parseLine: \"+tmp_tok);\n            if (tmp_tok.equals(\"dn\")) {\n                // We have a new defined person so save old data and reset\n                if (user \u003d\u003d null) {\n                    user \u003d new User();\n                } else {\n                    // user is complete so store it\n                    addProfile();\n                }\n                user.setDN(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"cn\")) {\n                user.setUserName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"email\")) {\n                user.setUserId(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"userPassword\")) {\n                //user.setPassword(tmp_st.nextToken().trim());\n                user.encodePassword(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"employeeType\")) {\n                // specify role(s) of user\n                user.addRole(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ou\")) {\n                // specify group(s) of user\n                user.addGroup(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"sn\")) {\n                user.setSurName(tmp_st.nextToken().trim());\n            } else if (tmp_tok.equals(\"ip\")) {\n                // specify ip Addr of user\n                user.setIpAddr(tmp_st.nextToken().trim());\n            }\n        } catch (Exception e) {\n            cat.error(\"parseLine failed:\" + e);\n        }\n    }\n\n    /**\n     * Add the user profile\n     */\n    private void addProfile() {\n        profile_vec.addElement(user);\n        //  cat.debug(\"name: \"+user.getUserName()+\", email: \"+user.getUserId()+\", passwd: \"+user.getPassword());\n        user \u003d new User();\n    }\n\n    /**\n     * addUser\n     * @param u String with multiple lines with all the data for a user\n     */\n    public void addUser(String u) {\n        BufferedReader reader \u003d new BufferedReader(new StringReader(u));\n        String line \u003d null;\n        User saveUser \u003d user;\n        try {\n            while ((line \u003d reader.readLine()) !\u003d null) parseLine(line);\n            if (user !\u003d null)\n                addUser(user);\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n        user \u003d saveUser;\n    }\n\n    /**\n     * add User to the Persistent Hashtable\n     * @param theDN The distinguished name (cn\u003d \"name\", o\u003d\"organization\", c\u003d\"country\")\n     * @param cn  LDAP username\n     * @param sn   LDAP surname\n     * @param email   LDAP email address (userId)\n     * @param role\n     * @param password\n     */\n    public void addUser(String theDN, String cn, String sn, String email, String role, String password) {\n        User newUser \u003d new User(email, cn);\n        newUser.addRole(role);\n        newUser.setPassword(password);\n        newUser.setSurName(sn);\n        newUser.setDN(theDN);\n        addUser(newUser);\n    }\n\n    /**\n     *  Add a User already constructed\n     * @param newUser\n     */\n    public void addUser(User newUser) {\n        String c \u003d newUser.getCountry();\n        String org \u003d newUser.getOrg();\n        String userName \u003d newUser.getUserName();\n        String email \u003d newUser.getUserId();\n        cat.debug(\"addUser: \" + newUser.toString());\n        User oldUser \u003d getUser(newUser);\n        if (oldUser \u003d\u003d null)\n            oldUser \u003d new User();\n        oldUser.update(newUser);\n        try {\n            // First make sure the organization is in the country list\n            HashSet set \u003d (HashSet) country.get(c);\n            if (set \u003d\u003d null)\n                set \u003d new HashSet();\n            set.add(org);\n            country.put(c, set);\n            // get the users Hashtable based on the organization\n            users \u003d recman.getHashtable(org);\n            users.put(userName, email);\n            id.put(email, oldUser);\n            cat.debug(\"User: \" + oldUser.toString() + \" added!\");\n        } catch (IOException e) {\n            cat.error(\"addUser: \" + e);\n        }\n    }\n\n    /**\n     * delete User based on the unique UserId\n     * @param userId corresponding to email address\n     */\n    public void delUser(String userId) {\n        try {\n            cat.debug(\"delUser trying to remove: \" + userId);\n            User delUser \u003d (User) id.get(userId);\n            if (delUser !\u003d null) {\n                id.remove(userId);\n                cat.debug(\"delUser removed from id: \" + userId);\n                String uName \u003d delUser.getUserName();\n                users \u003d recman.getHashtable(delUser.getOrg());\n                cat.debug(\"removing \" + uName + \" from dn\");\n                String u \u003d (String) users.get(uName);\n                if (u !\u003d null) {\n                    users.remove(uName);\n                    cat.debug(\"delUser removed from dn: \" + uName);\n                }\n            } else\n                cat.debug(\"delUser: id\u003d\u0027\" + userId + \"\u0027 not found\");\n        } catch (IOException e) {\n            cat.error(\"delUser: \" + userId + \" \" + e);\n        }\n    }\n\n    /**\n     * get the User based on name and organization\n     * @param userName\n     * @param org\n     * @return User\n     */\n    public User getUser(String userName, String org) {\n        User user \u003d null;\n        try {\n            users \u003d recman.getHashtable(org);\n            String userId \u003d (String) users.get(username);\n            if (userId !\u003d null)\n                user \u003d (User) id.get(userId);\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + userName + \",\" + org + \"): not found\");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    public User getUser() {\n        cat.debug(\"userID: \" + user.getUserId());\n        cat.debug(\"userName: \" + user.getUserName());\n        return user;\n    }\n\n    /**\n     * get User by the unique userId (email)\n     * @param userId\n     * @return User\n     */\n    public User getUser(String userId) {\n        cat.debug(\"getUser: \" + userId);\n        User user \u003d null;\n        try {\n            user \u003d (User) id.get(userId);\n            cat.debug(\"getUser: found user \" + user.toString());\n        } catch (Exception e) {\n            user \u003d null;\n            cat.error(\"getUser: user not found \" + e);\n        }\n        //cat.debug(\"getUser: found user \" + user.toString());\n        return user;\n    }\n\n    /**\n     * get User with username, org and email\n     * @param username  cn variable\n     * @param org       o variable\n     * @param email       email variable\n     * @return User\n     */\n    public User getUser(String username, String org, String email) {\n        User user \u003d null;\n        try {\n            // try unique email first (this should always return the user)\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (org !\u003d null) \u0026\u0026 (username !\u003d null)) {\n                // get the user list for the organization\n                users \u003d recman.getHashtable(org);\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null)\n                cat.warn(\"getUser(\" + username + \",\" + org + \",\" + email + \"): user not found, \");\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Find a User given a partially completed User object as a template\n     * @param findUser\n     * @return User\n     */\n    public User getUser(User findUser) {\n        User user \u003d new User();\n        String email \u003d findUser.getUserId();\n        try {\n            if (email !\u003d null \u0026\u0026 !email.equals(\"\"))\n                user \u003d (User) id.get(email);\n            if ((user \u003d\u003d null) \u0026\u0026 (findUser.getOrg() !\u003d null) \u0026\u0026 findUser.getUserName() !\u003d null) {\n                users \u003d recman.getHashtable(findUser.getOrg());\n                if (users !\u003d null) {\n                    String userid \u003d (String) users.get(username);\n                    if (userid !\u003d null)\n                        user \u003d (User) id.get(userid);\n                }\n            }\n            if (user \u003d\u003d null) {\n                cat.warn(\"getUser(\" + findUser.toString() + \"): user not found\");\n            }\n        } catch (IOException e) {\n            cat.error(\"getUser: \" + e);\n        }\n        return user;\n    }\n\n    /**\n     * Get all the userNames for a given organization\n     * @param org the organization name (o field in LDAP);\n     * @return String[] list of names within the organization\n     */\n    public String[] getNamesbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.keys();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getNamesbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get the email addresses of all users in an organization\n     * @param org name of the organization (o LDAP field)\n     * @return String[] array of email addresses\n     */\n    public String[] getMailbyOrg(String org) {\n        Vector v \u003d new Vector();\n        try {\n            JDBMHashtable users \u003d recman.getHashtable(org);\n            JDBMEnumeration e \u003d users.values();\n            while (e.hasMoreElements()) {\n                v.addElement(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getMailbyOrg: \" + e1);\n        }\n        String[] s \u003d new String[v.size()];\n        v.copyInto(s);\n        return s;\n    }\n\n    /**\n     * get list of all UserIds in DB\n     * @return String[] list of UserIds\n     */\n    public String[] getUserIds() {\n        String[] mail;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.keys();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(e.nextElement());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserIds: \" + e1);\n            return new String[0];\n        }\n        mail \u003d new String[v.size()];\n        v.toArray(mail);\n        // cat.debug(\"getUserIds: \"+mail.length +\" mail: \"+mail[0]);\n        return mail;\n    }\n\n    /**\n     * obtain list of valid users\n     * @return String[] list of known users\n     */\n    public String[] getUserNames() {\n        String[] names;\n        if (id \u003d\u003d null)\n            init();\n        ArrayList v \u003d null;\n        try {\n            JDBMEnumeration e \u003d id.values();\n            v \u003d new ArrayList();\n            while (e.hasMoreElements()) {\n                v.add(((User) e.nextElement()).getUserName());\n            }\n        } catch (IOException e1) {\n            cat.error(\"getUserNames: \" + e1);\n            return new String[0];\n        }\n        // for (int i \u003d 0;i\u003c v.size(); i++)\n        //      cat.debug(\"name: \"+v.get(i));\n        names \u003d new String[v.size()];\n        cat.debug(\"getUserNames: found \" + names.length + \" elements\");\n        v.toArray(names);\n        return names;\n    }\n\n    /**\n     * Bean setter  and getter methods\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     *  set the file of users to be read.\n     * @param file to be read\n     */\n    public static void setUserfile(String file) {\n        userfile \u003d file;\n    }\n\n    /**\n     * get all the users in in the persistent hashtable\n     * @return String\n     */\n    public String export() {\n        try {\n            JDBMEnumeration c \u003d id.values();\n            StringBuffer buff \u003d new StringBuffer();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n            return buff.toString();\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n            return null;\n        }\n    }\n\n    public boolean checkSecret(String userid, String password, String authType) {\n        user \u003d getUser(userid);\n        if (user !\u003d null) {\n            String passwd \u003d user.getPassword();\n            if (passwd \u003d\u003d null)\n                return false;\n            return user.checkDigest(passwd, password);\n        } else\n            return false;\n    }\n\n    public void logOut() {\n        return;\n    }\n\n    public static void main(String[] argv) {\n        if (argv.length \u003c 1) {\n            System.out.println(\"usage: SimpleUserMgr \u0027file\u0027 where \u0027file\u0027 is a ResourceBundle (file.properties)\\n\" + \"that has an optional property \u0027users\u0027 which is the name of the database to be created or read\\n\" + \"and a property \u0027login.users\u0027 is a ldif text file containing the users to be added.\");\n            System.exit(0);\n        }\n        SimpleUserMgr.setConfigFile(argv[0]);\n        System.out.println(\"Config Resource is \" + argv[0] + \".properties\");\n        SimpleUserMgr userMgr \u003d new SimpleUserMgr();\n        userMgr.init();\n        String file \u003d props.getProperty(userfile, \"/users.txt\");\n        System.out.println(\"User File is \" + file);\n        if (file !\u003d null \u0026\u0026 file !\u003d \"\")\n            userMgr.addUsers(file);\n        System.out.println(\"Users Added:\\n\" + userMgr.export());\n    }\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "SimpleUserMgr",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/SimpleUserMgr_6Test.java",
    "test_prompt": "// SimpleUserMgr_6Test.java\npackage com.browsersoft.aacs;\n\nimport jdbm.JDBMEnumeration;\nimport jdbm.JDBMHashtable;\nimport jdbm.JDBMRecordManager;\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.StringReader;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Properties;\nimport java.util.StringTokenizer;\nimport java.util.Vector;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link SimpleUserMgr}.\n* It contains ten unit test cases for the {@link SimpleUserMgr#export()} method.\n*/\nclass SimpleUserMgr_6Test {",
    "method_signature": "export()",
    "suffix": "6"
  },
  {
    "numberTests": "ten",
    "original_code": "// FilePolicyModule.java\n/*\n * @(#)FilePolicyModule.java\n *\n * Copyright 2003-2006 Sun Microsystems, Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n *   1. Redistribution of source code must retain the above copyright notice,\n *      this list of conditions and the following disclaimer.\n * \n *   2. Redistribution in binary form must reproduce the above copyright\n *      notice, this list of conditions and the following disclaimer in the\n *      documentation and/or other materials provided with the distribution.\n *\n * Neither the name of Sun Microsystems, Inc. or the names of contributors may\n * be used to endorse or promote products derived from this software without\n * specific prior written permission.\n * \n * This software is provided \"AS IS,\" without a warranty of any kind. ALL\n * EXPRESS OR IMPLIED CONDITIONS, REPRESENTATIONS AND WARRANTIES, INCLUDING\n * ANY IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE\n * OR NON-INFRINGEMENT, ARE HEREBY EXCLUDED. SUN MICROSYSTEMS, INC. (\"SUN\")\n * AND ITS LICENSORS SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY LICENSEE\n * AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR ITS\n * DERIVATIVES. IN NO EVENT WILL SUN OR ITS LICENSORS BE LIABLE FOR ANY LOST\n * REVENUE, PROFIT OR DATA, OR FOR DIRECT, INDIRECT, SPECIAL, CONSEQUENTIAL,\n * INCIDENTAL OR PUNITIVE DAMAGES, HOWEVER CAUSED AND REGARDLESS OF THE THEORY\n * OF LIABILITY, ARISING OUT OF THE USE OF OR INABILITY TO USE THIS SOFTWARE,\n * EVEN IF SUN HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\n *\n * You acknowledge that this software is not designed or intended for use in\n * the design, construction, operation or maintenance of any nuclear facility.\n */\npackage com.browsersoft.aacs.xacml;\n\nimport com.browsersoft.aacs.Login;\nimport com.sun.xacml.AbstractPolicy;\nimport com.sun.xacml.EvaluationCtx;\nimport com.sun.xacml.MatchResult;\nimport com.sun.xacml.ParsingException;\nimport com.sun.xacml.Policy;\nimport com.sun.xacml.ctx.Status;\nimport com.sun.xacml.PolicyReference;\nimport com.sun.xacml.PolicySet;\nimport com.sun.xacml.finder.PolicyFinder;\nimport com.sun.xacml.finder.PolicyFinderModule;\nimport com.sun.xacml.finder.PolicyFinderResult;\nimport com.sun.xacml.PolicyMetaData;\nimport com.sun.xacml.PolicyReference;\nimport com.sun.xacml.PolicySet;\nimport com.sun.xacml.VersionConstraints;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Set;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\nimport java.net.MalformedURLException;\nimport java.net.URI;\nimport java.net.URL;\nimport com.sun.xacml.support.finder.PolicyReader;\n\n/**\n * This module represents a collection of files containing polices,\n * each of which will be searched through when trying to find a\n * policy that is applicable to a specific request. It does not support\n * policy references.\n * \u003cp\u003e\n * Note that this class used to be provided in the\n * \u003ccode\u003ecom.sun.xacml.finder.impl\u003c/code\u003e package with a warning that it\n * would move out of the core packages eventually. This is partly because\n * this class doesn\u0027t represent standard functionality, and partly because\n * it isn\u0027t designed to be generally useful as anything more than an\n * example. Because so many people have used this class, however, it stayed\n * in place until the 2.0 release.\n * \u003cp\u003e\n * As of the 2.0 release, you may still use this class (in its new location),\n * but you are encouraged to migrate to the new support modules that are\n * much richer and designed for general-purpose use. Also, note that the\n * \u003ccode\u003eloadPolicy\u003c/code\u003e methods that used to be available from this class\n * have been removed. That functionality has been replaced by the much more\n * useful \u003ccode\u003ePolicyReader\u003c/code\u003e class. If you need to load policies\n * directly, you should consider that new class.\n *\n * @since 1.0\n * @author Seth Proctor\n */\npublic class FilePolicyModule extends com.sun.xacml.support.finder.FilePolicyModule {\n\n    // the reader used to load all policies\n    private PolicyReader reader;\n\n    // the Policy directory\n    private String policyDir;\n\n    // the schema file we\u0027re using, if any\n    private File schemaFile \u003d null;\n\n    // the logger we\u0027ll use for all messages\n    private static final Logger logger \u003d Logger.getLogger(FilePolicyModule.class.getName());\n\n    /**\n     * Constructor which retrieves the schema file to validate policies against\n     * from the \u003ccode\u003ePolicyReader.POLICY_SCHEMA_PROPERTY\u003c/code\u003e. If the\n     * retrieved property is null, then no schema validation will occur.\n     */\n    public FilePolicyModule() {\n        super();\n        String schemaName \u003d System.getProperty(PolicyReader.POLICY_SCHEMA_PROPERTY);\n        if (schemaName !\u003d null)\n            schemaFile \u003d new File(schemaName);\n    }\n\n    /**\n     * Constructor that uses the specified \u003ccode\u003eFile\u003c/code\u003e as the schema\n     * file for XML validation. If schema validation is not desired, a null\n     * value should be used.\n     *\n     * @param schemaFile the schema file to validate policies against,\n     *                   or null if schema validation is not desired.\n     */\n    public FilePolicyModule(File schemaFile) {\n        super(schemaFile);\n        this.schemaFile \u003d schemaFile;\n    }\n\n    /**\n     * Constructor that uses the specified \u003ccode\u003eString\u003c/code\u003e as the schema\n     * file for XML validation. If schema validation is not desired, a null\n     * value should be used.\n     *\n     * @param schemaFile the schema file to validate policies against,\n     *                   or null if schema validation is not desired.\n     */\n    public FilePolicyModule(String schemaFile) {\n        super(schemaFile);\n        this.schemaFile \u003d ((schemaFile !\u003d null) ? new File(schemaFile) : null);\n    }\n\n    /**\n     * Constructor that specifies a set of initial policy files to use. This\n     * retrieves the schema file to validate policies against from the\n     * \u003ccode\u003ePolicyReader.POLICY_SCHEMA_PROPERTY\u003c/code\u003e. If the retrieved\n     * property is null, then no schema validation will occur.\n     *\n     * @param fileNames a \u003ccode\u003eList\u003c/code\u003e of \u003ccode\u003eString\u003c/code\u003es that\n     *                  identify policy files\n     */\n    public FilePolicyModule(List fileNames) {\n        super(fileNames);\n        String schemaName \u003d System.getProperty(PolicyReader.POLICY_SCHEMA_PROPERTY);\n        if (schemaName !\u003d null)\n            schemaFile \u003d new File(schemaName);\n    }\n\n    /**\n     * Constructor that specifies a set of initial policy files to use and\n     * the schema file used to validate the policies. If schema validation is\n     * not desired, a null value should be used.\n     *\n     * @param fileNames a \u003ccode\u003eList\u003c/code\u003e of \u003ccode\u003eString\u003c/code\u003es that\n     *                  identify policy files\n     * @param schemaFile the schema file to validate policies against,\n     *                   or null if schema validation is not desired.\n     */\n    public FilePolicyModule(List fileNames, String schemaFile) {\n        super(fileNames, schemaFile);\n        this.schemaFile \u003d ((schemaFile !\u003d null) ? new File(schemaFile) : null);\n    }\n\n    /**\n     * Initializes the \u003ccode\u003eFilePolicyModule\u003c/code\u003e by loading\n     * the policies contained in the collection of files associated\n     * with this module. This method also uses the specified\n     * \u003ccode\u003ePolicyFinder\u003c/code\u003e to help in instantiating PolicySets.\n     *\n     * init() also gets the Policy file directory to be used for\n     * resolving references.\n     *\n     * @param finder a PolicyFinder used to help in instantiating PolicySets\n     */\n    public void init(PolicyFinder finder) {\n        super.init(finder);\n        reader \u003d new PolicyReader(finder, logger, schemaFile);\n        policyDir \u003d Login.getProps().getProperty(\"XACMLPolicyDir\", \"webapps/share/WEB-INF/classes/xacml/policy/\");\n    }\n\n    /**\n     * Always returns \u003ccode\u003etrue\u003c/code\u003e since this module does support\n     * finding policies based on reference.\n     *\n     * @return true\n     */\n    public boolean isIdReferenceSupported() {\n        return true;\n    }\n\n    /**\n     * Attempts to find a policy by reference, based on the provided\n     * parameters. Specifically, this module will try to treat the reference\n     * as a URL, and resolve that URL directly. If the reference is not\n     * a valid URL, cannot be resolved, or does not resolve to an XACML\n     * policy, then no matching policy is returned. This method never\n     * returns an error.\n     *\n     * @param idReference an identifier specifying some policy\n     * @param type type of reference (policy or policySet) as identified by\n     *             the fields in \u003ccode\u003ePolicyReference\u003c/code\u003e\n     * @param constraints any optional constraints on the version of the\n     *                    referenced policy (this will never be null, but\n     *                    it may impose no constraints, and in fact will\n     *                    never impose constraints when used from a pre-2.0\n     *                    XACML policy)\n     * @param parentMetaData the meta-data from the parent policy, which\n     *                       provides XACML version, factories, etc.\n     *\n     * @return the result of looking for a matching policy\n     */\n    public PolicyFinderResult findPolicy(URI idReference, int type, VersionConstraints constraints, PolicyMetaData parentMetaData) {\n        // see if the URI is in fact a URL\n        URL url \u003d null;\n        try {\n            url \u003d new URL(\"file:\" + policyDir + idReference.toString() + \".xml\");\n        } catch (MalformedURLException murle) {\n            // it\u0027s not a URL, so we can\u0027t handle this reference\n            return new PolicyFinderResult();\n        }\n        // try resolving the URL\n        AbstractPolicy policy \u003d null;\n        try {\n            policy \u003d reader.readPolicy(url);\n        } catch (ParsingException pe) {\n            // An error loading the policy could be many things (the URL\n            // doesn\u0027t actually resolve a policy, the server is down, the\n            // policy is invalid, etc.). This could be interpreted as an\n            // error case, or simply as a case where no applicable policy\n            // is available (as is done when we pre-load policies). This\n            // module chooses the latter interpretation.\n            return new PolicyFinderResult();\n        }\n        // check that we got the right kind of policy...if we didn\u0027t, then\n        // we can\u0027t handle the reference\n        if (type \u003d\u003d PolicyReference.POLICY_REFERENCE) {\n            if (!(policy instanceof Policy))\n                return new PolicyFinderResult();\n        } else {\n            if (!(policy instanceof PolicySet))\n                return new PolicyFinderResult();\n        }\n        // finally, check that the constraints match ... note that in a more\n        // powerful module, you could actually have used the constraints to\n        // construct a more specific URL, passed the constraints to the\n        // server, etc., but this example module is staying simple\n        if (!constraints.meetsConstraint(policy.getVersion()))\n            return new PolicyFinderResult();\n        // if we got here, then we successfully resolved a policy that is\n        // the correct type, so return it\n        return new PolicyFinderResult(policy);\n    }\n}\n",
    "package": "com.browsersoft.aacs.xacml",
    "classname": "FilePolicyModule",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/xacml/FilePolicyModule.java",
    "test_prompt": "// FilePolicyModuleTest.java\npackage com.browsersoft.aacs.xacml;\n\nimport com.browsersoft.aacs.Login;\nimport com.sun.xacml.AbstractPolicy;\nimport com.sun.xacml.EvaluationCtx;\nimport com.sun.xacml.MatchResult;\nimport com.sun.xacml.ParsingException;\nimport com.sun.xacml.Policy;\nimport com.sun.xacml.ctx.Status;\nimport com.sun.xacml.PolicyReference;\nimport com.sun.xacml.PolicySet;\nimport com.sun.xacml.finder.PolicyFinder;\nimport com.sun.xacml.finder.PolicyFinderModule;\nimport com.sun.xacml.finder.PolicyFinderResult;\nimport com.sun.xacml.PolicyMetaData;\nimport com.sun.xacml.PolicyReference;\nimport com.sun.xacml.PolicySet;\nimport com.sun.xacml.VersionConstraints;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Set;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\nimport java.net.MalformedURLException;\nimport java.net.URI;\nimport java.net.URL;\nimport com.sun.xacml.support.finder.PolicyReader;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link FilePolicyModule}.\n* It contains ten unit test cases for the {@link FilePolicyModule#findPolicy(URI, int, VersionConstraints, PolicyMetaData)} method.\n*/\nclass FilePolicyModuleTest {",
    "method_signature": "findPolicy(URI, int, VersionConstraints, PolicyMetaData)",
    "suffix": ""
  },
  {
    "numberTests": "ten",
    "original_code": "// User.java\n/*\n *   CVS $Id: User.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport java.io.Serializable;\nimport java.security.MessageDigest;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport javax.naming.ldap.LdapContext;\nimport org.apache.xerces.impl.dv.util.Base64;\n\n/**\n * User class contains all the necessary attributes of a logged in user\n * @author $Author: grodecki $\n * @version $Id: User.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n */\npublic class User implements Comparable, Serializable {\n\n    // static final long serialVersionUID \u003d -3313178117323543078L;\n    static final long serialVersionUID \u003d 6729362233633496647L;\n\n    // id (key)\n    private String userId \u003d \"\";\n\n    // current IP address\n    private String ipAddr;\n\n    //cn CommonName\n    private String userName \u003d \"\";\n\n    private String email \u003d \"\";\n\n    private Set roles;\n\n    private Set groups;\n\n    // Groups active for the user based on his location\n    private Set activegroups;\n\n    private String passvalidstart \u003d \"\";\n\n    private String passrenewal \u003d \"\";\n\n    // user password change required before using the system?\n    private boolean passchange \u003d false;\n\n    private Set allowedips;\n\n    LdapContext dctx;\n\n    // private String dn;  //Distinguished name    (cn, o, c)\n    // c\n    private String country \u003d \"\";\n\n    // o\n    private String organization \u003d \"\";\n\n    // encrypted    // userPassword\n    private String passwd \u003d \"\";\n\n    // surname\n    private String sn \u003d \"\";\n\n    private transient MessageDigest sha;\n\n    private static String sep \u003d System.getProperty(\"line.separator\");\n\n    private static String salt \u003d \"XXXX\";\n\n    private static org.apache.log4j.Logger cat \u003d org.apache.log4j.Logger.getLogger(User.class.getName());\n\n    public User() {\n    }\n\n    /**\n     * User object constructed from userId and userName\n     */\n    public User(String userId, String userName) {\n        this();\n        //\tSystem.out.println(\"userId: \"+userId);\n        //id\n        this.userId \u003d userId.trim();\n        //cn\n        this.userName \u003d userName.trim();\n    }\n\n    public void init() {\n        try {\n            sha \u003d MessageDigest.getInstance(\"SHA-1\");\n        } catch (java.security.NoSuchAlgorithmException e) {\n            cat.error(\"SHA-1 constructor failed: \", e);\n        }\n    }\n\n    /**\n     * get userId previously set\n     * @return userId\n     */\n    public String getUserId() {\n        //\tSystem.out.println(\"getUserId: \"+userId);\n        return userId;\n    }\n\n    /**\n     * set the UserId\n     * @param id to be set\n     */\n    public void setUserId(String id) {\n        userId \u003d id.trim();\n    }\n\n    /**\n     * encode the  password\n     * @param password to be encoded\n     */\n    public void encodePassword(String password) {\n        // only set password if it is non null.\n        if (passwd !\u003d null \u0026\u0026 (password !\u003d null) \u0026\u0026 !password.equals(\"\"))\n            passwd \u003d createDigest(salt.getBytes(), password);\n    }\n\n    /**\n     * Validate the password\n     * @param password\n     * @return\n     */\n    public boolean checkPassword(String password) {\n        if (passwd \u003d\u003d null)\n            return false;\n        return checkDigest(passwd, password);\n    }\n\n    /**\n     * set the encrypted password\n     * @param password  as encrypted digest (SHA algorithm)\n     */\n    public void setPassword(String password) {\n        passwd \u003d password;\n    }\n\n    /**\n     * get the encrypted Password\n     * @return encrypted password string\n     */\n    public String getPassword() {\n        return passwd;\n    }\n\n    /**\n     * set the SurName\n     * @param surname\n     */\n    public void setSurName(String surname) {\n        sn \u003d surname;\n    }\n\n    /**\n     * get the SurName\n     * @return sn\n     */\n    public String getSurName() {\n        return sn;\n    }\n\n    /**\n     * get userName\n     * @return userName\n     */\n    public String getUserName() {\n        return userName;\n    }\n\n    /**\n     * set the User Name (cn field in LDAP\n     * @param name\n     */\n    public void setUserName(String name) {\n        userName \u003d name.trim();\n    }\n\n    /**\n     * get the IpAddr of this user\n     * @return String containing ipAddr\n     */\n    public String getIpAddr() {\n        return ipAddr;\n    }\n\n    /**\n     * set the IpAddr of this user\n     * @param ipAddr  (should validate the address)\n     */\n    public void setIpAddr(String ipAddr) {\n        this.ipAddr \u003d ipAddr;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        email \u003d email.trim();\n    }\n\n    public Set getRoles() {\n        return roles;\n    }\n\n    public void addRole(String role) {\n        if (roles \u003d\u003d null)\n            roles \u003d new HashSet();\n        roles.add(role);\n    }\n\n    public Set getGroups() {\n        return groups;\n    }\n\n    public void addGroup(String group) {\n        if (groups \u003d\u003d null)\n            groups \u003d new HashSet();\n        groups.add(group);\n    }\n\n    public Set getActivegroups() {\n        return activegroups;\n    }\n\n    public void addActivegroup(String group) {\n        if (activegroups \u003d\u003d null)\n            activegroups \u003d new HashSet();\n        activegroups.add(group);\n    }\n\n    public String getPassvalidstart() {\n        return passvalidstart;\n    }\n\n    public void setPassvalidstart(String passvalidstart) {\n        this.passvalidstart \u003d passvalidstart;\n    }\n\n    public String getPassrenewal() {\n        return passrenewal;\n    }\n\n    public void setPassrenewal(String passrenewal) {\n        this.passrenewal \u003d passrenewal;\n    }\n\n    public boolean getPasschange() {\n        return passchange;\n    }\n\n    public void setPasschange(boolean passchange) {\n        this.passchange \u003d passchange;\n    }\n\n    public Set getAllowedips() {\n        return allowedips;\n    }\n\n    public void addAllowedip(String allowed_ip) {\n        if (allowedips \u003d\u003d null)\n            allowedips \u003d new HashSet();\n        allowedips.add(allowed_ip);\n    }\n\n    public void setLdapContext(LdapContext dctx) {\n        this.dctx \u003d dctx;\n    }\n\n    public LdapContext getLdapContext() {\n        return dctx;\n    }\n\n    /**\n     * set the Distinguished Name of the person\n     * @param dn containing distinguished name    (should check its validity)\n     */\n    public void setDN(String dn) {\n        //  cat.debug(\"setDN: \" + dn);\n        if (dn !\u003d null) {\n            StringTokenizer st \u003d new StringTokenizer(dn, \",\");\n            while (st.hasMoreTokens()) {\n                String tok \u003d st.nextToken();\n                StringTokenizer stoken \u003d new StringTokenizer(tok, \"\u003d\");\n                String name \u003d stoken.nextToken();\n                // System.out.println(\"token: \"+tok +\" name: \"+name);\n                if (name.trim().equals(\"o\")) {\n                    organization \u003d stoken.nextToken();\n                    //   cat.debug(\"org: \"+organization);\n                    //break;\n                } else if (name.trim().equals(\"c\")) {\n                    country \u003d stoken.nextToken();\n                } else if (name.trim().equals(\"cn\")) {\n                    userName \u003d stoken.nextToken();\n                }\n            }\n        } else\n            cat.warn(\"setDN: dn is null\");\n        return;\n    }\n\n    /**\n     * set the salt for encryption\n     * @param theSalt\n     */\n    public static void setSalt(String theSalt) {\n        salt \u003d theSalt;\n    }\n\n    /**\n     * get the Distinguished Name of the Person\n     * @return String containing the distinguished name\n     */\n    public String getDN() {\n        return \"cn\u003d\" + userName + \", o\u003d\" + organization + \", c\u003d\" + country;\n        //  return dn;\n    }\n\n    /**\n     * get the country (c) parameter\n     * @return country\n     */\n    public String getCountry() {\n        return country;\n    }\n\n    /**\n     * set the country parameter\n     * @param c country\n     */\n    public void setCountry(String c) {\n        country \u003d c;\n    }\n\n    /**\n     * get the Organization of the user from the Distinguished Name dn\n     * @return String representing the organization\n     * The dn string is of the form cn\u003d\"name\", o\u003d\"organization\", c\u003d\"country\"\n     */\n    public String getOrg() {\n        return organization;\n    }\n\n    /**\n     * Return a Properties sheet with identification\n     * @return\n     */\n    public Properties getCredentials() {\n        Properties props \u003d new Properties();\n        props.setProperty(\"subjectDN\", getDN());\n        props.setProperty(\"EMail\", getUserId());\n        return props;\n    }\n\n    /**\n     * set the organization\n     */\n    public void setOrg(String org) {\n        organization \u003d org;\n    }\n\n    /**\n     * copy nonempty fiels into the fields of object\n     * @param newUser\n     */\n    public void update(User newUser) {\n        organization \u003d newUser.getOrg();\n        country \u003d newUser.getCountry();\n        roles \u003d newUser.getRoles();\n        groups \u003d newUser.getGroups();\n        userName \u003d newUser.getUserName();\n        sn \u003d newUser.getSurName();\n        passwd \u003d newUser.getPassword();\n        userId \u003d newUser.getUserId();\n    }\n\n    /**\n     * String representation of user is simply its userId;\n     * @return String representation of User\n     */\n    public String toString() {\n        // char sep \u003d \u0027\\n\u0027;\n        StringBuffer buff \u003d new StringBuffer();\n        buff.append(\"dn: \" + getDN() + sep);\n        buff.append(\"cn: \" + getUserName() + sep);\n        buff.append(\"id: \" + getUserId() + sep);\n        buff.append(\"sn: \" + getSurName() + sep);\n        buff.append(\"userPassword: \" + getPassword() + sep);\n        if (getRoles() !\u003d null) {\n            Iterator it \u003d getRoles().iterator();\n            while (it.hasNext()) buff.append(\"role: \" + (String) (it.next()) + sep);\n        }\n        if (getGroups() !\u003d null) {\n            Iterator it \u003d getGroups().iterator();\n            while (it.hasNext()) buff.append(\"group: \" + (String) (it.next()) + sep);\n        }\n        if (getIpAddr() !\u003d null)\n            buff.append(\"ip: \" + getIpAddr() + sep);\n        buff.append(\"objectClass: top\" + sep);\n        buff.append(\"objectClass: person\" + sep);\n        return buff.toString();\n    }\n\n    /**\n     * String representation with user defined separator\n     * @param sep\n     * @return String representation of User\n     */\n    public String toString(String sep) {\n        StringBuffer buff \u003d new StringBuffer();\n        buff.append(\"dn: \" + getDN() + sep);\n        buff.append(\"cn: \" + getUserName() + sep);\n        buff.append(\"id: \" + getUserId() + sep);\n        buff.append(\"sn: \" + getSurName() + sep);\n        buff.append(\"userPassword: \" + getPassword() + sep);\n        Set rolebuf \u003d new HashSet();\n        rolebuf \u003d getRoles();\n        Iterator it \u003d rolebuf.iterator();\n        while (it.hasNext()) buff.append(\"role: \" + (String) (it.next()) + sep);\n        Set groupbuf \u003d new HashSet();\n        groupbuf \u003d getGroups();\n        it \u003d groupbuf.iterator();\n        while (it.hasNext()) buff.append(\"group: \" + (String) (it.next()) + sep);\n        buff.append(\"objectClass: top\" + sep);\n        buff.append(\"objectClass: person\" + sep);\n        return buff.toString();\n    }\n\n    /**\n     * create hashCode combining unique userId and ipAddr so user\n     * is distinguished coming from different \"locations\"\n     */\n    public int hashCode() {\n        // Improve hashcode calculation using member variables of this class\n        return 13 * userId.hashCode() + 7 * ipAddr.hashCode();\n    }\n\n    /**\n     *  Equality check for user to see if he is already known.\n     */\n    public boolean equals(Object user) {\n        // Return true if the result of the compareTo() method is zero\n        return compareTo(user) \u003d\u003d 0;\n    }\n\n    /**\n     *  Compare to operation to see if the input user is the same as this user.\n     */\n    public int compareTo(Object user) {\n        // Compare the user IDs of the two user objects -\n        //  result is zero if they\u0027re identical (uses String compareTo function)\n        int result \u003d userId.compareTo(((User) user).getUserId());\n        // If result is zero from previous method, return the comparison of IP addresses.\n        // Otherwise, return the result.\n        return result \u003d\u003d 0 ? ipAddr.compareTo(((User) user).getIpAddr()) : result;\n    }\n\n    /**\n     * Create Digest for each input identity\n     * @param salt to set the base for the encryption\n     * @param identity to be encrypted\n     */\n    public String createDigest(byte[] salt, String identity) {\n        String label \u003d (salt.length \u003e 0) ? \"{SSHA}\" : \"{SHA}\";\n        if (sha \u003d\u003d null)\n            init();\n        sha.reset();\n        sha.update(identity.getBytes());\n        sha.update(salt);\n        byte[] pwhash \u003d sha.digest();\n        return label + new String(Base64.encode(concatenate(pwhash, salt)));\n    }\n\n    /**\n     * Check Digest against identity\n     * @param digest is digest to be checked against\n     * @param identity to be checked\n     */\n    public boolean checkDigest(String digest, String identity) {\n        if (digest.regionMatches(true, 0, \"{SHA}\", 0, 5)) {\n            // ignore the label\n            digest \u003d digest.substring(5);\n        } else if (digest.regionMatches(true, 0, \"{SSHA}\", 0, 6)) {\n            // ignore the label\n            digest \u003d digest.substring(6);\n        }\n        byte[][] hs \u003d split(Base64.decode(digest.getBytes()), 20);\n        byte[] hash \u003d hs[0];\n        byte[] salt \u003d hs[1];\n        if (sha \u003d\u003d null)\n            init();\n        sha.reset();\n        sha.update(identity.getBytes());\n        sha.update(salt);\n        byte[] pwhash \u003d sha.digest();\n        boolean valid \u003d true;\n        if (!MessageDigest.isEqual(hash, pwhash)) {\n            valid \u003d false;\n            cat.warn(\"doesn\u0027t match: \" + identity);\n        }\n        return valid;\n    }\n\n    /**\n     * Combine two byte arrays\n     * @param l first byte array\n     * @param r second byte array\n     * @return byte[] combined byte array\n     */\n    private static byte[] concatenate(byte[] l, byte[] r) {\n        byte[] b \u003d new byte[l.length + r.length];\n        System.arraycopy(l, 0, b, 0, l.length);\n        System.arraycopy(r, 0, b, l.length, r.length);\n        return b;\n    }\n\n    /**\n     * split a byte array in two\n     * @param src byte array to be split\n     * @param n element at which to split the byte array\n     * @return byte[][]  two byte arrays that have been split\n     */\n    private static byte[][] split(byte[] src, int n) {\n        byte[] l, r;\n        if (src \u003d\u003d null || src.length \u003c\u003d n) {\n            l \u003d src;\n            r \u003d new byte[0];\n        } else {\n            l \u003d new byte[n];\n            r \u003d new byte[src.length - n];\n            System.arraycopy(src, 0, l, 0, n);\n            System.arraycopy(src, n, r, 0, r.length);\n        }\n        byte[][] lr \u003d { l, r };\n        return lr;\n    }\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "User",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/User_4Test.java",
    "test_prompt": "// User_4Test.java\npackage com.browsersoft.aacs;\n\nimport java.io.Serializable;\nimport java.security.MessageDigest;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport javax.naming.ldap.LdapContext;\nimport org.apache.xerces.impl.dv.util.Base64;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link User}.\n* It contains ten unit test cases for the {@link User#checkDigest(String, String)} method.\n*/\nclass User_4Test {",
    "method_signature": "checkDigest(String, String)",
    "suffix": "4"
  },
  {
    "numberTests": "ten",
    "original_code": "// Login.java\n/*\n *   CVS $Id: Login.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\n\n/**\n * This class manages authentication and user\n * attribute retrieval when a user tries to log in.\n */\npublic class Login {\n\n    //private static String[] names \u003d null;\n    //private static String[] mail \u003d null;\n    private String username \u003d \"\";\n\n    private static String organization \u003d \"OPENHRE\";\n\n    private static String country \u003d \"US\";\n\n    private String password \u003d \"\";\n\n    private String userid \u003d \"\";\n\n    private String ipAddr \u003d \"\";\n\n    // private static String userdb \u003d \"users\";\n    //AACS.properties\n    private static String configFile \u003d \"AACS\";\n\n    private static String authType \u003d \"simple\";\n\n    private static String xacmlConfig \u003d \"\";\n\n    private static String securityLog \u003d \"\";\n\n    private static String securityLogFilePath \u003d \"\";\n\n    // Date format used by OpenHRE\n    private final static String appDateFormat \u003d \"MM/dd/yyyy\";\n\n    // LDAP GeneralizedTime Format\n    private final static String ldapGTFormat \u003d \"yyyyMMddHHmmssZ\";\n\n    private static Properties props;\n\n    private static UserMgr userMgr;\n\n    private static PDPadapter pdpadapter;\n\n    private User user;\n\n    private LdapService lservice;\n\n    private static Logger cat \u003d Logger.getLogger(Login.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public Login() {\n    }\n\n    /**\n     * Construct a Login with a UserId\n     */\n    public Login(String userId) {\n        this();\n        this.setUserId(userId);\n    }\n\n    /**\n     * Construct a Login with a UserId and IP Address\n     */\n    public Login(String userId, String ipAddr) {\n        this(userId);\n        this.setIpAddr(ipAddr);\n    }\n\n    /**\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     * Load and get the Properties from the Config File\n     * @param theConfigFile the properties file\n     */\n    public static Properties getProps(String theConfigFile) {\n        setConfigFile(theConfigFile);\n        return getProps();\n    }\n\n    /**\n     * Load and get the Properties from the preset Config File\n     */\n    public static Properties getProps() {\n        init();\n        return props;\n    }\n\n    /**\n     * Initialize and load all the users.\n     */\n    public static String getSecurityLogFilePath() {\n        return securityLogFilePath;\n    }\n\n    public static void init() {\n        if (props !\u003d null)\n            return;\n        props \u003d new Properties();\n        cat.info(\"Loading Properties from \" + configFile);\n        loadProperties(props, configFile);\n        // set the default organization and country\n        organization \u003d props.getProperty(\"organization\", \"OPENHRE\");\n        country \u003d props.getProperty(\"country\", \"US\");\n        authType \u003d props.getProperty(\"AuthType\", \"simple\");\n        xacmlConfig \u003d props.getProperty(\"XACMLConfig\", \"\");\n        cat.info(\"organization is \" + organization);\n        cat.info(\"country is \" + country);\n        cat.info(\"AuthType is \" + authType);\n        cat.info(\"XACMLConfig is \" + xacmlConfig);\n        securityLog \u003d props.getProperty(\"SecurityLog\", \"\");\n        // create security log file if it doesn\u0027t exist\n        try {\n            File file \u003d new File(securityLog);\n            securityLogFilePath \u003d file.getAbsolutePath();\n            cat.info(\"Preparing Security Log file \" + securityLogFilePath);\n            // Create file if it does not exist\n            file.createNewFile();\n            // Get the XACML PDPadapter\n            pdpadapter \u003d new PDPadapter(xacmlConfig);\n        } catch (Exception e) {\n            cat.fatal(\"Exception initializing Login manager\", e);\n            e.printStackTrace();\n        }\n        if (userMgr \u003d\u003d null) {\n            if (authType.equals(\"simple\")) {\n                userMgr \u003d new SimpleUserMgr(configFile);\n            } else if (authType.equals(\"krb5\")) {\n                userMgr \u003d new KrbUserMgr();\n            }\n        }\n    }\n\n    public static void loadProperties(Properties props, String configFile) {\n        try {\n            props.load(Login.class.getResourceAsStream(configFile + \".properties\"));\n        } catch (Exception e) {\n            System.out.println(\"Could not read \" + configFile + \".properties\");\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * set the username  and get the user corresponding to the resulting dn\n     * @param username\n     */\n    public void setUsername(String username) {\n        //\t\tSystem.out.println(\"setting username: \" +username);\n        //        user \u003d null;\n        this.username \u003d username.trim();\n        //user \u003d userMgr.getUser(username, organization);\n        user.setUserName(username);\n        cat.debug(\"setUserName: \" + username);\n    }\n\n    /**\n     * Get filepath of security log.\n     * ASSUMPTION: init() was called (i.e. securityLog was initialized)\n     * @return absolute filepath\n     */\n    /**\n     * get the current username  from user if defined\n     */\n    public String getUsername() {\n        if (user !\u003d null)\n            return user.getUserName();\n        else\n            return username;\n    }\n\n    /**\n     * set ipAddr for login\n     * @param ipAddr\n     */\n    public void setIpAddr(String ipAddr) {\n        this.ipAddr \u003d ipAddr;\n        if (user !\u003d null)\n            user.setIpAddr(ipAddr);\n    }\n\n    /**\n     * get ipAddress of user if defined\n     * return String\n     */\n    public String getIpAddr() {\n        if (user !\u003d null)\n            return user.getIpAddr();\n        else\n            return ipAddr;\n    }\n\n    /**\n     * set the password\n     * @param password\n     */\n    public void setPassword(String password) {\n        this.password \u003d password;\n    }\n\n    /**\n     *  set the email address\n     * @param email address\n     */\n    /*    public void setEmail(String email) {\n//\t\tSystem.out.println(\"setting email: \"+email);\n        this.email \u003d email;\n        if (user !\u003d null) user.setUserId(email);\n    }\n*/\n    /**\n     * set the active user from the userId\n     * @param userId\n     */\n    public void setUserId(String usrId) {\n        userid \u003d usrId;\n        cat.debug(\"setUserId: \" + userid);\n    }\n\n    /**\n     * get the current User\n     */\n    public User getUser() {\n        return user;\n    }\n\n    /**\n     * get the current User ID\n     */\n    public String getUserId() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current email address\n     */\n    public String getEmail() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current LdapService\n     */\n    public LdapService getLdapService() {\n        if (lservice \u003d\u003d null)\n            return (lservice \u003d new LdapService(user.getLdapContext()));\n        else\n            return lservice;\n    }\n\n    /**\n     * get the User from one of two ways. Return the current user if it is already defined.\n     * First see if there is a defined email address (userId) and get the user directly\n     * If not, then check the organization table and the the associated table of username\n     * using the username and organization (country is defaulted to \"US\").\n     */\n    /*    public User getUser() {\n        //   try {\n        // makeDN();\n        if (user !\u003d null) return user;\n        if (userid !\u003d null || userid !\u003d \"\")\n            user \u003d userMgr.getUser(userid);\n        else\n            user \u003d userMgr.getUser(username, organization, userid);\n        cat.debug(\"getUser: \"+user);\n        return user;\n\n    }\n*/\n    /**\n     * return the role of the current user.\n     * @return String containing the Role of the current user\n     *     /\n     *    public String getRole() {\n     *        if (user !\u003d null)\n     *            return user.getRole();\n     *        else\n     *            return null;\n     *    }\n     *\n     *    /**\n     * get the Distinguished Name of the user\n     * @return String containing the distinguished name\n     *     /\n     *    public String getDN() {\n     *        if (user !\u003d null)\n     *            return user.getDN();\n     *        else\n     *            return null;\n     *    }\n     */\n    /**\n     * Authorize a User without checking the password.\n     * Note that this should only be called for Users\n     * that are already Authenticated.\n     * @return user\n     */\n    public User authorize() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        user \u003d userMgr.getUser(this.userid);\n        user.setIpAddr(this.ipAddr);\n        // compare password validity start date with current date\n        Date today \u003d new Date();\n        Date pwvd \u003d null;\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\"))) {\n            pwvd \u003d convertDateFromUTC(user.getPassvalidstart());\n            if (!dateCompare(pwvd, today)) {\n                log(user, \"Not allowed to login currently.\");\n                user \u003d null;\n                throw new LoginException(\"Not allowed to login currently.\");\n            }\n        }\n        // check if user needs to change password before proceeding\n        user.setPasschange(false);\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (user.getPassrenewal() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"-1\"))) {\n            Calendar c1 \u003d Calendar.getInstance();\n            c1.setTime(pwvd);\n            c1.add(Calendar.DATE, Integer.parseInt(user.getPassrenewal()));\n            if (dateCompare(c1.getTime(), today)) {\n                user.setPasschange(true);\n            }\n        }\n        // Performing IP based filtering and active groups determination\n        // based on current location.\n        // Make sure that AuthType\u003dkrb5 and IPfiltering\u003dyes in the properties file.\n        if ((user.getAllowedips() !\u003d null) \u0026\u0026 (props.getProperty(\"AuthType\", \"krb5\").equals(\"krb5\")) \u0026\u0026 (props.getProperty(\"IPfiltering\", \"yes\").equals(\"yes\"))) {\n            int currentip \u003d getIpInteger(user.getIpAddr());\n            // IP based filtering\n            cat.info(\"Performing IP filtering for \" + getUserId());\n            boolean ipcheck_result \u003d ipRangeCheck(user.getAllowedips(), currentip);\n            if (ipcheck_result \u003d\u003d false) {\n                log(user, \"Not authorized from the current IP address.\");\n                throw new LoginException(\"Not authorized from the current IP address.\");\n            }\n            // Active groups determination\n            cat.info(\"Determining active groups for \" + getUserId());\n            boolean faccheck_result;\n            // get all groups from LDAPservice\n            Set usergrps \u003d user.getGroups();\n            if (usergrps !\u003d null \u0026\u0026 usergrps.size() \u003e 0) {\n                // Setup the interface to the LDAP server\n                getLdapService();\n                //session.setAttribute(\"ldapservice\", lservice);\n                Iterator grpit \u003d usergrps.iterator();\n                while (grpit.hasNext()) {\n                    // Fetch each group\u0027s details from LDAP\n                    Group grp \u003d (Group) lservice.getGroup(grpit.next().toString());\n                    faccheck_result \u003d ipRangeCheck(grp.getAllowedips(), currentip);\n                    if (faccheck_result \u003d\u003d true) {\n                        log(user, \"Active group: \" + grp.getCn());\n                        user.addActivegroup(grp.getCn());\n                    }\n                }\n                if (user.getActivegroups() \u003d\u003d null || user.getActivegroups().size() \u003d\u003d 0) {\n                    log(user, \" Accessing from remote location.\");\n                    user.addActivegroup(\"remote\");\n                }\n            }\n        }\n        // end IP based filtering and Active groups determination\n        return user;\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate(String userid, String password, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.password \u003d password;\n        this.ipAddr \u003d ipaddr;\n        return authenticate();\n    }\n\n    /**\n     * Authorize a pre-Authenticated User\n     * @return user\n     */\n    public User authorize(String userid, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.ipAddr \u003d ipaddr;\n        return authorize();\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        if (!userMgr.checkSecret(userid, password, authType)) {\n            cat.warn(\"Invalid Password! User: \" + username + \" ,userid: \" + userid);\n            throw new LoginException(\"Password invalid\");\n        }\n        user \u003d userMgr.getUser();\n        user.setIpAddr(this.ipAddr);\n        authorize();\n        return user;\n    }\n\n    /**\n     * check permissions for the current user\n     */\n    public boolean accessDecision(User usr, String resource, String action) {\n        if (\"simple\".equals(authType)) {\n            cat.debug(\"accessDecision() always true for simple authType\");\n            return true;\n        }\n        if (cat.isDebugEnabled()) {\n            cat.debug(\"User for accessDecision() is \" + usr);\n            cat.debug(\"resource is \" + resource);\n            cat.debug(\"action is \" + action);\n            cat.debug(\"XACMLConfig is \" + xacmlConfig);\n        }\n        if (usr \u003d\u003d null)\n            return false;\n        boolean ac_result \u003d false;\n        try {\n            // create XACML request\n            RequestCtx request \u003d new RequestCtx(RequestBuilder.setupSubjects(usr.getUserId(), usr.getRoles(), usr.getActivegroups() \u003d\u003d null ? usr.getGroups() : usr.getActivegroups()), RequestBuilder.setupResource(resource), RequestBuilder.setupAction(action), new HashSet());\n            // encode the Request and print it to standard out\n            request.encode(System.out, new Indenter());\n            if (pdpadapter.makeDecision(request) \u003d\u003d 0)\n                ac_result \u003d true;\n            else\n                ac_result \u003d false;\n            cat.debug(\"Access Decision: \" + ac_result);\n        } catch (Exception e) {\n            cat.error(e);\n            e.printStackTrace();\n        }\n        return ac_result;\n    }\n\n    public void log(User user, String info) {\n        FileAppender appender \u003d null;\n        try {\n            appender \u003d new FileAppender(new SimpleLayout(), securityLog, true);\n        } catch (Exception e) {\n            cat.error(e);\n        }\n        cat.addAppender(appender);\n        Level oldlevel \u003d cat.getLevel();\n        cat.setLevel((Level) Level.INFO);\n        Date now \u003d new Date();\n        if (user \u003d\u003d null) {\n            cat.info(now + \" - \" + username + \" - \" + userid + \" - \" + ipAddr + \" -- \" + info);\n        } else {\n            // new log format (for better parsing in Cocoon)\n            cat.info(now + \" - \" + user.getUserName() + \" - \" + user.getUserId() + \" - \" + user.getIpAddr() + \" -- \" + info);\n        }\n        cat.setLevel(oldlevel);\n        cat.removeAppender(appender);\n    }\n\n    /**\n     * logout the current user\n     */\n    public void logOut() {\n        userMgr.logOut();\n        user \u003d null;\n        password \u003d null;\n        username \u003d null;\n    }\n\n    private Date convertDateFromUTC(String specdatetime) {\n        // Extract from LDAP GeneralizedTime format and Convert date\n        // and time from UTC time to local time\n        TimeZone localtime \u003d TimeZone.getDefault();\n        SimpleDateFormat df1 \u003d new SimpleDateFormat(appDateFormat);\n        df1.setTimeZone(localtime);\n        SimpleDateFormat df2 \u003d new SimpleDateFormat(ldapGTFormat);\n        Date specdate \u003d null;\n        try {\n            specdate \u003d df2.parse(specdatetime);\n        } catch (ParseException pe) {\n            pe.printStackTrace();\n        }\n        return specdate;\n    }\n\n    private boolean dateCompare(Date date1, Date date2) {\n        Calendar c1 \u003d Calendar.getInstance();\n        Calendar c2 \u003d Calendar.getInstance();\n        c1.setTime(date1);\n        c2.setTime(date2);\n        if (c1.before(c2))\n            return true;\n        else\n            return false;\n    }\n\n    private int getIpInteger(String ip) {\n        StringTokenizer st \u003d new StringTokenizer(ip, \".\");\n        int bitposition \u003d 24;\n        int ipnumber \u003d 0;\n        while (st.hasMoreTokens()) {\n            String curtoken \u003d st.nextToken();\n            if (ipnumber \u003d\u003d 0)\n                ipnumber \u003d (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            else\n                ipnumber \u003d ipnumber | (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            bitposition -\u003d 8;\n        }\n        return ipnumber;\n    }\n\n    private boolean ipRangeCheck(Set allowedips, int currentip) {\n        // Check if the current IP address falls between the given range of allowed IP addresses\n        boolean ipmatch \u003d false;\n        if (allowedips \u003d\u003d null) {\n            cat.debug(\"No IP address range specified.\");\n            return false;\n        }\n        Set allowed_ips \u003d new HashSet();\n        allowed_ips \u003d (HashSet) allowedips;\n        Iterator ipit \u003d allowed_ips.iterator();\n        while (ipit.hasNext()) {\n            int finalip \u003d 0;\n            // subnet mask bits\n            int n \u003d 0;\n            // get the IP address and the subnet mask bits (if any)\n            StringTokenizer st \u003d new StringTokenizer(ipit.next().toString(), \"/\");\n            if (st.hasMoreTokens()) {\n                finalip \u003d getIpInteger(st.nextToken());\n                if (st.hasMoreTokens())\n                    n \u003d Integer.parseInt(st.nextToken());\n            }\n            // Every IP address allowed for the user\n            if (finalip \u003d\u003d 0) {\n                cat.info(\"All IP addresses allowed.\");\n                ipmatch \u003d true;\n            }\n            if (n !\u003d 0) {\n                // compute an n bit subnet mask, all 1s except for last n bits.\n                int subnet \u003d ~((1 \u003c\u003c n) - 1);\n                int t1 \u003d finalip \u0026 subnet;\n                int t2 \u003d currentip \u0026 subnet;\n                if (t1 \u003d\u003d t2)\n                    ipmatch \u003d true;\n            } else {\n                if (finalip \u003d\u003d currentip)\n                    ipmatch \u003d true;\n            }\n        }\n        return ipmatch;\n    }\n\n    /**\n     * Change the User\u0027s password\n     * (this should be moved to KrbUserMgr)\n     */\n    public void changePassword(String newpass) throws Exception {\n        // read the configuration properties\n        if (cat.isDebugEnabled())\n            cat.debug(\"using props \" + props);\n        String krbrealm \u003d props.getProperty(\"krbrealm\", \"YOUR-KERBEROS-REALM\");\n        String editkrb \u003d props.getProperty(\"editkrb\", \"no\");\n        String kadminLocal \u003d props.getProperty(\"kadmin.local\", \"kadmin.local\");\n        int exitVal \u003d 0;\n        String userid \u003d user.getUserId();\n        // strip only the unique username from the userid\n        int ind \u003d userid.indexOf(\"@\");\n        if (ind \u003e 0)\n            userid \u003d userid.substring(0, ind);\n        cat.debug(\"editkrb: \" + editkrb);\n        if (editkrb.toLowerCase().equals(\"yes\")) {\n            // Execute the UNIX command to reset the principal\u0027s password in the Kerberos\n            // database.\n            // Assumption: The web server and the kerberos server are running on the same UNIX\n            // based machine.Otherwise please modify the following according to your settings.\n            String krbprinc \u003d userid + \"@\" + krbrealm;\n            cat.info(\"Reseting principal \\\"\" + krbprinc + \"\\\"\u0027s password in \" + \"the Kerberos database\");\n            Runtime rt \u003d Runtime.getRuntime();\n            // Create a String array consisting of the command and its arguments\n            String[] cmd \u003d { kadminLocal, \"-p \" + userid, \"-q \\\"\\\"cpw -pw \" + newpass + \" \" + krbprinc + \"\\\"\\\"\" };\n            cat.debug(\"exec\u0027ing Runtime command: \" + cmd[0] + \u0027 \u0027 + cmd[1] + \u0027 \u0027 + cmd[2]);\n            Process ps \u003d rt.exec(cmd);\n            // For printing error messages\n            StreamHandler errorHandler \u003d new StreamHandler(ps.getErrorStream(), \"ERROR\");\n            // For printing output\n            StreamHandler outputHandler \u003d new StreamHandler(ps.getInputStream(), \"OUTPUT\");\n            // Start printing\n            errorHandler.start();\n            outputHandler.start();\n            // Print exit value\n            exitVal \u003d ps.waitFor();\n            cat.debug(\"Kerberos update status: \" + exitVal);\n        }\n        if (exitVal \u003d\u003d 0) {\n            getLdapService();\n            Person person \u003d lservice.getPerson(userid);\n            person.setPasschange(\"no\");\n            // Put current date as password valid start date\n            Date today \u003d new Date();\n            SimpleDateFormat sdf \u003d new SimpleDateFormat(ldapGTFormat);\n            person.setPassvalidstart(sdf.format(today));\n            if (lservice.updatePerson(person, person.getDn()) \u003d\u003d true) {\n            } else\n                throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n        } else\n            throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n    }\n    /*  /** obtain list of valid users\n     * @return String[] list of known users\n     /\n    public static String[] getNames() {\n        if (names \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            names \u003d userMgr.getUserNames();\n        }\n\n        return names;\n    }\n\n    /**\n     * return known email addresses\n     * @return String[] list of known emails\n     /\n    public static String[] getMail() {\n        if (mail \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            mail \u003d userMgr.getUserIds();\n        }\n        /*\n        {\n            if (id \u003d\u003d null) init();\n            ArrayList v \u003d null;\n            try {\n                JDBMEnumeration e \u003d id.keys();\n                v \u003d new ArrayList();\n                while (e.hasMoreElements()) {\n                    v.add(e.nextElement());\n                }\n            } catch (IOException e1) {\n                cat.error(\"getMail: \" + e1);\n                return new String[0];\n            }\n            mail \u003d new String[v.size()];\n            cat.debug(\"getMail: \"+mail.length+ \" elements\");\n            v.toArray(mail);\n        }  /\n        return mail;\n    }\n\n\n    /**\n     *  set the SimpleUserMgr containing the Users.\n     * @param theUserMgr to be used\n     /\n    public static void setUserMgr(UserMgr theUserMgr) {\n        userMgr \u003d theUserMgr;\n    }\n\n    /**\n     * get the SimpleUserMgr that contains the Users\n     * @return SimpleUserMgr\n     /\n    public static SimpleUserMgr getUserMgr() {\n        return userMgr;\n    }\n\n    /**\n     * get all the users in memory\n     * @return String\n     /\n    public String toString() {\n        return userMgr.export();\n        /*\n        StringBuffer buff \u003d new StringBuffer();\n        try {\n            JDBMEnumeration c \u003d id.values();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n        }\n        return buff.toString();\n        /\n    }\n\n    /**\n     * test program\n     /\n    public static void main(String[] argv) {\n        Login login \u003d new Login();\n      //  SimpleUserMgr.setConfigFile(argv[0]);\n        // SimpleUserMgr usrMgr \u003d new SimpleUserMgr(argv[0]);\n        // usrMgr.init();\n        login.setConfigFile(argv[0]);\n        login.init();\n        login.getUserMgr().addUser(\"cn\u003dJim Smith, o\u003dLANL, c\u003dUS\", \"Jim Smith\", \"Smith\", \"smith@foo.com\", \"submitter\", \"junk\");\n        login.getUserMgr().addUser(\"dn: cn\u003dDave Barry, o\u003dUNM, c\u003dUS\\ncn: Dave Barry\\nemail: barry@goofoff.com\\nsn: Barry\\nuserPassword: stuff\\nrole: staff\");\n\n        login.setUsername(\"Dave Barry\");\n        login.setOrg(\"UNM\");\n        login.setUsername(\"Dave Barry\");\n        cat.debug(login.getUser());\n        login.getUserMgr().delUser(\"smith@foo.com\");\n        String[] mail \u003d Login.getMail();\n        cat.debug(\"Mail: \"+mail[0]);\n        cat.debug(login.getUserMgr().getMailbyOrg(\"LANL\"));\n        String[] names \u003d Login.getNames();\n        cat.debug(\"names: \"+names[0]);\n        System.out.println(login.toString());\n\n    } */\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "Login",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/Login_0Test.java",
    "test_prompt": "// Login_0Test.java\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link Login}.\n* It contains ten unit test cases for the {@link Login#getProps(String)} method.\n*/\nclass Login_0Test {",
    "method_signature": "getProps(String)",
    "suffix": "0"
  },
  {
    "numberTests": "ten",
    "original_code": "// Login.java\n/*\n *   CVS $Id: Login.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\n\n/**\n * This class manages authentication and user\n * attribute retrieval when a user tries to log in.\n */\npublic class Login {\n\n    //private static String[] names \u003d null;\n    //private static String[] mail \u003d null;\n    private String username \u003d \"\";\n\n    private static String organization \u003d \"OPENHRE\";\n\n    private static String country \u003d \"US\";\n\n    private String password \u003d \"\";\n\n    private String userid \u003d \"\";\n\n    private String ipAddr \u003d \"\";\n\n    // private static String userdb \u003d \"users\";\n    //AACS.properties\n    private static String configFile \u003d \"AACS\";\n\n    private static String authType \u003d \"simple\";\n\n    private static String xacmlConfig \u003d \"\";\n\n    private static String securityLog \u003d \"\";\n\n    private static String securityLogFilePath \u003d \"\";\n\n    // Date format used by OpenHRE\n    private final static String appDateFormat \u003d \"MM/dd/yyyy\";\n\n    // LDAP GeneralizedTime Format\n    private final static String ldapGTFormat \u003d \"yyyyMMddHHmmssZ\";\n\n    private static Properties props;\n\n    private static UserMgr userMgr;\n\n    private static PDPadapter pdpadapter;\n\n    private User user;\n\n    private LdapService lservice;\n\n    private static Logger cat \u003d Logger.getLogger(Login.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public Login() {\n    }\n\n    /**\n     * Construct a Login with a UserId\n     */\n    public Login(String userId) {\n        this();\n        this.setUserId(userId);\n    }\n\n    /**\n     * Construct a Login with a UserId and IP Address\n     */\n    public Login(String userId, String ipAddr) {\n        this(userId);\n        this.setIpAddr(ipAddr);\n    }\n\n    /**\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     * Load and get the Properties from the Config File\n     * @param theConfigFile the properties file\n     */\n    public static Properties getProps(String theConfigFile) {\n        setConfigFile(theConfigFile);\n        return getProps();\n    }\n\n    /**\n     * Load and get the Properties from the preset Config File\n     */\n    public static Properties getProps() {\n        init();\n        return props;\n    }\n\n    /**\n     * Initialize and load all the users.\n     */\n    public static String getSecurityLogFilePath() {\n        return securityLogFilePath;\n    }\n\n    public static void init() {\n        if (props !\u003d null)\n            return;\n        props \u003d new Properties();\n        cat.info(\"Loading Properties from \" + configFile);\n        loadProperties(props, configFile);\n        // set the default organization and country\n        organization \u003d props.getProperty(\"organization\", \"OPENHRE\");\n        country \u003d props.getProperty(\"country\", \"US\");\n        authType \u003d props.getProperty(\"AuthType\", \"simple\");\n        xacmlConfig \u003d props.getProperty(\"XACMLConfig\", \"\");\n        cat.info(\"organization is \" + organization);\n        cat.info(\"country is \" + country);\n        cat.info(\"AuthType is \" + authType);\n        cat.info(\"XACMLConfig is \" + xacmlConfig);\n        securityLog \u003d props.getProperty(\"SecurityLog\", \"\");\n        // create security log file if it doesn\u0027t exist\n        try {\n            File file \u003d new File(securityLog);\n            securityLogFilePath \u003d file.getAbsolutePath();\n            cat.info(\"Preparing Security Log file \" + securityLogFilePath);\n            // Create file if it does not exist\n            file.createNewFile();\n            // Get the XACML PDPadapter\n            pdpadapter \u003d new PDPadapter(xacmlConfig);\n        } catch (Exception e) {\n            cat.fatal(\"Exception initializing Login manager\", e);\n            e.printStackTrace();\n        }\n        if (userMgr \u003d\u003d null) {\n            if (authType.equals(\"simple\")) {\n                userMgr \u003d new SimpleUserMgr(configFile);\n            } else if (authType.equals(\"krb5\")) {\n                userMgr \u003d new KrbUserMgr();\n            }\n        }\n    }\n\n    public static void loadProperties(Properties props, String configFile) {\n        try {\n            props.load(Login.class.getResourceAsStream(configFile + \".properties\"));\n        } catch (Exception e) {\n            System.out.println(\"Could not read \" + configFile + \".properties\");\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * set the username  and get the user corresponding to the resulting dn\n     * @param username\n     */\n    public void setUsername(String username) {\n        //\t\tSystem.out.println(\"setting username: \" +username);\n        //        user \u003d null;\n        this.username \u003d username.trim();\n        //user \u003d userMgr.getUser(username, organization);\n        user.setUserName(username);\n        cat.debug(\"setUserName: \" + username);\n    }\n\n    /**\n     * Get filepath of security log.\n     * ASSUMPTION: init() was called (i.e. securityLog was initialized)\n     * @return absolute filepath\n     */\n    /**\n     * get the current username  from user if defined\n     */\n    public String getUsername() {\n        if (user !\u003d null)\n            return user.getUserName();\n        else\n            return username;\n    }\n\n    /**\n     * set ipAddr for login\n     * @param ipAddr\n     */\n    public void setIpAddr(String ipAddr) {\n        this.ipAddr \u003d ipAddr;\n        if (user !\u003d null)\n            user.setIpAddr(ipAddr);\n    }\n\n    /**\n     * get ipAddress of user if defined\n     * return String\n     */\n    public String getIpAddr() {\n        if (user !\u003d null)\n            return user.getIpAddr();\n        else\n            return ipAddr;\n    }\n\n    /**\n     * set the password\n     * @param password\n     */\n    public void setPassword(String password) {\n        this.password \u003d password;\n    }\n\n    /**\n     *  set the email address\n     * @param email address\n     */\n    /*    public void setEmail(String email) {\n//\t\tSystem.out.println(\"setting email: \"+email);\n        this.email \u003d email;\n        if (user !\u003d null) user.setUserId(email);\n    }\n*/\n    /**\n     * set the active user from the userId\n     * @param userId\n     */\n    public void setUserId(String usrId) {\n        userid \u003d usrId;\n        cat.debug(\"setUserId: \" + userid);\n    }\n\n    /**\n     * get the current User\n     */\n    public User getUser() {\n        return user;\n    }\n\n    /**\n     * get the current User ID\n     */\n    public String getUserId() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current email address\n     */\n    public String getEmail() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current LdapService\n     */\n    public LdapService getLdapService() {\n        if (lservice \u003d\u003d null)\n            return (lservice \u003d new LdapService(user.getLdapContext()));\n        else\n            return lservice;\n    }\n\n    /**\n     * get the User from one of two ways. Return the current user if it is already defined.\n     * First see if there is a defined email address (userId) and get the user directly\n     * If not, then check the organization table and the the associated table of username\n     * using the username and organization (country is defaulted to \"US\").\n     */\n    /*    public User getUser() {\n        //   try {\n        // makeDN();\n        if (user !\u003d null) return user;\n        if (userid !\u003d null || userid !\u003d \"\")\n            user \u003d userMgr.getUser(userid);\n        else\n            user \u003d userMgr.getUser(username, organization, userid);\n        cat.debug(\"getUser: \"+user);\n        return user;\n\n    }\n*/\n    /**\n     * return the role of the current user.\n     * @return String containing the Role of the current user\n     *     /\n     *    public String getRole() {\n     *        if (user !\u003d null)\n     *            return user.getRole();\n     *        else\n     *            return null;\n     *    }\n     *\n     *    /**\n     * get the Distinguished Name of the user\n     * @return String containing the distinguished name\n     *     /\n     *    public String getDN() {\n     *        if (user !\u003d null)\n     *            return user.getDN();\n     *        else\n     *            return null;\n     *    }\n     */\n    /**\n     * Authorize a User without checking the password.\n     * Note that this should only be called for Users\n     * that are already Authenticated.\n     * @return user\n     */\n    public User authorize() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        user \u003d userMgr.getUser(this.userid);\n        user.setIpAddr(this.ipAddr);\n        // compare password validity start date with current date\n        Date today \u003d new Date();\n        Date pwvd \u003d null;\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\"))) {\n            pwvd \u003d convertDateFromUTC(user.getPassvalidstart());\n            if (!dateCompare(pwvd, today)) {\n                log(user, \"Not allowed to login currently.\");\n                user \u003d null;\n                throw new LoginException(\"Not allowed to login currently.\");\n            }\n        }\n        // check if user needs to change password before proceeding\n        user.setPasschange(false);\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (user.getPassrenewal() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"-1\"))) {\n            Calendar c1 \u003d Calendar.getInstance();\n            c1.setTime(pwvd);\n            c1.add(Calendar.DATE, Integer.parseInt(user.getPassrenewal()));\n            if (dateCompare(c1.getTime(), today)) {\n                user.setPasschange(true);\n            }\n        }\n        // Performing IP based filtering and active groups determination\n        // based on current location.\n        // Make sure that AuthType\u003dkrb5 and IPfiltering\u003dyes in the properties file.\n        if ((user.getAllowedips() !\u003d null) \u0026\u0026 (props.getProperty(\"AuthType\", \"krb5\").equals(\"krb5\")) \u0026\u0026 (props.getProperty(\"IPfiltering\", \"yes\").equals(\"yes\"))) {\n            int currentip \u003d getIpInteger(user.getIpAddr());\n            // IP based filtering\n            cat.info(\"Performing IP filtering for \" + getUserId());\n            boolean ipcheck_result \u003d ipRangeCheck(user.getAllowedips(), currentip);\n            if (ipcheck_result \u003d\u003d false) {\n                log(user, \"Not authorized from the current IP address.\");\n                throw new LoginException(\"Not authorized from the current IP address.\");\n            }\n            // Active groups determination\n            cat.info(\"Determining active groups for \" + getUserId());\n            boolean faccheck_result;\n            // get all groups from LDAPservice\n            Set usergrps \u003d user.getGroups();\n            if (usergrps !\u003d null \u0026\u0026 usergrps.size() \u003e 0) {\n                // Setup the interface to the LDAP server\n                getLdapService();\n                //session.setAttribute(\"ldapservice\", lservice);\n                Iterator grpit \u003d usergrps.iterator();\n                while (grpit.hasNext()) {\n                    // Fetch each group\u0027s details from LDAP\n                    Group grp \u003d (Group) lservice.getGroup(grpit.next().toString());\n                    faccheck_result \u003d ipRangeCheck(grp.getAllowedips(), currentip);\n                    if (faccheck_result \u003d\u003d true) {\n                        log(user, \"Active group: \" + grp.getCn());\n                        user.addActivegroup(grp.getCn());\n                    }\n                }\n                if (user.getActivegroups() \u003d\u003d null || user.getActivegroups().size() \u003d\u003d 0) {\n                    log(user, \" Accessing from remote location.\");\n                    user.addActivegroup(\"remote\");\n                }\n            }\n        }\n        // end IP based filtering and Active groups determination\n        return user;\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate(String userid, String password, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.password \u003d password;\n        this.ipAddr \u003d ipaddr;\n        return authenticate();\n    }\n\n    /**\n     * Authorize a pre-Authenticated User\n     * @return user\n     */\n    public User authorize(String userid, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.ipAddr \u003d ipaddr;\n        return authorize();\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        if (!userMgr.checkSecret(userid, password, authType)) {\n            cat.warn(\"Invalid Password! User: \" + username + \" ,userid: \" + userid);\n            throw new LoginException(\"Password invalid\");\n        }\n        user \u003d userMgr.getUser();\n        user.setIpAddr(this.ipAddr);\n        authorize();\n        return user;\n    }\n\n    /**\n     * check permissions for the current user\n     */\n    public boolean accessDecision(User usr, String resource, String action) {\n        if (\"simple\".equals(authType)) {\n            cat.debug(\"accessDecision() always true for simple authType\");\n            return true;\n        }\n        if (cat.isDebugEnabled()) {\n            cat.debug(\"User for accessDecision() is \" + usr);\n            cat.debug(\"resource is \" + resource);\n            cat.debug(\"action is \" + action);\n            cat.debug(\"XACMLConfig is \" + xacmlConfig);\n        }\n        if (usr \u003d\u003d null)\n            return false;\n        boolean ac_result \u003d false;\n        try {\n            // create XACML request\n            RequestCtx request \u003d new RequestCtx(RequestBuilder.setupSubjects(usr.getUserId(), usr.getRoles(), usr.getActivegroups() \u003d\u003d null ? usr.getGroups() : usr.getActivegroups()), RequestBuilder.setupResource(resource), RequestBuilder.setupAction(action), new HashSet());\n            // encode the Request and print it to standard out\n            request.encode(System.out, new Indenter());\n            if (pdpadapter.makeDecision(request) \u003d\u003d 0)\n                ac_result \u003d true;\n            else\n                ac_result \u003d false;\n            cat.debug(\"Access Decision: \" + ac_result);\n        } catch (Exception e) {\n            cat.error(e);\n            e.printStackTrace();\n        }\n        return ac_result;\n    }\n\n    public void log(User user, String info) {\n        FileAppender appender \u003d null;\n        try {\n            appender \u003d new FileAppender(new SimpleLayout(), securityLog, true);\n        } catch (Exception e) {\n            cat.error(e);\n        }\n        cat.addAppender(appender);\n        Level oldlevel \u003d cat.getLevel();\n        cat.setLevel((Level) Level.INFO);\n        Date now \u003d new Date();\n        if (user \u003d\u003d null) {\n            cat.info(now + \" - \" + username + \" - \" + userid + \" - \" + ipAddr + \" -- \" + info);\n        } else {\n            // new log format (for better parsing in Cocoon)\n            cat.info(now + \" - \" + user.getUserName() + \" - \" + user.getUserId() + \" - \" + user.getIpAddr() + \" -- \" + info);\n        }\n        cat.setLevel(oldlevel);\n        cat.removeAppender(appender);\n    }\n\n    /**\n     * logout the current user\n     */\n    public void logOut() {\n        userMgr.logOut();\n        user \u003d null;\n        password \u003d null;\n        username \u003d null;\n    }\n\n    private Date convertDateFromUTC(String specdatetime) {\n        // Extract from LDAP GeneralizedTime format and Convert date\n        // and time from UTC time to local time\n        TimeZone localtime \u003d TimeZone.getDefault();\n        SimpleDateFormat df1 \u003d new SimpleDateFormat(appDateFormat);\n        df1.setTimeZone(localtime);\n        SimpleDateFormat df2 \u003d new SimpleDateFormat(ldapGTFormat);\n        Date specdate \u003d null;\n        try {\n            specdate \u003d df2.parse(specdatetime);\n        } catch (ParseException pe) {\n            pe.printStackTrace();\n        }\n        return specdate;\n    }\n\n    private boolean dateCompare(Date date1, Date date2) {\n        Calendar c1 \u003d Calendar.getInstance();\n        Calendar c2 \u003d Calendar.getInstance();\n        c1.setTime(date1);\n        c2.setTime(date2);\n        if (c1.before(c2))\n            return true;\n        else\n            return false;\n    }\n\n    private int getIpInteger(String ip) {\n        StringTokenizer st \u003d new StringTokenizer(ip, \".\");\n        int bitposition \u003d 24;\n        int ipnumber \u003d 0;\n        while (st.hasMoreTokens()) {\n            String curtoken \u003d st.nextToken();\n            if (ipnumber \u003d\u003d 0)\n                ipnumber \u003d (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            else\n                ipnumber \u003d ipnumber | (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            bitposition -\u003d 8;\n        }\n        return ipnumber;\n    }\n\n    private boolean ipRangeCheck(Set allowedips, int currentip) {\n        // Check if the current IP address falls between the given range of allowed IP addresses\n        boolean ipmatch \u003d false;\n        if (allowedips \u003d\u003d null) {\n            cat.debug(\"No IP address range specified.\");\n            return false;\n        }\n        Set allowed_ips \u003d new HashSet();\n        allowed_ips \u003d (HashSet) allowedips;\n        Iterator ipit \u003d allowed_ips.iterator();\n        while (ipit.hasNext()) {\n            int finalip \u003d 0;\n            // subnet mask bits\n            int n \u003d 0;\n            // get the IP address and the subnet mask bits (if any)\n            StringTokenizer st \u003d new StringTokenizer(ipit.next().toString(), \"/\");\n            if (st.hasMoreTokens()) {\n                finalip \u003d getIpInteger(st.nextToken());\n                if (st.hasMoreTokens())\n                    n \u003d Integer.parseInt(st.nextToken());\n            }\n            // Every IP address allowed for the user\n            if (finalip \u003d\u003d 0) {\n                cat.info(\"All IP addresses allowed.\");\n                ipmatch \u003d true;\n            }\n            if (n !\u003d 0) {\n                // compute an n bit subnet mask, all 1s except for last n bits.\n                int subnet \u003d ~((1 \u003c\u003c n) - 1);\n                int t1 \u003d finalip \u0026 subnet;\n                int t2 \u003d currentip \u0026 subnet;\n                if (t1 \u003d\u003d t2)\n                    ipmatch \u003d true;\n            } else {\n                if (finalip \u003d\u003d currentip)\n                    ipmatch \u003d true;\n            }\n        }\n        return ipmatch;\n    }\n\n    /**\n     * Change the User\u0027s password\n     * (this should be moved to KrbUserMgr)\n     */\n    public void changePassword(String newpass) throws Exception {\n        // read the configuration properties\n        if (cat.isDebugEnabled())\n            cat.debug(\"using props \" + props);\n        String krbrealm \u003d props.getProperty(\"krbrealm\", \"YOUR-KERBEROS-REALM\");\n        String editkrb \u003d props.getProperty(\"editkrb\", \"no\");\n        String kadminLocal \u003d props.getProperty(\"kadmin.local\", \"kadmin.local\");\n        int exitVal \u003d 0;\n        String userid \u003d user.getUserId();\n        // strip only the unique username from the userid\n        int ind \u003d userid.indexOf(\"@\");\n        if (ind \u003e 0)\n            userid \u003d userid.substring(0, ind);\n        cat.debug(\"editkrb: \" + editkrb);\n        if (editkrb.toLowerCase().equals(\"yes\")) {\n            // Execute the UNIX command to reset the principal\u0027s password in the Kerberos\n            // database.\n            // Assumption: The web server and the kerberos server are running on the same UNIX\n            // based machine.Otherwise please modify the following according to your settings.\n            String krbprinc \u003d userid + \"@\" + krbrealm;\n            cat.info(\"Reseting principal \\\"\" + krbprinc + \"\\\"\u0027s password in \" + \"the Kerberos database\");\n            Runtime rt \u003d Runtime.getRuntime();\n            // Create a String array consisting of the command and its arguments\n            String[] cmd \u003d { kadminLocal, \"-p \" + userid, \"-q \\\"\\\"cpw -pw \" + newpass + \" \" + krbprinc + \"\\\"\\\"\" };\n            cat.debug(\"exec\u0027ing Runtime command: \" + cmd[0] + \u0027 \u0027 + cmd[1] + \u0027 \u0027 + cmd[2]);\n            Process ps \u003d rt.exec(cmd);\n            // For printing error messages\n            StreamHandler errorHandler \u003d new StreamHandler(ps.getErrorStream(), \"ERROR\");\n            // For printing output\n            StreamHandler outputHandler \u003d new StreamHandler(ps.getInputStream(), \"OUTPUT\");\n            // Start printing\n            errorHandler.start();\n            outputHandler.start();\n            // Print exit value\n            exitVal \u003d ps.waitFor();\n            cat.debug(\"Kerberos update status: \" + exitVal);\n        }\n        if (exitVal \u003d\u003d 0) {\n            getLdapService();\n            Person person \u003d lservice.getPerson(userid);\n            person.setPasschange(\"no\");\n            // Put current date as password valid start date\n            Date today \u003d new Date();\n            SimpleDateFormat sdf \u003d new SimpleDateFormat(ldapGTFormat);\n            person.setPassvalidstart(sdf.format(today));\n            if (lservice.updatePerson(person, person.getDn()) \u003d\u003d true) {\n            } else\n                throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n        } else\n            throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n    }\n    /*  /** obtain list of valid users\n     * @return String[] list of known users\n     /\n    public static String[] getNames() {\n        if (names \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            names \u003d userMgr.getUserNames();\n        }\n\n        return names;\n    }\n\n    /**\n     * return known email addresses\n     * @return String[] list of known emails\n     /\n    public static String[] getMail() {\n        if (mail \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            mail \u003d userMgr.getUserIds();\n        }\n        /*\n        {\n            if (id \u003d\u003d null) init();\n            ArrayList v \u003d null;\n            try {\n                JDBMEnumeration e \u003d id.keys();\n                v \u003d new ArrayList();\n                while (e.hasMoreElements()) {\n                    v.add(e.nextElement());\n                }\n            } catch (IOException e1) {\n                cat.error(\"getMail: \" + e1);\n                return new String[0];\n            }\n            mail \u003d new String[v.size()];\n            cat.debug(\"getMail: \"+mail.length+ \" elements\");\n            v.toArray(mail);\n        }  /\n        return mail;\n    }\n\n\n    /**\n     *  set the SimpleUserMgr containing the Users.\n     * @param theUserMgr to be used\n     /\n    public static void setUserMgr(UserMgr theUserMgr) {\n        userMgr \u003d theUserMgr;\n    }\n\n    /**\n     * get the SimpleUserMgr that contains the Users\n     * @return SimpleUserMgr\n     /\n    public static SimpleUserMgr getUserMgr() {\n        return userMgr;\n    }\n\n    /**\n     * get all the users in memory\n     * @return String\n     /\n    public String toString() {\n        return userMgr.export();\n        /*\n        StringBuffer buff \u003d new StringBuffer();\n        try {\n            JDBMEnumeration c \u003d id.values();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n        }\n        return buff.toString();\n        /\n    }\n\n    /**\n     * test program\n     /\n    public static void main(String[] argv) {\n        Login login \u003d new Login();\n      //  SimpleUserMgr.setConfigFile(argv[0]);\n        // SimpleUserMgr usrMgr \u003d new SimpleUserMgr(argv[0]);\n        // usrMgr.init();\n        login.setConfigFile(argv[0]);\n        login.init();\n        login.getUserMgr().addUser(\"cn\u003dJim Smith, o\u003dLANL, c\u003dUS\", \"Jim Smith\", \"Smith\", \"smith@foo.com\", \"submitter\", \"junk\");\n        login.getUserMgr().addUser(\"dn: cn\u003dDave Barry, o\u003dUNM, c\u003dUS\\ncn: Dave Barry\\nemail: barry@goofoff.com\\nsn: Barry\\nuserPassword: stuff\\nrole: staff\");\n\n        login.setUsername(\"Dave Barry\");\n        login.setOrg(\"UNM\");\n        login.setUsername(\"Dave Barry\");\n        cat.debug(login.getUser());\n        login.getUserMgr().delUser(\"smith@foo.com\");\n        String[] mail \u003d Login.getMail();\n        cat.debug(\"Mail: \"+mail[0]);\n        cat.debug(login.getUserMgr().getMailbyOrg(\"LANL\"));\n        String[] names \u003d Login.getNames();\n        cat.debug(\"names: \"+names[0]);\n        System.out.println(login.toString());\n\n    } */\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "Login",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/Login_1Test.java",
    "test_prompt": "// Login_1Test.java\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link Login}.\n* It contains ten unit test cases for the {@link Login#getProps()} method.\n*/\nclass Login_1Test {",
    "method_signature": "getProps()",
    "suffix": "1"
  },
  {
    "numberTests": "ten",
    "original_code": "// Login.java\n/*\n *   CVS $Id: Login.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\n\n/**\n * This class manages authentication and user\n * attribute retrieval when a user tries to log in.\n */\npublic class Login {\n\n    //private static String[] names \u003d null;\n    //private static String[] mail \u003d null;\n    private String username \u003d \"\";\n\n    private static String organization \u003d \"OPENHRE\";\n\n    private static String country \u003d \"US\";\n\n    private String password \u003d \"\";\n\n    private String userid \u003d \"\";\n\n    private String ipAddr \u003d \"\";\n\n    // private static String userdb \u003d \"users\";\n    //AACS.properties\n    private static String configFile \u003d \"AACS\";\n\n    private static String authType \u003d \"simple\";\n\n    private static String xacmlConfig \u003d \"\";\n\n    private static String securityLog \u003d \"\";\n\n    private static String securityLogFilePath \u003d \"\";\n\n    // Date format used by OpenHRE\n    private final static String appDateFormat \u003d \"MM/dd/yyyy\";\n\n    // LDAP GeneralizedTime Format\n    private final static String ldapGTFormat \u003d \"yyyyMMddHHmmssZ\";\n\n    private static Properties props;\n\n    private static UserMgr userMgr;\n\n    private static PDPadapter pdpadapter;\n\n    private User user;\n\n    private LdapService lservice;\n\n    private static Logger cat \u003d Logger.getLogger(Login.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public Login() {\n    }\n\n    /**\n     * Construct a Login with a UserId\n     */\n    public Login(String userId) {\n        this();\n        this.setUserId(userId);\n    }\n\n    /**\n     * Construct a Login with a UserId and IP Address\n     */\n    public Login(String userId, String ipAddr) {\n        this(userId);\n        this.setIpAddr(ipAddr);\n    }\n\n    /**\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     * Load and get the Properties from the Config File\n     * @param theConfigFile the properties file\n     */\n    public static Properties getProps(String theConfigFile) {\n        setConfigFile(theConfigFile);\n        return getProps();\n    }\n\n    /**\n     * Load and get the Properties from the preset Config File\n     */\n    public static Properties getProps() {\n        init();\n        return props;\n    }\n\n    /**\n     * Initialize and load all the users.\n     */\n    public static String getSecurityLogFilePath() {\n        return securityLogFilePath;\n    }\n\n    public static void init() {\n        if (props !\u003d null)\n            return;\n        props \u003d new Properties();\n        cat.info(\"Loading Properties from \" + configFile);\n        loadProperties(props, configFile);\n        // set the default organization and country\n        organization \u003d props.getProperty(\"organization\", \"OPENHRE\");\n        country \u003d props.getProperty(\"country\", \"US\");\n        authType \u003d props.getProperty(\"AuthType\", \"simple\");\n        xacmlConfig \u003d props.getProperty(\"XACMLConfig\", \"\");\n        cat.info(\"organization is \" + organization);\n        cat.info(\"country is \" + country);\n        cat.info(\"AuthType is \" + authType);\n        cat.info(\"XACMLConfig is \" + xacmlConfig);\n        securityLog \u003d props.getProperty(\"SecurityLog\", \"\");\n        // create security log file if it doesn\u0027t exist\n        try {\n            File file \u003d new File(securityLog);\n            securityLogFilePath \u003d file.getAbsolutePath();\n            cat.info(\"Preparing Security Log file \" + securityLogFilePath);\n            // Create file if it does not exist\n            file.createNewFile();\n            // Get the XACML PDPadapter\n            pdpadapter \u003d new PDPadapter(xacmlConfig);\n        } catch (Exception e) {\n            cat.fatal(\"Exception initializing Login manager\", e);\n            e.printStackTrace();\n        }\n        if (userMgr \u003d\u003d null) {\n            if (authType.equals(\"simple\")) {\n                userMgr \u003d new SimpleUserMgr(configFile);\n            } else if (authType.equals(\"krb5\")) {\n                userMgr \u003d new KrbUserMgr();\n            }\n        }\n    }\n\n    public static void loadProperties(Properties props, String configFile) {\n        try {\n            props.load(Login.class.getResourceAsStream(configFile + \".properties\"));\n        } catch (Exception e) {\n            System.out.println(\"Could not read \" + configFile + \".properties\");\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * set the username  and get the user corresponding to the resulting dn\n     * @param username\n     */\n    public void setUsername(String username) {\n        //\t\tSystem.out.println(\"setting username: \" +username);\n        //        user \u003d null;\n        this.username \u003d username.trim();\n        //user \u003d userMgr.getUser(username, organization);\n        user.setUserName(username);\n        cat.debug(\"setUserName: \" + username);\n    }\n\n    /**\n     * Get filepath of security log.\n     * ASSUMPTION: init() was called (i.e. securityLog was initialized)\n     * @return absolute filepath\n     */\n    /**\n     * get the current username  from user if defined\n     */\n    public String getUsername() {\n        if (user !\u003d null)\n            return user.getUserName();\n        else\n            return username;\n    }\n\n    /**\n     * set ipAddr for login\n     * @param ipAddr\n     */\n    public void setIpAddr(String ipAddr) {\n        this.ipAddr \u003d ipAddr;\n        if (user !\u003d null)\n            user.setIpAddr(ipAddr);\n    }\n\n    /**\n     * get ipAddress of user if defined\n     * return String\n     */\n    public String getIpAddr() {\n        if (user !\u003d null)\n            return user.getIpAddr();\n        else\n            return ipAddr;\n    }\n\n    /**\n     * set the password\n     * @param password\n     */\n    public void setPassword(String password) {\n        this.password \u003d password;\n    }\n\n    /**\n     *  set the email address\n     * @param email address\n     */\n    /*    public void setEmail(String email) {\n//\t\tSystem.out.println(\"setting email: \"+email);\n        this.email \u003d email;\n        if (user !\u003d null) user.setUserId(email);\n    }\n*/\n    /**\n     * set the active user from the userId\n     * @param userId\n     */\n    public void setUserId(String usrId) {\n        userid \u003d usrId;\n        cat.debug(\"setUserId: \" + userid);\n    }\n\n    /**\n     * get the current User\n     */\n    public User getUser() {\n        return user;\n    }\n\n    /**\n     * get the current User ID\n     */\n    public String getUserId() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current email address\n     */\n    public String getEmail() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current LdapService\n     */\n    public LdapService getLdapService() {\n        if (lservice \u003d\u003d null)\n            return (lservice \u003d new LdapService(user.getLdapContext()));\n        else\n            return lservice;\n    }\n\n    /**\n     * get the User from one of two ways. Return the current user if it is already defined.\n     * First see if there is a defined email address (userId) and get the user directly\n     * If not, then check the organization table and the the associated table of username\n     * using the username and organization (country is defaulted to \"US\").\n     */\n    /*    public User getUser() {\n        //   try {\n        // makeDN();\n        if (user !\u003d null) return user;\n        if (userid !\u003d null || userid !\u003d \"\")\n            user \u003d userMgr.getUser(userid);\n        else\n            user \u003d userMgr.getUser(username, organization, userid);\n        cat.debug(\"getUser: \"+user);\n        return user;\n\n    }\n*/\n    /**\n     * return the role of the current user.\n     * @return String containing the Role of the current user\n     *     /\n     *    public String getRole() {\n     *        if (user !\u003d null)\n     *            return user.getRole();\n     *        else\n     *            return null;\n     *    }\n     *\n     *    /**\n     * get the Distinguished Name of the user\n     * @return String containing the distinguished name\n     *     /\n     *    public String getDN() {\n     *        if (user !\u003d null)\n     *            return user.getDN();\n     *        else\n     *            return null;\n     *    }\n     */\n    /**\n     * Authorize a User without checking the password.\n     * Note that this should only be called for Users\n     * that are already Authenticated.\n     * @return user\n     */\n    public User authorize() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        user \u003d userMgr.getUser(this.userid);\n        user.setIpAddr(this.ipAddr);\n        // compare password validity start date with current date\n        Date today \u003d new Date();\n        Date pwvd \u003d null;\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\"))) {\n            pwvd \u003d convertDateFromUTC(user.getPassvalidstart());\n            if (!dateCompare(pwvd, today)) {\n                log(user, \"Not allowed to login currently.\");\n                user \u003d null;\n                throw new LoginException(\"Not allowed to login currently.\");\n            }\n        }\n        // check if user needs to change password before proceeding\n        user.setPasschange(false);\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (user.getPassrenewal() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"-1\"))) {\n            Calendar c1 \u003d Calendar.getInstance();\n            c1.setTime(pwvd);\n            c1.add(Calendar.DATE, Integer.parseInt(user.getPassrenewal()));\n            if (dateCompare(c1.getTime(), today)) {\n                user.setPasschange(true);\n            }\n        }\n        // Performing IP based filtering and active groups determination\n        // based on current location.\n        // Make sure that AuthType\u003dkrb5 and IPfiltering\u003dyes in the properties file.\n        if ((user.getAllowedips() !\u003d null) \u0026\u0026 (props.getProperty(\"AuthType\", \"krb5\").equals(\"krb5\")) \u0026\u0026 (props.getProperty(\"IPfiltering\", \"yes\").equals(\"yes\"))) {\n            int currentip \u003d getIpInteger(user.getIpAddr());\n            // IP based filtering\n            cat.info(\"Performing IP filtering for \" + getUserId());\n            boolean ipcheck_result \u003d ipRangeCheck(user.getAllowedips(), currentip);\n            if (ipcheck_result \u003d\u003d false) {\n                log(user, \"Not authorized from the current IP address.\");\n                throw new LoginException(\"Not authorized from the current IP address.\");\n            }\n            // Active groups determination\n            cat.info(\"Determining active groups for \" + getUserId());\n            boolean faccheck_result;\n            // get all groups from LDAPservice\n            Set usergrps \u003d user.getGroups();\n            if (usergrps !\u003d null \u0026\u0026 usergrps.size() \u003e 0) {\n                // Setup the interface to the LDAP server\n                getLdapService();\n                //session.setAttribute(\"ldapservice\", lservice);\n                Iterator grpit \u003d usergrps.iterator();\n                while (grpit.hasNext()) {\n                    // Fetch each group\u0027s details from LDAP\n                    Group grp \u003d (Group) lservice.getGroup(grpit.next().toString());\n                    faccheck_result \u003d ipRangeCheck(grp.getAllowedips(), currentip);\n                    if (faccheck_result \u003d\u003d true) {\n                        log(user, \"Active group: \" + grp.getCn());\n                        user.addActivegroup(grp.getCn());\n                    }\n                }\n                if (user.getActivegroups() \u003d\u003d null || user.getActivegroups().size() \u003d\u003d 0) {\n                    log(user, \" Accessing from remote location.\");\n                    user.addActivegroup(\"remote\");\n                }\n            }\n        }\n        // end IP based filtering and Active groups determination\n        return user;\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate(String userid, String password, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.password \u003d password;\n        this.ipAddr \u003d ipaddr;\n        return authenticate();\n    }\n\n    /**\n     * Authorize a pre-Authenticated User\n     * @return user\n     */\n    public User authorize(String userid, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.ipAddr \u003d ipaddr;\n        return authorize();\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        if (!userMgr.checkSecret(userid, password, authType)) {\n            cat.warn(\"Invalid Password! User: \" + username + \" ,userid: \" + userid);\n            throw new LoginException(\"Password invalid\");\n        }\n        user \u003d userMgr.getUser();\n        user.setIpAddr(this.ipAddr);\n        authorize();\n        return user;\n    }\n\n    /**\n     * check permissions for the current user\n     */\n    public boolean accessDecision(User usr, String resource, String action) {\n        if (\"simple\".equals(authType)) {\n            cat.debug(\"accessDecision() always true for simple authType\");\n            return true;\n        }\n        if (cat.isDebugEnabled()) {\n            cat.debug(\"User for accessDecision() is \" + usr);\n            cat.debug(\"resource is \" + resource);\n            cat.debug(\"action is \" + action);\n            cat.debug(\"XACMLConfig is \" + xacmlConfig);\n        }\n        if (usr \u003d\u003d null)\n            return false;\n        boolean ac_result \u003d false;\n        try {\n            // create XACML request\n            RequestCtx request \u003d new RequestCtx(RequestBuilder.setupSubjects(usr.getUserId(), usr.getRoles(), usr.getActivegroups() \u003d\u003d null ? usr.getGroups() : usr.getActivegroups()), RequestBuilder.setupResource(resource), RequestBuilder.setupAction(action), new HashSet());\n            // encode the Request and print it to standard out\n            request.encode(System.out, new Indenter());\n            if (pdpadapter.makeDecision(request) \u003d\u003d 0)\n                ac_result \u003d true;\n            else\n                ac_result \u003d false;\n            cat.debug(\"Access Decision: \" + ac_result);\n        } catch (Exception e) {\n            cat.error(e);\n            e.printStackTrace();\n        }\n        return ac_result;\n    }\n\n    public void log(User user, String info) {\n        FileAppender appender \u003d null;\n        try {\n            appender \u003d new FileAppender(new SimpleLayout(), securityLog, true);\n        } catch (Exception e) {\n            cat.error(e);\n        }\n        cat.addAppender(appender);\n        Level oldlevel \u003d cat.getLevel();\n        cat.setLevel((Level) Level.INFO);\n        Date now \u003d new Date();\n        if (user \u003d\u003d null) {\n            cat.info(now + \" - \" + username + \" - \" + userid + \" - \" + ipAddr + \" -- \" + info);\n        } else {\n            // new log format (for better parsing in Cocoon)\n            cat.info(now + \" - \" + user.getUserName() + \" - \" + user.getUserId() + \" - \" + user.getIpAddr() + \" -- \" + info);\n        }\n        cat.setLevel(oldlevel);\n        cat.removeAppender(appender);\n    }\n\n    /**\n     * logout the current user\n     */\n    public void logOut() {\n        userMgr.logOut();\n        user \u003d null;\n        password \u003d null;\n        username \u003d null;\n    }\n\n    private Date convertDateFromUTC(String specdatetime) {\n        // Extract from LDAP GeneralizedTime format and Convert date\n        // and time from UTC time to local time\n        TimeZone localtime \u003d TimeZone.getDefault();\n        SimpleDateFormat df1 \u003d new SimpleDateFormat(appDateFormat);\n        df1.setTimeZone(localtime);\n        SimpleDateFormat df2 \u003d new SimpleDateFormat(ldapGTFormat);\n        Date specdate \u003d null;\n        try {\n            specdate \u003d df2.parse(specdatetime);\n        } catch (ParseException pe) {\n            pe.printStackTrace();\n        }\n        return specdate;\n    }\n\n    private boolean dateCompare(Date date1, Date date2) {\n        Calendar c1 \u003d Calendar.getInstance();\n        Calendar c2 \u003d Calendar.getInstance();\n        c1.setTime(date1);\n        c2.setTime(date2);\n        if (c1.before(c2))\n            return true;\n        else\n            return false;\n    }\n\n    private int getIpInteger(String ip) {\n        StringTokenizer st \u003d new StringTokenizer(ip, \".\");\n        int bitposition \u003d 24;\n        int ipnumber \u003d 0;\n        while (st.hasMoreTokens()) {\n            String curtoken \u003d st.nextToken();\n            if (ipnumber \u003d\u003d 0)\n                ipnumber \u003d (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            else\n                ipnumber \u003d ipnumber | (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            bitposition -\u003d 8;\n        }\n        return ipnumber;\n    }\n\n    private boolean ipRangeCheck(Set allowedips, int currentip) {\n        // Check if the current IP address falls between the given range of allowed IP addresses\n        boolean ipmatch \u003d false;\n        if (allowedips \u003d\u003d null) {\n            cat.debug(\"No IP address range specified.\");\n            return false;\n        }\n        Set allowed_ips \u003d new HashSet();\n        allowed_ips \u003d (HashSet) allowedips;\n        Iterator ipit \u003d allowed_ips.iterator();\n        while (ipit.hasNext()) {\n            int finalip \u003d 0;\n            // subnet mask bits\n            int n \u003d 0;\n            // get the IP address and the subnet mask bits (if any)\n            StringTokenizer st \u003d new StringTokenizer(ipit.next().toString(), \"/\");\n            if (st.hasMoreTokens()) {\n                finalip \u003d getIpInteger(st.nextToken());\n                if (st.hasMoreTokens())\n                    n \u003d Integer.parseInt(st.nextToken());\n            }\n            // Every IP address allowed for the user\n            if (finalip \u003d\u003d 0) {\n                cat.info(\"All IP addresses allowed.\");\n                ipmatch \u003d true;\n            }\n            if (n !\u003d 0) {\n                // compute an n bit subnet mask, all 1s except for last n bits.\n                int subnet \u003d ~((1 \u003c\u003c n) - 1);\n                int t1 \u003d finalip \u0026 subnet;\n                int t2 \u003d currentip \u0026 subnet;\n                if (t1 \u003d\u003d t2)\n                    ipmatch \u003d true;\n            } else {\n                if (finalip \u003d\u003d currentip)\n                    ipmatch \u003d true;\n            }\n        }\n        return ipmatch;\n    }\n\n    /**\n     * Change the User\u0027s password\n     * (this should be moved to KrbUserMgr)\n     */\n    public void changePassword(String newpass) throws Exception {\n        // read the configuration properties\n        if (cat.isDebugEnabled())\n            cat.debug(\"using props \" + props);\n        String krbrealm \u003d props.getProperty(\"krbrealm\", \"YOUR-KERBEROS-REALM\");\n        String editkrb \u003d props.getProperty(\"editkrb\", \"no\");\n        String kadminLocal \u003d props.getProperty(\"kadmin.local\", \"kadmin.local\");\n        int exitVal \u003d 0;\n        String userid \u003d user.getUserId();\n        // strip only the unique username from the userid\n        int ind \u003d userid.indexOf(\"@\");\n        if (ind \u003e 0)\n            userid \u003d userid.substring(0, ind);\n        cat.debug(\"editkrb: \" + editkrb);\n        if (editkrb.toLowerCase().equals(\"yes\")) {\n            // Execute the UNIX command to reset the principal\u0027s password in the Kerberos\n            // database.\n            // Assumption: The web server and the kerberos server are running on the same UNIX\n            // based machine.Otherwise please modify the following according to your settings.\n            String krbprinc \u003d userid + \"@\" + krbrealm;\n            cat.info(\"Reseting principal \\\"\" + krbprinc + \"\\\"\u0027s password in \" + \"the Kerberos database\");\n            Runtime rt \u003d Runtime.getRuntime();\n            // Create a String array consisting of the command and its arguments\n            String[] cmd \u003d { kadminLocal, \"-p \" + userid, \"-q \\\"\\\"cpw -pw \" + newpass + \" \" + krbprinc + \"\\\"\\\"\" };\n            cat.debug(\"exec\u0027ing Runtime command: \" + cmd[0] + \u0027 \u0027 + cmd[1] + \u0027 \u0027 + cmd[2]);\n            Process ps \u003d rt.exec(cmd);\n            // For printing error messages\n            StreamHandler errorHandler \u003d new StreamHandler(ps.getErrorStream(), \"ERROR\");\n            // For printing output\n            StreamHandler outputHandler \u003d new StreamHandler(ps.getInputStream(), \"OUTPUT\");\n            // Start printing\n            errorHandler.start();\n            outputHandler.start();\n            // Print exit value\n            exitVal \u003d ps.waitFor();\n            cat.debug(\"Kerberos update status: \" + exitVal);\n        }\n        if (exitVal \u003d\u003d 0) {\n            getLdapService();\n            Person person \u003d lservice.getPerson(userid);\n            person.setPasschange(\"no\");\n            // Put current date as password valid start date\n            Date today \u003d new Date();\n            SimpleDateFormat sdf \u003d new SimpleDateFormat(ldapGTFormat);\n            person.setPassvalidstart(sdf.format(today));\n            if (lservice.updatePerson(person, person.getDn()) \u003d\u003d true) {\n            } else\n                throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n        } else\n            throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n    }\n    /*  /** obtain list of valid users\n     * @return String[] list of known users\n     /\n    public static String[] getNames() {\n        if (names \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            names \u003d userMgr.getUserNames();\n        }\n\n        return names;\n    }\n\n    /**\n     * return known email addresses\n     * @return String[] list of known emails\n     /\n    public static String[] getMail() {\n        if (mail \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            mail \u003d userMgr.getUserIds();\n        }\n        /*\n        {\n            if (id \u003d\u003d null) init();\n            ArrayList v \u003d null;\n            try {\n                JDBMEnumeration e \u003d id.keys();\n                v \u003d new ArrayList();\n                while (e.hasMoreElements()) {\n                    v.add(e.nextElement());\n                }\n            } catch (IOException e1) {\n                cat.error(\"getMail: \" + e1);\n                return new String[0];\n            }\n            mail \u003d new String[v.size()];\n            cat.debug(\"getMail: \"+mail.length+ \" elements\");\n            v.toArray(mail);\n        }  /\n        return mail;\n    }\n\n\n    /**\n     *  set the SimpleUserMgr containing the Users.\n     * @param theUserMgr to be used\n     /\n    public static void setUserMgr(UserMgr theUserMgr) {\n        userMgr \u003d theUserMgr;\n    }\n\n    /**\n     * get the SimpleUserMgr that contains the Users\n     * @return SimpleUserMgr\n     /\n    public static SimpleUserMgr getUserMgr() {\n        return userMgr;\n    }\n\n    /**\n     * get all the users in memory\n     * @return String\n     /\n    public String toString() {\n        return userMgr.export();\n        /*\n        StringBuffer buff \u003d new StringBuffer();\n        try {\n            JDBMEnumeration c \u003d id.values();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n        }\n        return buff.toString();\n        /\n    }\n\n    /**\n     * test program\n     /\n    public static void main(String[] argv) {\n        Login login \u003d new Login();\n      //  SimpleUserMgr.setConfigFile(argv[0]);\n        // SimpleUserMgr usrMgr \u003d new SimpleUserMgr(argv[0]);\n        // usrMgr.init();\n        login.setConfigFile(argv[0]);\n        login.init();\n        login.getUserMgr().addUser(\"cn\u003dJim Smith, o\u003dLANL, c\u003dUS\", \"Jim Smith\", \"Smith\", \"smith@foo.com\", \"submitter\", \"junk\");\n        login.getUserMgr().addUser(\"dn: cn\u003dDave Barry, o\u003dUNM, c\u003dUS\\ncn: Dave Barry\\nemail: barry@goofoff.com\\nsn: Barry\\nuserPassword: stuff\\nrole: staff\");\n\n        login.setUsername(\"Dave Barry\");\n        login.setOrg(\"UNM\");\n        login.setUsername(\"Dave Barry\");\n        cat.debug(login.getUser());\n        login.getUserMgr().delUser(\"smith@foo.com\");\n        String[] mail \u003d Login.getMail();\n        cat.debug(\"Mail: \"+mail[0]);\n        cat.debug(login.getUserMgr().getMailbyOrg(\"LANL\"));\n        String[] names \u003d Login.getNames();\n        cat.debug(\"names: \"+names[0]);\n        System.out.println(login.toString());\n\n    } */\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "Login",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/Login_2Test.java",
    "test_prompt": "// Login_2Test.java\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link Login}.\n* It contains ten unit test cases for the {@link Login#getSecurityLogFilePath()} method.\n*/\nclass Login_2Test {",
    "method_signature": "getSecurityLogFilePath()",
    "suffix": "2"
  },
  {
    "numberTests": "ten",
    "original_code": "// Login.java\n/*\n *   CVS $Id: Login.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\n\n/**\n * This class manages authentication and user\n * attribute retrieval when a user tries to log in.\n */\npublic class Login {\n\n    //private static String[] names \u003d null;\n    //private static String[] mail \u003d null;\n    private String username \u003d \"\";\n\n    private static String organization \u003d \"OPENHRE\";\n\n    private static String country \u003d \"US\";\n\n    private String password \u003d \"\";\n\n    private String userid \u003d \"\";\n\n    private String ipAddr \u003d \"\";\n\n    // private static String userdb \u003d \"users\";\n    //AACS.properties\n    private static String configFile \u003d \"AACS\";\n\n    private static String authType \u003d \"simple\";\n\n    private static String xacmlConfig \u003d \"\";\n\n    private static String securityLog \u003d \"\";\n\n    private static String securityLogFilePath \u003d \"\";\n\n    // Date format used by OpenHRE\n    private final static String appDateFormat \u003d \"MM/dd/yyyy\";\n\n    // LDAP GeneralizedTime Format\n    private final static String ldapGTFormat \u003d \"yyyyMMddHHmmssZ\";\n\n    private static Properties props;\n\n    private static UserMgr userMgr;\n\n    private static PDPadapter pdpadapter;\n\n    private User user;\n\n    private LdapService lservice;\n\n    private static Logger cat \u003d Logger.getLogger(Login.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public Login() {\n    }\n\n    /**\n     * Construct a Login with a UserId\n     */\n    public Login(String userId) {\n        this();\n        this.setUserId(userId);\n    }\n\n    /**\n     * Construct a Login with a UserId and IP Address\n     */\n    public Login(String userId, String ipAddr) {\n        this(userId);\n        this.setIpAddr(ipAddr);\n    }\n\n    /**\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     * Load and get the Properties from the Config File\n     * @param theConfigFile the properties file\n     */\n    public static Properties getProps(String theConfigFile) {\n        setConfigFile(theConfigFile);\n        return getProps();\n    }\n\n    /**\n     * Load and get the Properties from the preset Config File\n     */\n    public static Properties getProps() {\n        init();\n        return props;\n    }\n\n    /**\n     * Initialize and load all the users.\n     */\n    public static String getSecurityLogFilePath() {\n        return securityLogFilePath;\n    }\n\n    public static void init() {\n        if (props !\u003d null)\n            return;\n        props \u003d new Properties();\n        cat.info(\"Loading Properties from \" + configFile);\n        loadProperties(props, configFile);\n        // set the default organization and country\n        organization \u003d props.getProperty(\"organization\", \"OPENHRE\");\n        country \u003d props.getProperty(\"country\", \"US\");\n        authType \u003d props.getProperty(\"AuthType\", \"simple\");\n        xacmlConfig \u003d props.getProperty(\"XACMLConfig\", \"\");\n        cat.info(\"organization is \" + organization);\n        cat.info(\"country is \" + country);\n        cat.info(\"AuthType is \" + authType);\n        cat.info(\"XACMLConfig is \" + xacmlConfig);\n        securityLog \u003d props.getProperty(\"SecurityLog\", \"\");\n        // create security log file if it doesn\u0027t exist\n        try {\n            File file \u003d new File(securityLog);\n            securityLogFilePath \u003d file.getAbsolutePath();\n            cat.info(\"Preparing Security Log file \" + securityLogFilePath);\n            // Create file if it does not exist\n            file.createNewFile();\n            // Get the XACML PDPadapter\n            pdpadapter \u003d new PDPadapter(xacmlConfig);\n        } catch (Exception e) {\n            cat.fatal(\"Exception initializing Login manager\", e);\n            e.printStackTrace();\n        }\n        if (userMgr \u003d\u003d null) {\n            if (authType.equals(\"simple\")) {\n                userMgr \u003d new SimpleUserMgr(configFile);\n            } else if (authType.equals(\"krb5\")) {\n                userMgr \u003d new KrbUserMgr();\n            }\n        }\n    }\n\n    public static void loadProperties(Properties props, String configFile) {\n        try {\n            props.load(Login.class.getResourceAsStream(configFile + \".properties\"));\n        } catch (Exception e) {\n            System.out.println(\"Could not read \" + configFile + \".properties\");\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * set the username  and get the user corresponding to the resulting dn\n     * @param username\n     */\n    public void setUsername(String username) {\n        //\t\tSystem.out.println(\"setting username: \" +username);\n        //        user \u003d null;\n        this.username \u003d username.trim();\n        //user \u003d userMgr.getUser(username, organization);\n        user.setUserName(username);\n        cat.debug(\"setUserName: \" + username);\n    }\n\n    /**\n     * Get filepath of security log.\n     * ASSUMPTION: init() was called (i.e. securityLog was initialized)\n     * @return absolute filepath\n     */\n    /**\n     * get the current username  from user if defined\n     */\n    public String getUsername() {\n        if (user !\u003d null)\n            return user.getUserName();\n        else\n            return username;\n    }\n\n    /**\n     * set ipAddr for login\n     * @param ipAddr\n     */\n    public void setIpAddr(String ipAddr) {\n        this.ipAddr \u003d ipAddr;\n        if (user !\u003d null)\n            user.setIpAddr(ipAddr);\n    }\n\n    /**\n     * get ipAddress of user if defined\n     * return String\n     */\n    public String getIpAddr() {\n        if (user !\u003d null)\n            return user.getIpAddr();\n        else\n            return ipAddr;\n    }\n\n    /**\n     * set the password\n     * @param password\n     */\n    public void setPassword(String password) {\n        this.password \u003d password;\n    }\n\n    /**\n     *  set the email address\n     * @param email address\n     */\n    /*    public void setEmail(String email) {\n//\t\tSystem.out.println(\"setting email: \"+email);\n        this.email \u003d email;\n        if (user !\u003d null) user.setUserId(email);\n    }\n*/\n    /**\n     * set the active user from the userId\n     * @param userId\n     */\n    public void setUserId(String usrId) {\n        userid \u003d usrId;\n        cat.debug(\"setUserId: \" + userid);\n    }\n\n    /**\n     * get the current User\n     */\n    public User getUser() {\n        return user;\n    }\n\n    /**\n     * get the current User ID\n     */\n    public String getUserId() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current email address\n     */\n    public String getEmail() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current LdapService\n     */\n    public LdapService getLdapService() {\n        if (lservice \u003d\u003d null)\n            return (lservice \u003d new LdapService(user.getLdapContext()));\n        else\n            return lservice;\n    }\n\n    /**\n     * get the User from one of two ways. Return the current user if it is already defined.\n     * First see if there is a defined email address (userId) and get the user directly\n     * If not, then check the organization table and the the associated table of username\n     * using the username and organization (country is defaulted to \"US\").\n     */\n    /*    public User getUser() {\n        //   try {\n        // makeDN();\n        if (user !\u003d null) return user;\n        if (userid !\u003d null || userid !\u003d \"\")\n            user \u003d userMgr.getUser(userid);\n        else\n            user \u003d userMgr.getUser(username, organization, userid);\n        cat.debug(\"getUser: \"+user);\n        return user;\n\n    }\n*/\n    /**\n     * return the role of the current user.\n     * @return String containing the Role of the current user\n     *     /\n     *    public String getRole() {\n     *        if (user !\u003d null)\n     *            return user.getRole();\n     *        else\n     *            return null;\n     *    }\n     *\n     *    /**\n     * get the Distinguished Name of the user\n     * @return String containing the distinguished name\n     *     /\n     *    public String getDN() {\n     *        if (user !\u003d null)\n     *            return user.getDN();\n     *        else\n     *            return null;\n     *    }\n     */\n    /**\n     * Authorize a User without checking the password.\n     * Note that this should only be called for Users\n     * that are already Authenticated.\n     * @return user\n     */\n    public User authorize() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        user \u003d userMgr.getUser(this.userid);\n        user.setIpAddr(this.ipAddr);\n        // compare password validity start date with current date\n        Date today \u003d new Date();\n        Date pwvd \u003d null;\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\"))) {\n            pwvd \u003d convertDateFromUTC(user.getPassvalidstart());\n            if (!dateCompare(pwvd, today)) {\n                log(user, \"Not allowed to login currently.\");\n                user \u003d null;\n                throw new LoginException(\"Not allowed to login currently.\");\n            }\n        }\n        // check if user needs to change password before proceeding\n        user.setPasschange(false);\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (user.getPassrenewal() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"-1\"))) {\n            Calendar c1 \u003d Calendar.getInstance();\n            c1.setTime(pwvd);\n            c1.add(Calendar.DATE, Integer.parseInt(user.getPassrenewal()));\n            if (dateCompare(c1.getTime(), today)) {\n                user.setPasschange(true);\n            }\n        }\n        // Performing IP based filtering and active groups determination\n        // based on current location.\n        // Make sure that AuthType\u003dkrb5 and IPfiltering\u003dyes in the properties file.\n        if ((user.getAllowedips() !\u003d null) \u0026\u0026 (props.getProperty(\"AuthType\", \"krb5\").equals(\"krb5\")) \u0026\u0026 (props.getProperty(\"IPfiltering\", \"yes\").equals(\"yes\"))) {\n            int currentip \u003d getIpInteger(user.getIpAddr());\n            // IP based filtering\n            cat.info(\"Performing IP filtering for \" + getUserId());\n            boolean ipcheck_result \u003d ipRangeCheck(user.getAllowedips(), currentip);\n            if (ipcheck_result \u003d\u003d false) {\n                log(user, \"Not authorized from the current IP address.\");\n                throw new LoginException(\"Not authorized from the current IP address.\");\n            }\n            // Active groups determination\n            cat.info(\"Determining active groups for \" + getUserId());\n            boolean faccheck_result;\n            // get all groups from LDAPservice\n            Set usergrps \u003d user.getGroups();\n            if (usergrps !\u003d null \u0026\u0026 usergrps.size() \u003e 0) {\n                // Setup the interface to the LDAP server\n                getLdapService();\n                //session.setAttribute(\"ldapservice\", lservice);\n                Iterator grpit \u003d usergrps.iterator();\n                while (grpit.hasNext()) {\n                    // Fetch each group\u0027s details from LDAP\n                    Group grp \u003d (Group) lservice.getGroup(grpit.next().toString());\n                    faccheck_result \u003d ipRangeCheck(grp.getAllowedips(), currentip);\n                    if (faccheck_result \u003d\u003d true) {\n                        log(user, \"Active group: \" + grp.getCn());\n                        user.addActivegroup(grp.getCn());\n                    }\n                }\n                if (user.getActivegroups() \u003d\u003d null || user.getActivegroups().size() \u003d\u003d 0) {\n                    log(user, \" Accessing from remote location.\");\n                    user.addActivegroup(\"remote\");\n                }\n            }\n        }\n        // end IP based filtering and Active groups determination\n        return user;\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate(String userid, String password, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.password \u003d password;\n        this.ipAddr \u003d ipaddr;\n        return authenticate();\n    }\n\n    /**\n     * Authorize a pre-Authenticated User\n     * @return user\n     */\n    public User authorize(String userid, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.ipAddr \u003d ipaddr;\n        return authorize();\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        if (!userMgr.checkSecret(userid, password, authType)) {\n            cat.warn(\"Invalid Password! User: \" + username + \" ,userid: \" + userid);\n            throw new LoginException(\"Password invalid\");\n        }\n        user \u003d userMgr.getUser();\n        user.setIpAddr(this.ipAddr);\n        authorize();\n        return user;\n    }\n\n    /**\n     * check permissions for the current user\n     */\n    public boolean accessDecision(User usr, String resource, String action) {\n        if (\"simple\".equals(authType)) {\n            cat.debug(\"accessDecision() always true for simple authType\");\n            return true;\n        }\n        if (cat.isDebugEnabled()) {\n            cat.debug(\"User for accessDecision() is \" + usr);\n            cat.debug(\"resource is \" + resource);\n            cat.debug(\"action is \" + action);\n            cat.debug(\"XACMLConfig is \" + xacmlConfig);\n        }\n        if (usr \u003d\u003d null)\n            return false;\n        boolean ac_result \u003d false;\n        try {\n            // create XACML request\n            RequestCtx request \u003d new RequestCtx(RequestBuilder.setupSubjects(usr.getUserId(), usr.getRoles(), usr.getActivegroups() \u003d\u003d null ? usr.getGroups() : usr.getActivegroups()), RequestBuilder.setupResource(resource), RequestBuilder.setupAction(action), new HashSet());\n            // encode the Request and print it to standard out\n            request.encode(System.out, new Indenter());\n            if (pdpadapter.makeDecision(request) \u003d\u003d 0)\n                ac_result \u003d true;\n            else\n                ac_result \u003d false;\n            cat.debug(\"Access Decision: \" + ac_result);\n        } catch (Exception e) {\n            cat.error(e);\n            e.printStackTrace();\n        }\n        return ac_result;\n    }\n\n    public void log(User user, String info) {\n        FileAppender appender \u003d null;\n        try {\n            appender \u003d new FileAppender(new SimpleLayout(), securityLog, true);\n        } catch (Exception e) {\n            cat.error(e);\n        }\n        cat.addAppender(appender);\n        Level oldlevel \u003d cat.getLevel();\n        cat.setLevel((Level) Level.INFO);\n        Date now \u003d new Date();\n        if (user \u003d\u003d null) {\n            cat.info(now + \" - \" + username + \" - \" + userid + \" - \" + ipAddr + \" -- \" + info);\n        } else {\n            // new log format (for better parsing in Cocoon)\n            cat.info(now + \" - \" + user.getUserName() + \" - \" + user.getUserId() + \" - \" + user.getIpAddr() + \" -- \" + info);\n        }\n        cat.setLevel(oldlevel);\n        cat.removeAppender(appender);\n    }\n\n    /**\n     * logout the current user\n     */\n    public void logOut() {\n        userMgr.logOut();\n        user \u003d null;\n        password \u003d null;\n        username \u003d null;\n    }\n\n    private Date convertDateFromUTC(String specdatetime) {\n        // Extract from LDAP GeneralizedTime format and Convert date\n        // and time from UTC time to local time\n        TimeZone localtime \u003d TimeZone.getDefault();\n        SimpleDateFormat df1 \u003d new SimpleDateFormat(appDateFormat);\n        df1.setTimeZone(localtime);\n        SimpleDateFormat df2 \u003d new SimpleDateFormat(ldapGTFormat);\n        Date specdate \u003d null;\n        try {\n            specdate \u003d df2.parse(specdatetime);\n        } catch (ParseException pe) {\n            pe.printStackTrace();\n        }\n        return specdate;\n    }\n\n    private boolean dateCompare(Date date1, Date date2) {\n        Calendar c1 \u003d Calendar.getInstance();\n        Calendar c2 \u003d Calendar.getInstance();\n        c1.setTime(date1);\n        c2.setTime(date2);\n        if (c1.before(c2))\n            return true;\n        else\n            return false;\n    }\n\n    private int getIpInteger(String ip) {\n        StringTokenizer st \u003d new StringTokenizer(ip, \".\");\n        int bitposition \u003d 24;\n        int ipnumber \u003d 0;\n        while (st.hasMoreTokens()) {\n            String curtoken \u003d st.nextToken();\n            if (ipnumber \u003d\u003d 0)\n                ipnumber \u003d (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            else\n                ipnumber \u003d ipnumber | (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            bitposition -\u003d 8;\n        }\n        return ipnumber;\n    }\n\n    private boolean ipRangeCheck(Set allowedips, int currentip) {\n        // Check if the current IP address falls between the given range of allowed IP addresses\n        boolean ipmatch \u003d false;\n        if (allowedips \u003d\u003d null) {\n            cat.debug(\"No IP address range specified.\");\n            return false;\n        }\n        Set allowed_ips \u003d new HashSet();\n        allowed_ips \u003d (HashSet) allowedips;\n        Iterator ipit \u003d allowed_ips.iterator();\n        while (ipit.hasNext()) {\n            int finalip \u003d 0;\n            // subnet mask bits\n            int n \u003d 0;\n            // get the IP address and the subnet mask bits (if any)\n            StringTokenizer st \u003d new StringTokenizer(ipit.next().toString(), \"/\");\n            if (st.hasMoreTokens()) {\n                finalip \u003d getIpInteger(st.nextToken());\n                if (st.hasMoreTokens())\n                    n \u003d Integer.parseInt(st.nextToken());\n            }\n            // Every IP address allowed for the user\n            if (finalip \u003d\u003d 0) {\n                cat.info(\"All IP addresses allowed.\");\n                ipmatch \u003d true;\n            }\n            if (n !\u003d 0) {\n                // compute an n bit subnet mask, all 1s except for last n bits.\n                int subnet \u003d ~((1 \u003c\u003c n) - 1);\n                int t1 \u003d finalip \u0026 subnet;\n                int t2 \u003d currentip \u0026 subnet;\n                if (t1 \u003d\u003d t2)\n                    ipmatch \u003d true;\n            } else {\n                if (finalip \u003d\u003d currentip)\n                    ipmatch \u003d true;\n            }\n        }\n        return ipmatch;\n    }\n\n    /**\n     * Change the User\u0027s password\n     * (this should be moved to KrbUserMgr)\n     */\n    public void changePassword(String newpass) throws Exception {\n        // read the configuration properties\n        if (cat.isDebugEnabled())\n            cat.debug(\"using props \" + props);\n        String krbrealm \u003d props.getProperty(\"krbrealm\", \"YOUR-KERBEROS-REALM\");\n        String editkrb \u003d props.getProperty(\"editkrb\", \"no\");\n        String kadminLocal \u003d props.getProperty(\"kadmin.local\", \"kadmin.local\");\n        int exitVal \u003d 0;\n        String userid \u003d user.getUserId();\n        // strip only the unique username from the userid\n        int ind \u003d userid.indexOf(\"@\");\n        if (ind \u003e 0)\n            userid \u003d userid.substring(0, ind);\n        cat.debug(\"editkrb: \" + editkrb);\n        if (editkrb.toLowerCase().equals(\"yes\")) {\n            // Execute the UNIX command to reset the principal\u0027s password in the Kerberos\n            // database.\n            // Assumption: The web server and the kerberos server are running on the same UNIX\n            // based machine.Otherwise please modify the following according to your settings.\n            String krbprinc \u003d userid + \"@\" + krbrealm;\n            cat.info(\"Reseting principal \\\"\" + krbprinc + \"\\\"\u0027s password in \" + \"the Kerberos database\");\n            Runtime rt \u003d Runtime.getRuntime();\n            // Create a String array consisting of the command and its arguments\n            String[] cmd \u003d { kadminLocal, \"-p \" + userid, \"-q \\\"\\\"cpw -pw \" + newpass + \" \" + krbprinc + \"\\\"\\\"\" };\n            cat.debug(\"exec\u0027ing Runtime command: \" + cmd[0] + \u0027 \u0027 + cmd[1] + \u0027 \u0027 + cmd[2]);\n            Process ps \u003d rt.exec(cmd);\n            // For printing error messages\n            StreamHandler errorHandler \u003d new StreamHandler(ps.getErrorStream(), \"ERROR\");\n            // For printing output\n            StreamHandler outputHandler \u003d new StreamHandler(ps.getInputStream(), \"OUTPUT\");\n            // Start printing\n            errorHandler.start();\n            outputHandler.start();\n            // Print exit value\n            exitVal \u003d ps.waitFor();\n            cat.debug(\"Kerberos update status: \" + exitVal);\n        }\n        if (exitVal \u003d\u003d 0) {\n            getLdapService();\n            Person person \u003d lservice.getPerson(userid);\n            person.setPasschange(\"no\");\n            // Put current date as password valid start date\n            Date today \u003d new Date();\n            SimpleDateFormat sdf \u003d new SimpleDateFormat(ldapGTFormat);\n            person.setPassvalidstart(sdf.format(today));\n            if (lservice.updatePerson(person, person.getDn()) \u003d\u003d true) {\n            } else\n                throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n        } else\n            throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n    }\n    /*  /** obtain list of valid users\n     * @return String[] list of known users\n     /\n    public static String[] getNames() {\n        if (names \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            names \u003d userMgr.getUserNames();\n        }\n\n        return names;\n    }\n\n    /**\n     * return known email addresses\n     * @return String[] list of known emails\n     /\n    public static String[] getMail() {\n        if (mail \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            mail \u003d userMgr.getUserIds();\n        }\n        /*\n        {\n            if (id \u003d\u003d null) init();\n            ArrayList v \u003d null;\n            try {\n                JDBMEnumeration e \u003d id.keys();\n                v \u003d new ArrayList();\n                while (e.hasMoreElements()) {\n                    v.add(e.nextElement());\n                }\n            } catch (IOException e1) {\n                cat.error(\"getMail: \" + e1);\n                return new String[0];\n            }\n            mail \u003d new String[v.size()];\n            cat.debug(\"getMail: \"+mail.length+ \" elements\");\n            v.toArray(mail);\n        }  /\n        return mail;\n    }\n\n\n    /**\n     *  set the SimpleUserMgr containing the Users.\n     * @param theUserMgr to be used\n     /\n    public static void setUserMgr(UserMgr theUserMgr) {\n        userMgr \u003d theUserMgr;\n    }\n\n    /**\n     * get the SimpleUserMgr that contains the Users\n     * @return SimpleUserMgr\n     /\n    public static SimpleUserMgr getUserMgr() {\n        return userMgr;\n    }\n\n    /**\n     * get all the users in memory\n     * @return String\n     /\n    public String toString() {\n        return userMgr.export();\n        /*\n        StringBuffer buff \u003d new StringBuffer();\n        try {\n            JDBMEnumeration c \u003d id.values();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n        }\n        return buff.toString();\n        /\n    }\n\n    /**\n     * test program\n     /\n    public static void main(String[] argv) {\n        Login login \u003d new Login();\n      //  SimpleUserMgr.setConfigFile(argv[0]);\n        // SimpleUserMgr usrMgr \u003d new SimpleUserMgr(argv[0]);\n        // usrMgr.init();\n        login.setConfigFile(argv[0]);\n        login.init();\n        login.getUserMgr().addUser(\"cn\u003dJim Smith, o\u003dLANL, c\u003dUS\", \"Jim Smith\", \"Smith\", \"smith@foo.com\", \"submitter\", \"junk\");\n        login.getUserMgr().addUser(\"dn: cn\u003dDave Barry, o\u003dUNM, c\u003dUS\\ncn: Dave Barry\\nemail: barry@goofoff.com\\nsn: Barry\\nuserPassword: stuff\\nrole: staff\");\n\n        login.setUsername(\"Dave Barry\");\n        login.setOrg(\"UNM\");\n        login.setUsername(\"Dave Barry\");\n        cat.debug(login.getUser());\n        login.getUserMgr().delUser(\"smith@foo.com\");\n        String[] mail \u003d Login.getMail();\n        cat.debug(\"Mail: \"+mail[0]);\n        cat.debug(login.getUserMgr().getMailbyOrg(\"LANL\"));\n        String[] names \u003d Login.getNames();\n        cat.debug(\"names: \"+names[0]);\n        System.out.println(login.toString());\n\n    } */\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "Login",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/Login_3Test.java",
    "test_prompt": "// Login_3Test.java\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link Login}.\n* It contains ten unit test cases for the {@link Login#authorize()} method.\n*/\nclass Login_3Test {",
    "method_signature": "authorize()",
    "suffix": "3"
  },
  {
    "numberTests": "ten",
    "original_code": "// Login.java\n/*\n *   CVS $Id: Login.java,v 1.1 2006/11/06 19:51:47 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005, 2006 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\n\n/**\n * This class manages authentication and user\n * attribute retrieval when a user tries to log in.\n */\npublic class Login {\n\n    //private static String[] names \u003d null;\n    //private static String[] mail \u003d null;\n    private String username \u003d \"\";\n\n    private static String organization \u003d \"OPENHRE\";\n\n    private static String country \u003d \"US\";\n\n    private String password \u003d \"\";\n\n    private String userid \u003d \"\";\n\n    private String ipAddr \u003d \"\";\n\n    // private static String userdb \u003d \"users\";\n    //AACS.properties\n    private static String configFile \u003d \"AACS\";\n\n    private static String authType \u003d \"simple\";\n\n    private static String xacmlConfig \u003d \"\";\n\n    private static String securityLog \u003d \"\";\n\n    private static String securityLogFilePath \u003d \"\";\n\n    // Date format used by OpenHRE\n    private final static String appDateFormat \u003d \"MM/dd/yyyy\";\n\n    // LDAP GeneralizedTime Format\n    private final static String ldapGTFormat \u003d \"yyyyMMddHHmmssZ\";\n\n    private static Properties props;\n\n    private static UserMgr userMgr;\n\n    private static PDPadapter pdpadapter;\n\n    private User user;\n\n    private LdapService lservice;\n\n    private static Logger cat \u003d Logger.getLogger(Login.class.getName());\n\n    /**\n     * Public default constructor\n     */\n    public Login() {\n    }\n\n    /**\n     * Construct a Login with a UserId\n     */\n    public Login(String userId) {\n        this();\n        this.setUserId(userId);\n    }\n\n    /**\n     * Construct a Login with a UserId and IP Address\n     */\n    public Login(String userId, String ipAddr) {\n        this(userId);\n        this.setIpAddr(ipAddr);\n    }\n\n    /**\n     * @param theConfigFile the properties file\n     */\n    public static void setConfigFile(String theConfigFile) {\n        configFile \u003d theConfigFile;\n    }\n\n    /**\n     * Load and get the Properties from the Config File\n     * @param theConfigFile the properties file\n     */\n    public static Properties getProps(String theConfigFile) {\n        setConfigFile(theConfigFile);\n        return getProps();\n    }\n\n    /**\n     * Load and get the Properties from the preset Config File\n     */\n    public static Properties getProps() {\n        init();\n        return props;\n    }\n\n    /**\n     * Initialize and load all the users.\n     */\n    public static String getSecurityLogFilePath() {\n        return securityLogFilePath;\n    }\n\n    public static void init() {\n        if (props !\u003d null)\n            return;\n        props \u003d new Properties();\n        cat.info(\"Loading Properties from \" + configFile);\n        loadProperties(props, configFile);\n        // set the default organization and country\n        organization \u003d props.getProperty(\"organization\", \"OPENHRE\");\n        country \u003d props.getProperty(\"country\", \"US\");\n        authType \u003d props.getProperty(\"AuthType\", \"simple\");\n        xacmlConfig \u003d props.getProperty(\"XACMLConfig\", \"\");\n        cat.info(\"organization is \" + organization);\n        cat.info(\"country is \" + country);\n        cat.info(\"AuthType is \" + authType);\n        cat.info(\"XACMLConfig is \" + xacmlConfig);\n        securityLog \u003d props.getProperty(\"SecurityLog\", \"\");\n        // create security log file if it doesn\u0027t exist\n        try {\n            File file \u003d new File(securityLog);\n            securityLogFilePath \u003d file.getAbsolutePath();\n            cat.info(\"Preparing Security Log file \" + securityLogFilePath);\n            // Create file if it does not exist\n            file.createNewFile();\n            // Get the XACML PDPadapter\n            pdpadapter \u003d new PDPadapter(xacmlConfig);\n        } catch (Exception e) {\n            cat.fatal(\"Exception initializing Login manager\", e);\n            e.printStackTrace();\n        }\n        if (userMgr \u003d\u003d null) {\n            if (authType.equals(\"simple\")) {\n                userMgr \u003d new SimpleUserMgr(configFile);\n            } else if (authType.equals(\"krb5\")) {\n                userMgr \u003d new KrbUserMgr();\n            }\n        }\n    }\n\n    public static void loadProperties(Properties props, String configFile) {\n        try {\n            props.load(Login.class.getResourceAsStream(configFile + \".properties\"));\n        } catch (Exception e) {\n            System.out.println(\"Could not read \" + configFile + \".properties\");\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * set the username  and get the user corresponding to the resulting dn\n     * @param username\n     */\n    public void setUsername(String username) {\n        //\t\tSystem.out.println(\"setting username: \" +username);\n        //        user \u003d null;\n        this.username \u003d username.trim();\n        //user \u003d userMgr.getUser(username, organization);\n        user.setUserName(username);\n        cat.debug(\"setUserName: \" + username);\n    }\n\n    /**\n     * Get filepath of security log.\n     * ASSUMPTION: init() was called (i.e. securityLog was initialized)\n     * @return absolute filepath\n     */\n    /**\n     * get the current username  from user if defined\n     */\n    public String getUsername() {\n        if (user !\u003d null)\n            return user.getUserName();\n        else\n            return username;\n    }\n\n    /**\n     * set ipAddr for login\n     * @param ipAddr\n     */\n    public void setIpAddr(String ipAddr) {\n        this.ipAddr \u003d ipAddr;\n        if (user !\u003d null)\n            user.setIpAddr(ipAddr);\n    }\n\n    /**\n     * get ipAddress of user if defined\n     * return String\n     */\n    public String getIpAddr() {\n        if (user !\u003d null)\n            return user.getIpAddr();\n        else\n            return ipAddr;\n    }\n\n    /**\n     * set the password\n     * @param password\n     */\n    public void setPassword(String password) {\n        this.password \u003d password;\n    }\n\n    /**\n     *  set the email address\n     * @param email address\n     */\n    /*    public void setEmail(String email) {\n//\t\tSystem.out.println(\"setting email: \"+email);\n        this.email \u003d email;\n        if (user !\u003d null) user.setUserId(email);\n    }\n*/\n    /**\n     * set the active user from the userId\n     * @param userId\n     */\n    public void setUserId(String usrId) {\n        userid \u003d usrId;\n        cat.debug(\"setUserId: \" + userid);\n    }\n\n    /**\n     * get the current User\n     */\n    public User getUser() {\n        return user;\n    }\n\n    /**\n     * get the current User ID\n     */\n    public String getUserId() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current email address\n     */\n    public String getEmail() {\n        //getUser();\n        if (user !\u003d null)\n            return user.getUserId();\n        else\n            return null;\n    }\n\n    /**\n     * get the current LdapService\n     */\n    public LdapService getLdapService() {\n        if (lservice \u003d\u003d null)\n            return (lservice \u003d new LdapService(user.getLdapContext()));\n        else\n            return lservice;\n    }\n\n    /**\n     * get the User from one of two ways. Return the current user if it is already defined.\n     * First see if there is a defined email address (userId) and get the user directly\n     * If not, then check the organization table and the the associated table of username\n     * using the username and organization (country is defaulted to \"US\").\n     */\n    /*    public User getUser() {\n        //   try {\n        // makeDN();\n        if (user !\u003d null) return user;\n        if (userid !\u003d null || userid !\u003d \"\")\n            user \u003d userMgr.getUser(userid);\n        else\n            user \u003d userMgr.getUser(username, organization, userid);\n        cat.debug(\"getUser: \"+user);\n        return user;\n\n    }\n*/\n    /**\n     * return the role of the current user.\n     * @return String containing the Role of the current user\n     *     /\n     *    public String getRole() {\n     *        if (user !\u003d null)\n     *            return user.getRole();\n     *        else\n     *            return null;\n     *    }\n     *\n     *    /**\n     * get the Distinguished Name of the user\n     * @return String containing the distinguished name\n     *     /\n     *    public String getDN() {\n     *        if (user !\u003d null)\n     *            return user.getDN();\n     *        else\n     *            return null;\n     *    }\n     */\n    /**\n     * Authorize a User without checking the password.\n     * Note that this should only be called for Users\n     * that are already Authenticated.\n     * @return user\n     */\n    public User authorize() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        user \u003d userMgr.getUser(this.userid);\n        user.setIpAddr(this.ipAddr);\n        // compare password validity start date with current date\n        Date today \u003d new Date();\n        Date pwvd \u003d null;\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\"))) {\n            pwvd \u003d convertDateFromUTC(user.getPassvalidstart());\n            if (!dateCompare(pwvd, today)) {\n                log(user, \"Not allowed to login currently.\");\n                user \u003d null;\n                throw new LoginException(\"Not allowed to login currently.\");\n            }\n        }\n        // check if user needs to change password before proceeding\n        user.setPasschange(false);\n        if ((user.getPassvalidstart() !\u003d null) \u0026\u0026 (user.getPassrenewal() !\u003d null) \u0026\u0026 (!user.getPassvalidstart().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"\")) \u0026\u0026 (!user.getPassrenewal().equals(\"-1\"))) {\n            Calendar c1 \u003d Calendar.getInstance();\n            c1.setTime(pwvd);\n            c1.add(Calendar.DATE, Integer.parseInt(user.getPassrenewal()));\n            if (dateCompare(c1.getTime(), today)) {\n                user.setPasschange(true);\n            }\n        }\n        // Performing IP based filtering and active groups determination\n        // based on current location.\n        // Make sure that AuthType\u003dkrb5 and IPfiltering\u003dyes in the properties file.\n        if ((user.getAllowedips() !\u003d null) \u0026\u0026 (props.getProperty(\"AuthType\", \"krb5\").equals(\"krb5\")) \u0026\u0026 (props.getProperty(\"IPfiltering\", \"yes\").equals(\"yes\"))) {\n            int currentip \u003d getIpInteger(user.getIpAddr());\n            // IP based filtering\n            cat.info(\"Performing IP filtering for \" + getUserId());\n            boolean ipcheck_result \u003d ipRangeCheck(user.getAllowedips(), currentip);\n            if (ipcheck_result \u003d\u003d false) {\n                log(user, \"Not authorized from the current IP address.\");\n                throw new LoginException(\"Not authorized from the current IP address.\");\n            }\n            // Active groups determination\n            cat.info(\"Determining active groups for \" + getUserId());\n            boolean faccheck_result;\n            // get all groups from LDAPservice\n            Set usergrps \u003d user.getGroups();\n            if (usergrps !\u003d null \u0026\u0026 usergrps.size() \u003e 0) {\n                // Setup the interface to the LDAP server\n                getLdapService();\n                //session.setAttribute(\"ldapservice\", lservice);\n                Iterator grpit \u003d usergrps.iterator();\n                while (grpit.hasNext()) {\n                    // Fetch each group\u0027s details from LDAP\n                    Group grp \u003d (Group) lservice.getGroup(grpit.next().toString());\n                    faccheck_result \u003d ipRangeCheck(grp.getAllowedips(), currentip);\n                    if (faccheck_result \u003d\u003d true) {\n                        log(user, \"Active group: \" + grp.getCn());\n                        user.addActivegroup(grp.getCn());\n                    }\n                }\n                if (user.getActivegroups() \u003d\u003d null || user.getActivegroups().size() \u003d\u003d 0) {\n                    log(user, \" Accessing from remote location.\");\n                    user.addActivegroup(\"remote\");\n                }\n            }\n        }\n        // end IP based filtering and Active groups determination\n        return user;\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate(String userid, String password, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.password \u003d password;\n        this.ipAddr \u003d ipaddr;\n        return authenticate();\n    }\n\n    /**\n     * Authorize a pre-Authenticated User\n     * @return user\n     */\n    public User authorize(String userid, String ipaddr) throws LoginException {\n        this.userid \u003d userid;\n        this.ipAddr \u003d ipaddr;\n        return authorize();\n    }\n\n    /**\n     * Authenticate the user by checking the password\n     * and then Authorize them.\n     * @return user\n     */\n    public User authenticate() throws LoginException {\n        user \u003d null;\n        if (userMgr \u003d\u003d null)\n            throw new LoginException(\"UserMgr undefined\");\n        if (password \u003d\u003d null)\n            throw new LoginException(\"Password not supplied\");\n        if (!userMgr.checkSecret(userid, password, authType)) {\n            cat.warn(\"Invalid Password! User: \" + username + \" ,userid: \" + userid);\n            throw new LoginException(\"Password invalid\");\n        }\n        user \u003d userMgr.getUser();\n        user.setIpAddr(this.ipAddr);\n        authorize();\n        return user;\n    }\n\n    /**\n     * check permissions for the current user\n     */\n    public boolean accessDecision(User usr, String resource, String action) {\n        if (\"simple\".equals(authType)) {\n            cat.debug(\"accessDecision() always true for simple authType\");\n            return true;\n        }\n        if (cat.isDebugEnabled()) {\n            cat.debug(\"User for accessDecision() is \" + usr);\n            cat.debug(\"resource is \" + resource);\n            cat.debug(\"action is \" + action);\n            cat.debug(\"XACMLConfig is \" + xacmlConfig);\n        }\n        if (usr \u003d\u003d null)\n            return false;\n        boolean ac_result \u003d false;\n        try {\n            // create XACML request\n            RequestCtx request \u003d new RequestCtx(RequestBuilder.setupSubjects(usr.getUserId(), usr.getRoles(), usr.getActivegroups() \u003d\u003d null ? usr.getGroups() : usr.getActivegroups()), RequestBuilder.setupResource(resource), RequestBuilder.setupAction(action), new HashSet());\n            // encode the Request and print it to standard out\n            request.encode(System.out, new Indenter());\n            if (pdpadapter.makeDecision(request) \u003d\u003d 0)\n                ac_result \u003d true;\n            else\n                ac_result \u003d false;\n            cat.debug(\"Access Decision: \" + ac_result);\n        } catch (Exception e) {\n            cat.error(e);\n            e.printStackTrace();\n        }\n        return ac_result;\n    }\n\n    public void log(User user, String info) {\n        FileAppender appender \u003d null;\n        try {\n            appender \u003d new FileAppender(new SimpleLayout(), securityLog, true);\n        } catch (Exception e) {\n            cat.error(e);\n        }\n        cat.addAppender(appender);\n        Level oldlevel \u003d cat.getLevel();\n        cat.setLevel((Level) Level.INFO);\n        Date now \u003d new Date();\n        if (user \u003d\u003d null) {\n            cat.info(now + \" - \" + username + \" - \" + userid + \" - \" + ipAddr + \" -- \" + info);\n        } else {\n            // new log format (for better parsing in Cocoon)\n            cat.info(now + \" - \" + user.getUserName() + \" - \" + user.getUserId() + \" - \" + user.getIpAddr() + \" -- \" + info);\n        }\n        cat.setLevel(oldlevel);\n        cat.removeAppender(appender);\n    }\n\n    /**\n     * logout the current user\n     */\n    public void logOut() {\n        userMgr.logOut();\n        user \u003d null;\n        password \u003d null;\n        username \u003d null;\n    }\n\n    private Date convertDateFromUTC(String specdatetime) {\n        // Extract from LDAP GeneralizedTime format and Convert date\n        // and time from UTC time to local time\n        TimeZone localtime \u003d TimeZone.getDefault();\n        SimpleDateFormat df1 \u003d new SimpleDateFormat(appDateFormat);\n        df1.setTimeZone(localtime);\n        SimpleDateFormat df2 \u003d new SimpleDateFormat(ldapGTFormat);\n        Date specdate \u003d null;\n        try {\n            specdate \u003d df2.parse(specdatetime);\n        } catch (ParseException pe) {\n            pe.printStackTrace();\n        }\n        return specdate;\n    }\n\n    private boolean dateCompare(Date date1, Date date2) {\n        Calendar c1 \u003d Calendar.getInstance();\n        Calendar c2 \u003d Calendar.getInstance();\n        c1.setTime(date1);\n        c2.setTime(date2);\n        if (c1.before(c2))\n            return true;\n        else\n            return false;\n    }\n\n    private int getIpInteger(String ip) {\n        StringTokenizer st \u003d new StringTokenizer(ip, \".\");\n        int bitposition \u003d 24;\n        int ipnumber \u003d 0;\n        while (st.hasMoreTokens()) {\n            String curtoken \u003d st.nextToken();\n            if (ipnumber \u003d\u003d 0)\n                ipnumber \u003d (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            else\n                ipnumber \u003d ipnumber | (Integer.parseInt(curtoken) \u003c\u003c bitposition);\n            bitposition -\u003d 8;\n        }\n        return ipnumber;\n    }\n\n    private boolean ipRangeCheck(Set allowedips, int currentip) {\n        // Check if the current IP address falls between the given range of allowed IP addresses\n        boolean ipmatch \u003d false;\n        if (allowedips \u003d\u003d null) {\n            cat.debug(\"No IP address range specified.\");\n            return false;\n        }\n        Set allowed_ips \u003d new HashSet();\n        allowed_ips \u003d (HashSet) allowedips;\n        Iterator ipit \u003d allowed_ips.iterator();\n        while (ipit.hasNext()) {\n            int finalip \u003d 0;\n            // subnet mask bits\n            int n \u003d 0;\n            // get the IP address and the subnet mask bits (if any)\n            StringTokenizer st \u003d new StringTokenizer(ipit.next().toString(), \"/\");\n            if (st.hasMoreTokens()) {\n                finalip \u003d getIpInteger(st.nextToken());\n                if (st.hasMoreTokens())\n                    n \u003d Integer.parseInt(st.nextToken());\n            }\n            // Every IP address allowed for the user\n            if (finalip \u003d\u003d 0) {\n                cat.info(\"All IP addresses allowed.\");\n                ipmatch \u003d true;\n            }\n            if (n !\u003d 0) {\n                // compute an n bit subnet mask, all 1s except for last n bits.\n                int subnet \u003d ~((1 \u003c\u003c n) - 1);\n                int t1 \u003d finalip \u0026 subnet;\n                int t2 \u003d currentip \u0026 subnet;\n                if (t1 \u003d\u003d t2)\n                    ipmatch \u003d true;\n            } else {\n                if (finalip \u003d\u003d currentip)\n                    ipmatch \u003d true;\n            }\n        }\n        return ipmatch;\n    }\n\n    /**\n     * Change the User\u0027s password\n     * (this should be moved to KrbUserMgr)\n     */\n    public void changePassword(String newpass) throws Exception {\n        // read the configuration properties\n        if (cat.isDebugEnabled())\n            cat.debug(\"using props \" + props);\n        String krbrealm \u003d props.getProperty(\"krbrealm\", \"YOUR-KERBEROS-REALM\");\n        String editkrb \u003d props.getProperty(\"editkrb\", \"no\");\n        String kadminLocal \u003d props.getProperty(\"kadmin.local\", \"kadmin.local\");\n        int exitVal \u003d 0;\n        String userid \u003d user.getUserId();\n        // strip only the unique username from the userid\n        int ind \u003d userid.indexOf(\"@\");\n        if (ind \u003e 0)\n            userid \u003d userid.substring(0, ind);\n        cat.debug(\"editkrb: \" + editkrb);\n        if (editkrb.toLowerCase().equals(\"yes\")) {\n            // Execute the UNIX command to reset the principal\u0027s password in the Kerberos\n            // database.\n            // Assumption: The web server and the kerberos server are running on the same UNIX\n            // based machine.Otherwise please modify the following according to your settings.\n            String krbprinc \u003d userid + \"@\" + krbrealm;\n            cat.info(\"Reseting principal \\\"\" + krbprinc + \"\\\"\u0027s password in \" + \"the Kerberos database\");\n            Runtime rt \u003d Runtime.getRuntime();\n            // Create a String array consisting of the command and its arguments\n            String[] cmd \u003d { kadminLocal, \"-p \" + userid, \"-q \\\"\\\"cpw -pw \" + newpass + \" \" + krbprinc + \"\\\"\\\"\" };\n            cat.debug(\"exec\u0027ing Runtime command: \" + cmd[0] + \u0027 \u0027 + cmd[1] + \u0027 \u0027 + cmd[2]);\n            Process ps \u003d rt.exec(cmd);\n            // For printing error messages\n            StreamHandler errorHandler \u003d new StreamHandler(ps.getErrorStream(), \"ERROR\");\n            // For printing output\n            StreamHandler outputHandler \u003d new StreamHandler(ps.getInputStream(), \"OUTPUT\");\n            // Start printing\n            errorHandler.start();\n            outputHandler.start();\n            // Print exit value\n            exitVal \u003d ps.waitFor();\n            cat.debug(\"Kerberos update status: \" + exitVal);\n        }\n        if (exitVal \u003d\u003d 0) {\n            getLdapService();\n            Person person \u003d lservice.getPerson(userid);\n            person.setPasschange(\"no\");\n            // Put current date as password valid start date\n            Date today \u003d new Date();\n            SimpleDateFormat sdf \u003d new SimpleDateFormat(ldapGTFormat);\n            person.setPassvalidstart(sdf.format(today));\n            if (lservice.updatePerson(person, person.getDn()) \u003d\u003d true) {\n            } else\n                throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n        } else\n            throw new LoginException(\"Cannot update your profile. Please contact the administrator!\");\n    }\n    /*  /** obtain list of valid users\n     * @return String[] list of known users\n     /\n    public static String[] getNames() {\n        if (names \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            names \u003d userMgr.getUserNames();\n        }\n\n        return names;\n    }\n\n    /**\n     * return known email addresses\n     * @return String[] list of known emails\n     /\n    public static String[] getMail() {\n        if (mail \u003d\u003d null) {\n            if (userMgr \u003d\u003d null) init();\n            mail \u003d userMgr.getUserIds();\n        }\n        /*\n        {\n            if (id \u003d\u003d null) init();\n            ArrayList v \u003d null;\n            try {\n                JDBMEnumeration e \u003d id.keys();\n                v \u003d new ArrayList();\n                while (e.hasMoreElements()) {\n                    v.add(e.nextElement());\n                }\n            } catch (IOException e1) {\n                cat.error(\"getMail: \" + e1);\n                return new String[0];\n            }\n            mail \u003d new String[v.size()];\n            cat.debug(\"getMail: \"+mail.length+ \" elements\");\n            v.toArray(mail);\n        }  /\n        return mail;\n    }\n\n\n    /**\n     *  set the SimpleUserMgr containing the Users.\n     * @param theUserMgr to be used\n     /\n    public static void setUserMgr(UserMgr theUserMgr) {\n        userMgr \u003d theUserMgr;\n    }\n\n    /**\n     * get the SimpleUserMgr that contains the Users\n     * @return SimpleUserMgr\n     /\n    public static SimpleUserMgr getUserMgr() {\n        return userMgr;\n    }\n\n    /**\n     * get all the users in memory\n     * @return String\n     /\n    public String toString() {\n        return userMgr.export();\n        /*\n        StringBuffer buff \u003d new StringBuffer();\n        try {\n            JDBMEnumeration c \u003d id.values();\n            while (c.hasMoreElements()) {\n                buff.append(c.nextElement().toString() + \u0027\\n\u0027);\n            }\n        } catch (IOException e) {\n            cat.error(\"getUsers: \" + e);\n        }\n        return buff.toString();\n        /\n    }\n\n    /**\n     * test program\n     /\n    public static void main(String[] argv) {\n        Login login \u003d new Login();\n      //  SimpleUserMgr.setConfigFile(argv[0]);\n        // SimpleUserMgr usrMgr \u003d new SimpleUserMgr(argv[0]);\n        // usrMgr.init();\n        login.setConfigFile(argv[0]);\n        login.init();\n        login.getUserMgr().addUser(\"cn\u003dJim Smith, o\u003dLANL, c\u003dUS\", \"Jim Smith\", \"Smith\", \"smith@foo.com\", \"submitter\", \"junk\");\n        login.getUserMgr().addUser(\"dn: cn\u003dDave Barry, o\u003dUNM, c\u003dUS\\ncn: Dave Barry\\nemail: barry@goofoff.com\\nsn: Barry\\nuserPassword: stuff\\nrole: staff\");\n\n        login.setUsername(\"Dave Barry\");\n        login.setOrg(\"UNM\");\n        login.setUsername(\"Dave Barry\");\n        cat.debug(login.getUser());\n        login.getUserMgr().delUser(\"smith@foo.com\");\n        String[] mail \u003d Login.getMail();\n        cat.debug(\"Mail: \"+mail[0]);\n        cat.debug(login.getUserMgr().getMailbyOrg(\"LANL\"));\n        String[] names \u003d Login.getNames();\n        cat.debug(\"names: \"+names[0]);\n        System.out.println(login.toString());\n\n    } */\n}\n",
    "package": "com.browsersoft.aacs",
    "classname": "Login",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/aacs/Login_6Test.java",
    "test_prompt": "// Login_6Test.java\npackage com.browsersoft.aacs;\n\nimport java.io.File;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Properties;\nimport java.util.Set;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport javax.security.auth.login.LoginException;\nimport org.apache.log4j.FileAppender;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.SimpleLayout;\nimport com.browsersoft.aacs.xacml.PDPadapter;\nimport com.browsersoft.aacs.xacml.RequestBuilder;\nimport com.sun.xacml.Indenter;\nimport com.sun.xacml.ctx.RequestCtx;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link Login}.\n* It contains ten unit test cases for the {@link Login#authenticate()} method.\n*/\nclass Login_6Test {",
    "method_signature": "authenticate()",
    "suffix": "6"
  },
  {
    "numberTests": "ten",
    "original_code": "// AACSLoginModule.java\n/*\n *   CVS $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\n\n/**\n * \u003cp\u003e This sample LoginModule authenticates users with a password.\n *\n * \u003cp\u003e This LoginModule only recognizes one user:\ttestUser\n * \u003cp\u003e testUser\u0027s password is:\ttestPassword\n *\n * \u003cp\u003e If testUser successfully authenticates itself,\n * an \u003ccode\u003eAACSPrincipal\u003c/code\u003e with the testUser\u0027s user name\n * is added to the Subject.\n *\n * \u003cp\u003e This LoginModule recognizes the debug option.\n * If set to true in the login Configuration,\n * debug messages will be output to the output stream, System.out.\n *\n * \u003cp\u003e The config option specifies the AACS Properties file,\n * without the assumed \".properties\" suffix.\n *\n * @version $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n */\npublic class AACSLoginModule implements LoginModule {\n\n    // initial state\n    private Subject subject;\n\n    private CallbackHandler callbackHandler;\n\n    // shared between the LoginModules\n    private Map sharedState;\n\n    private Map options;\n\n    // configurable option\n    private boolean debug \u003d false;\n\n    // the authentication status\n    private boolean succeeded \u003d false;\n\n    private boolean commitSucceeded \u003d false;\n\n    // username and password\n    private String username;\n\n    private char[] password;\n\n    // Principals\n    private AACSUserPrincipal userPrincipal;\n\n    private AACSRolePrincipal rolePrincipal;\n\n    // AACS Beans\n    private User user;\n\n    private Login login;\n\n    // Default and actual AACS properties file\n    private final static String aacsProps \u003d \"/AACS\";\n\n    private static String propsfile \u003d null;\n\n    /**\n     *  Initialize this \u003ccode\u003eLoginModule\u003c/code\u003e.\n     *\n     *  \u003cp\u003e\n     *\n     *  @param subject the \u003ccode\u003eSubject\u003c/code\u003e to be authenticated. \u003cp\u003e\n     *\n     *  @param callbackHandler a \u003ccode\u003eCallbackHandler\u003c/code\u003e for communicating\n     * \t\t\twith the end user (prompting for user names and\n     * \t\t\tpasswords, for example). \u003cp\u003e\n     *\n     *  @param sharedState shared \u003ccode\u003eLoginModule\u003c/code\u003e state. \u003cp\u003e\n     *\n     *  @param options options specified in the login\n     * \t\t\t\u003ccode\u003eConfiguration\u003c/code\u003e for this particular\n     * \t\t\t\u003ccode\u003eLoginModule\u003c/code\u003e.\n     */\n    public void initialize(Subject subject, CallbackHandler callbackHandler, Map sharedState, Map options) {\n        this.subject \u003d subject;\n        this.callbackHandler \u003d callbackHandler;\n        this.sharedState \u003d sharedState;\n        this.options \u003d options;\n        user \u003d null;\n        login \u003d null;\n        // initialize any configured options\n        debug \u003d \"true\".equalsIgnoreCase((String) options.get(\"debug\"));\n        if (propsfile \u003d\u003d null) {\n            // only do the first time\n            propsfile \u003d (String) options.get(\"config\");\n            if (propsfile \u003d\u003d null)\n                propsfile \u003d aacsProps;\n            Login.setConfigFile(propsfile);\n            Login.init();\n        }\n        if (debug)\n            System.out.println(\"AACSLoginModule initialized\");\n    }\n\n    /**\n     *  Authenticate the user with a user name and password.\n     *\n     *  \u003cp\u003e\n     *\n     *  @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tshould not be ignored.\n     *\n     *  @exception FailedLoginException if the authentication fails. \u003cp\u003e\n     *\n     *  @exception LoginException if this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tis unable to perform the authentication.\n     */\n    public boolean login() throws LoginException {\n        if (debug)\n            System.out.println(\"AACSLoginModule login() called\");\n        // prompt for a user name and password\n        if (callbackHandler \u003d\u003d null)\n            throw new LoginException(\"Error: no CallbackHandler available \" + \"to garner authentication information from the user\");\n        Callback[] callbacks \u003d new Callback[2];\n        callbacks[0] \u003d new NameCallback(\"user name: \");\n        callbacks[1] \u003d new PasswordCallback(\"password: \", false);\n        try {\n            callbackHandler.handle(callbacks);\n            username \u003d ((NameCallback) callbacks[0]).getName();\n            char[] tmpPassword \u003d ((PasswordCallback) callbacks[1]).getPassword();\n            if (tmpPassword \u003d\u003d null) {\n                // treat a NULL password as an empty password\n                tmpPassword \u003d new char[0];\n            }\n            password \u003d new char[tmpPassword.length];\n            System.arraycopy(tmpPassword, 0, password, 0, tmpPassword.length);\n            ((PasswordCallback) callbacks[1]).clearPassword();\n        } catch (java.io.IOException ioe) {\n            throw new LoginException(ioe.toString());\n        } catch (UnsupportedCallbackException uce) {\n            throw new LoginException(\"Error: \" + uce.getCallback().toString() + \" not available to garner authentication information \" + \"from the user\");\n        }\n        // print debugging information\n        if (debug) {\n            System.out.println(\"\\t\\t[AACSLoginModule] \" + \"user entered user name: \" + username);\n            System.out.print(\"\\t\\t[AACSLoginModule] \" + \"user entered password: \");\n            for (int i \u003d 0; i \u003c password.length; i++) System.out.print(password[i]);\n            System.out.println();\n        }\n        // verify the username/password\n        login \u003d new Login(username);\n        login.setPassword(new String(password));\n        user \u003d login.authenticate();\n        if (user !\u003d null) {\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication succeeded\");\n            succeeded \u003d true;\n            return true;\n        } else {\n            // authentication failed -- clean out state\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication failed\");\n            succeeded \u003d false;\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            throw new FailedLoginException(\"Login Incorrect\");\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication succeeded\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  succeeded).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e method), then this method associates a\n     *  \u003ccode\u003eAACSUserPrincipal\u003c/code\u003e and \u003ccode\u003eAACSRolePrincipal\u003c/code\u003e\n     *  with the \u003ccode\u003eSubject\u003c/code\u003e located in the\n     *  \u003ccode\u003eLoginModule\u003c/code\u003e.  If this LoginModule\u0027s own\n     *  authentication attempted failed, then this method removes\n     *  any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the commit fails.\n     *\n     *  @return true if this LoginModule\u0027s own login and commit\n     * \t\tattempts succeeded, or false otherwise.\n     */\n    public boolean commit() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else {\n            // add a Principal (authenticated identity)\n            // to the Subject\n            // add an AACSUserPrincipal to the Subject\n            userPrincipal \u003d new AACSUserPrincipal(username);\n            if (!subject.getPrincipals().contains(userPrincipal))\n                subject.getPrincipals().add(userPrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSUserPrincipal [\" + userPrincipal + \"] to Subject\");\n            }\n            // add the \"aacs_role\" to the Subject\n            rolePrincipal \u003d new AACSRolePrincipal(\"aacs_role\");\n            if (!subject.getPrincipals().contains(rolePrincipal))\n                subject.getPrincipals().add(rolePrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSRolePrincipal [\" + rolePrincipal + \"] to Subject\");\n            }\n            // in any case, clean out state\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            commitSucceeded \u003d true;\n            return true;\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication failed.\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  did not succeed).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e and \u003ccode\u003ecommit\u003c/code\u003e methods),\n     *  then this method cleans up any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the abort fails.\n     *\n     *  @return false if this LoginModule\u0027s own login and/or commit attempts\n     * \t\tfailed, and true otherwise.\n     */\n    public boolean abort() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else if (succeeded \u003d\u003d true \u0026\u0026 commitSucceeded \u003d\u003d false) {\n            // login succeeded but overall authentication failed\n            succeeded \u003d false;\n            username \u003d null;\n            if (password !\u003d null) {\n                for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n                password \u003d null;\n            }\n            userPrincipal \u003d null;\n            rolePrincipal \u003d null;\n        } else {\n            // overall authentication succeeded and commit succeeded,\n            // but someone else\u0027s commit failed\n            logout();\n        }\n        return true;\n    }\n\n    /**\n     * Logout the user.\n     *\n     * \u003cp\u003e This method removes the \u003ccode\u003eAACSPrincipal\u003c/code\u003e\n     * that was added by the \u003ccode\u003ecommit\u003c/code\u003e method.\n     *\n     * \u003cp\u003e\n     *\n     * @exception LoginException if the logout fails.\n     *\n     * @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     *          should not be ignored.\n     */\n    public boolean logout() throws LoginException {\n        subject.getPrincipals().remove(userPrincipal);\n        succeeded \u003d false;\n        succeeded \u003d commitSucceeded;\n        username \u003d null;\n        if (password !\u003d null) {\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n        }\n        userPrincipal \u003d null;\n        rolePrincipal \u003d null;\n        user \u003d null;\n        login \u003d null;\n        return true;\n    }\n}\n",
    "package": "com.browsersoft.jaas",
    "classname": "AACSLoginModule",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/jaas/AACSLoginModule_0Test.java",
    "test_prompt": "// AACSLoginModule_0Test.java\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link AACSLoginModule}.\n* It contains ten unit test cases for the {@link AACSLoginModule#login()} method.\n*/\nclass AACSLoginModule_0Test {",
    "method_signature": "login()",
    "suffix": "0"
  },
  {
    "numberTests": "ten",
    "original_code": "// AACSLoginModule.java\n/*\n *   CVS $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\n\n/**\n * \u003cp\u003e This sample LoginModule authenticates users with a password.\n *\n * \u003cp\u003e This LoginModule only recognizes one user:\ttestUser\n * \u003cp\u003e testUser\u0027s password is:\ttestPassword\n *\n * \u003cp\u003e If testUser successfully authenticates itself,\n * an \u003ccode\u003eAACSPrincipal\u003c/code\u003e with the testUser\u0027s user name\n * is added to the Subject.\n *\n * \u003cp\u003e This LoginModule recognizes the debug option.\n * If set to true in the login Configuration,\n * debug messages will be output to the output stream, System.out.\n *\n * \u003cp\u003e The config option specifies the AACS Properties file,\n * without the assumed \".properties\" suffix.\n *\n * @version $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n */\npublic class AACSLoginModule implements LoginModule {\n\n    // initial state\n    private Subject subject;\n\n    private CallbackHandler callbackHandler;\n\n    // shared between the LoginModules\n    private Map sharedState;\n\n    private Map options;\n\n    // configurable option\n    private boolean debug \u003d false;\n\n    // the authentication status\n    private boolean succeeded \u003d false;\n\n    private boolean commitSucceeded \u003d false;\n\n    // username and password\n    private String username;\n\n    private char[] password;\n\n    // Principals\n    private AACSUserPrincipal userPrincipal;\n\n    private AACSRolePrincipal rolePrincipal;\n\n    // AACS Beans\n    private User user;\n\n    private Login login;\n\n    // Default and actual AACS properties file\n    private final static String aacsProps \u003d \"/AACS\";\n\n    private static String propsfile \u003d null;\n\n    /**\n     *  Initialize this \u003ccode\u003eLoginModule\u003c/code\u003e.\n     *\n     *  \u003cp\u003e\n     *\n     *  @param subject the \u003ccode\u003eSubject\u003c/code\u003e to be authenticated. \u003cp\u003e\n     *\n     *  @param callbackHandler a \u003ccode\u003eCallbackHandler\u003c/code\u003e for communicating\n     * \t\t\twith the end user (prompting for user names and\n     * \t\t\tpasswords, for example). \u003cp\u003e\n     *\n     *  @param sharedState shared \u003ccode\u003eLoginModule\u003c/code\u003e state. \u003cp\u003e\n     *\n     *  @param options options specified in the login\n     * \t\t\t\u003ccode\u003eConfiguration\u003c/code\u003e for this particular\n     * \t\t\t\u003ccode\u003eLoginModule\u003c/code\u003e.\n     */\n    public void initialize(Subject subject, CallbackHandler callbackHandler, Map sharedState, Map options) {\n        this.subject \u003d subject;\n        this.callbackHandler \u003d callbackHandler;\n        this.sharedState \u003d sharedState;\n        this.options \u003d options;\n        user \u003d null;\n        login \u003d null;\n        // initialize any configured options\n        debug \u003d \"true\".equalsIgnoreCase((String) options.get(\"debug\"));\n        if (propsfile \u003d\u003d null) {\n            // only do the first time\n            propsfile \u003d (String) options.get(\"config\");\n            if (propsfile \u003d\u003d null)\n                propsfile \u003d aacsProps;\n            Login.setConfigFile(propsfile);\n            Login.init();\n        }\n        if (debug)\n            System.out.println(\"AACSLoginModule initialized\");\n    }\n\n    /**\n     *  Authenticate the user with a user name and password.\n     *\n     *  \u003cp\u003e\n     *\n     *  @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tshould not be ignored.\n     *\n     *  @exception FailedLoginException if the authentication fails. \u003cp\u003e\n     *\n     *  @exception LoginException if this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tis unable to perform the authentication.\n     */\n    public boolean login() throws LoginException {\n        if (debug)\n            System.out.println(\"AACSLoginModule login() called\");\n        // prompt for a user name and password\n        if (callbackHandler \u003d\u003d null)\n            throw new LoginException(\"Error: no CallbackHandler available \" + \"to garner authentication information from the user\");\n        Callback[] callbacks \u003d new Callback[2];\n        callbacks[0] \u003d new NameCallback(\"user name: \");\n        callbacks[1] \u003d new PasswordCallback(\"password: \", false);\n        try {\n            callbackHandler.handle(callbacks);\n            username \u003d ((NameCallback) callbacks[0]).getName();\n            char[] tmpPassword \u003d ((PasswordCallback) callbacks[1]).getPassword();\n            if (tmpPassword \u003d\u003d null) {\n                // treat a NULL password as an empty password\n                tmpPassword \u003d new char[0];\n            }\n            password \u003d new char[tmpPassword.length];\n            System.arraycopy(tmpPassword, 0, password, 0, tmpPassword.length);\n            ((PasswordCallback) callbacks[1]).clearPassword();\n        } catch (java.io.IOException ioe) {\n            throw new LoginException(ioe.toString());\n        } catch (UnsupportedCallbackException uce) {\n            throw new LoginException(\"Error: \" + uce.getCallback().toString() + \" not available to garner authentication information \" + \"from the user\");\n        }\n        // print debugging information\n        if (debug) {\n            System.out.println(\"\\t\\t[AACSLoginModule] \" + \"user entered user name: \" + username);\n            System.out.print(\"\\t\\t[AACSLoginModule] \" + \"user entered password: \");\n            for (int i \u003d 0; i \u003c password.length; i++) System.out.print(password[i]);\n            System.out.println();\n        }\n        // verify the username/password\n        login \u003d new Login(username);\n        login.setPassword(new String(password));\n        user \u003d login.authenticate();\n        if (user !\u003d null) {\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication succeeded\");\n            succeeded \u003d true;\n            return true;\n        } else {\n            // authentication failed -- clean out state\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication failed\");\n            succeeded \u003d false;\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            throw new FailedLoginException(\"Login Incorrect\");\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication succeeded\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  succeeded).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e method), then this method associates a\n     *  \u003ccode\u003eAACSUserPrincipal\u003c/code\u003e and \u003ccode\u003eAACSRolePrincipal\u003c/code\u003e\n     *  with the \u003ccode\u003eSubject\u003c/code\u003e located in the\n     *  \u003ccode\u003eLoginModule\u003c/code\u003e.  If this LoginModule\u0027s own\n     *  authentication attempted failed, then this method removes\n     *  any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the commit fails.\n     *\n     *  @return true if this LoginModule\u0027s own login and commit\n     * \t\tattempts succeeded, or false otherwise.\n     */\n    public boolean commit() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else {\n            // add a Principal (authenticated identity)\n            // to the Subject\n            // add an AACSUserPrincipal to the Subject\n            userPrincipal \u003d new AACSUserPrincipal(username);\n            if (!subject.getPrincipals().contains(userPrincipal))\n                subject.getPrincipals().add(userPrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSUserPrincipal [\" + userPrincipal + \"] to Subject\");\n            }\n            // add the \"aacs_role\" to the Subject\n            rolePrincipal \u003d new AACSRolePrincipal(\"aacs_role\");\n            if (!subject.getPrincipals().contains(rolePrincipal))\n                subject.getPrincipals().add(rolePrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSRolePrincipal [\" + rolePrincipal + \"] to Subject\");\n            }\n            // in any case, clean out state\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            commitSucceeded \u003d true;\n            return true;\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication failed.\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  did not succeed).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e and \u003ccode\u003ecommit\u003c/code\u003e methods),\n     *  then this method cleans up any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the abort fails.\n     *\n     *  @return false if this LoginModule\u0027s own login and/or commit attempts\n     * \t\tfailed, and true otherwise.\n     */\n    public boolean abort() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else if (succeeded \u003d\u003d true \u0026\u0026 commitSucceeded \u003d\u003d false) {\n            // login succeeded but overall authentication failed\n            succeeded \u003d false;\n            username \u003d null;\n            if (password !\u003d null) {\n                for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n                password \u003d null;\n            }\n            userPrincipal \u003d null;\n            rolePrincipal \u003d null;\n        } else {\n            // overall authentication succeeded and commit succeeded,\n            // but someone else\u0027s commit failed\n            logout();\n        }\n        return true;\n    }\n\n    /**\n     * Logout the user.\n     *\n     * \u003cp\u003e This method removes the \u003ccode\u003eAACSPrincipal\u003c/code\u003e\n     * that was added by the \u003ccode\u003ecommit\u003c/code\u003e method.\n     *\n     * \u003cp\u003e\n     *\n     * @exception LoginException if the logout fails.\n     *\n     * @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     *          should not be ignored.\n     */\n    public boolean logout() throws LoginException {\n        subject.getPrincipals().remove(userPrincipal);\n        succeeded \u003d false;\n        succeeded \u003d commitSucceeded;\n        username \u003d null;\n        if (password !\u003d null) {\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n        }\n        userPrincipal \u003d null;\n        rolePrincipal \u003d null;\n        user \u003d null;\n        login \u003d null;\n        return true;\n    }\n}\n",
    "package": "com.browsersoft.jaas",
    "classname": "AACSLoginModule",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/jaas/AACSLoginModule_1Test.java",
    "test_prompt": "// AACSLoginModule_1Test.java\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link AACSLoginModule}.\n* It contains ten unit test cases for the {@link AACSLoginModule#commit()} method.\n*/\nclass AACSLoginModule_1Test {",
    "method_signature": "commit()",
    "suffix": "1"
  },
  {
    "numberTests": "ten",
    "original_code": "// AACSLoginModule.java\n/*\n *   CVS $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\n\n/**\n * \u003cp\u003e This sample LoginModule authenticates users with a password.\n *\n * \u003cp\u003e This LoginModule only recognizes one user:\ttestUser\n * \u003cp\u003e testUser\u0027s password is:\ttestPassword\n *\n * \u003cp\u003e If testUser successfully authenticates itself,\n * an \u003ccode\u003eAACSPrincipal\u003c/code\u003e with the testUser\u0027s user name\n * is added to the Subject.\n *\n * \u003cp\u003e This LoginModule recognizes the debug option.\n * If set to true in the login Configuration,\n * debug messages will be output to the output stream, System.out.\n *\n * \u003cp\u003e The config option specifies the AACS Properties file,\n * without the assumed \".properties\" suffix.\n *\n * @version $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n */\npublic class AACSLoginModule implements LoginModule {\n\n    // initial state\n    private Subject subject;\n\n    private CallbackHandler callbackHandler;\n\n    // shared between the LoginModules\n    private Map sharedState;\n\n    private Map options;\n\n    // configurable option\n    private boolean debug \u003d false;\n\n    // the authentication status\n    private boolean succeeded \u003d false;\n\n    private boolean commitSucceeded \u003d false;\n\n    // username and password\n    private String username;\n\n    private char[] password;\n\n    // Principals\n    private AACSUserPrincipal userPrincipal;\n\n    private AACSRolePrincipal rolePrincipal;\n\n    // AACS Beans\n    private User user;\n\n    private Login login;\n\n    // Default and actual AACS properties file\n    private final static String aacsProps \u003d \"/AACS\";\n\n    private static String propsfile \u003d null;\n\n    /**\n     *  Initialize this \u003ccode\u003eLoginModule\u003c/code\u003e.\n     *\n     *  \u003cp\u003e\n     *\n     *  @param subject the \u003ccode\u003eSubject\u003c/code\u003e to be authenticated. \u003cp\u003e\n     *\n     *  @param callbackHandler a \u003ccode\u003eCallbackHandler\u003c/code\u003e for communicating\n     * \t\t\twith the end user (prompting for user names and\n     * \t\t\tpasswords, for example). \u003cp\u003e\n     *\n     *  @param sharedState shared \u003ccode\u003eLoginModule\u003c/code\u003e state. \u003cp\u003e\n     *\n     *  @param options options specified in the login\n     * \t\t\t\u003ccode\u003eConfiguration\u003c/code\u003e for this particular\n     * \t\t\t\u003ccode\u003eLoginModule\u003c/code\u003e.\n     */\n    public void initialize(Subject subject, CallbackHandler callbackHandler, Map sharedState, Map options) {\n        this.subject \u003d subject;\n        this.callbackHandler \u003d callbackHandler;\n        this.sharedState \u003d sharedState;\n        this.options \u003d options;\n        user \u003d null;\n        login \u003d null;\n        // initialize any configured options\n        debug \u003d \"true\".equalsIgnoreCase((String) options.get(\"debug\"));\n        if (propsfile \u003d\u003d null) {\n            // only do the first time\n            propsfile \u003d (String) options.get(\"config\");\n            if (propsfile \u003d\u003d null)\n                propsfile \u003d aacsProps;\n            Login.setConfigFile(propsfile);\n            Login.init();\n        }\n        if (debug)\n            System.out.println(\"AACSLoginModule initialized\");\n    }\n\n    /**\n     *  Authenticate the user with a user name and password.\n     *\n     *  \u003cp\u003e\n     *\n     *  @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tshould not be ignored.\n     *\n     *  @exception FailedLoginException if the authentication fails. \u003cp\u003e\n     *\n     *  @exception LoginException if this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tis unable to perform the authentication.\n     */\n    public boolean login() throws LoginException {\n        if (debug)\n            System.out.println(\"AACSLoginModule login() called\");\n        // prompt for a user name and password\n        if (callbackHandler \u003d\u003d null)\n            throw new LoginException(\"Error: no CallbackHandler available \" + \"to garner authentication information from the user\");\n        Callback[] callbacks \u003d new Callback[2];\n        callbacks[0] \u003d new NameCallback(\"user name: \");\n        callbacks[1] \u003d new PasswordCallback(\"password: \", false);\n        try {\n            callbackHandler.handle(callbacks);\n            username \u003d ((NameCallback) callbacks[0]).getName();\n            char[] tmpPassword \u003d ((PasswordCallback) callbacks[1]).getPassword();\n            if (tmpPassword \u003d\u003d null) {\n                // treat a NULL password as an empty password\n                tmpPassword \u003d new char[0];\n            }\n            password \u003d new char[tmpPassword.length];\n            System.arraycopy(tmpPassword, 0, password, 0, tmpPassword.length);\n            ((PasswordCallback) callbacks[1]).clearPassword();\n        } catch (java.io.IOException ioe) {\n            throw new LoginException(ioe.toString());\n        } catch (UnsupportedCallbackException uce) {\n            throw new LoginException(\"Error: \" + uce.getCallback().toString() + \" not available to garner authentication information \" + \"from the user\");\n        }\n        // print debugging information\n        if (debug) {\n            System.out.println(\"\\t\\t[AACSLoginModule] \" + \"user entered user name: \" + username);\n            System.out.print(\"\\t\\t[AACSLoginModule] \" + \"user entered password: \");\n            for (int i \u003d 0; i \u003c password.length; i++) System.out.print(password[i]);\n            System.out.println();\n        }\n        // verify the username/password\n        login \u003d new Login(username);\n        login.setPassword(new String(password));\n        user \u003d login.authenticate();\n        if (user !\u003d null) {\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication succeeded\");\n            succeeded \u003d true;\n            return true;\n        } else {\n            // authentication failed -- clean out state\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication failed\");\n            succeeded \u003d false;\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            throw new FailedLoginException(\"Login Incorrect\");\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication succeeded\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  succeeded).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e method), then this method associates a\n     *  \u003ccode\u003eAACSUserPrincipal\u003c/code\u003e and \u003ccode\u003eAACSRolePrincipal\u003c/code\u003e\n     *  with the \u003ccode\u003eSubject\u003c/code\u003e located in the\n     *  \u003ccode\u003eLoginModule\u003c/code\u003e.  If this LoginModule\u0027s own\n     *  authentication attempted failed, then this method removes\n     *  any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the commit fails.\n     *\n     *  @return true if this LoginModule\u0027s own login and commit\n     * \t\tattempts succeeded, or false otherwise.\n     */\n    public boolean commit() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else {\n            // add a Principal (authenticated identity)\n            // to the Subject\n            // add an AACSUserPrincipal to the Subject\n            userPrincipal \u003d new AACSUserPrincipal(username);\n            if (!subject.getPrincipals().contains(userPrincipal))\n                subject.getPrincipals().add(userPrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSUserPrincipal [\" + userPrincipal + \"] to Subject\");\n            }\n            // add the \"aacs_role\" to the Subject\n            rolePrincipal \u003d new AACSRolePrincipal(\"aacs_role\");\n            if (!subject.getPrincipals().contains(rolePrincipal))\n                subject.getPrincipals().add(rolePrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSRolePrincipal [\" + rolePrincipal + \"] to Subject\");\n            }\n            // in any case, clean out state\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            commitSucceeded \u003d true;\n            return true;\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication failed.\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  did not succeed).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e and \u003ccode\u003ecommit\u003c/code\u003e methods),\n     *  then this method cleans up any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the abort fails.\n     *\n     *  @return false if this LoginModule\u0027s own login and/or commit attempts\n     * \t\tfailed, and true otherwise.\n     */\n    public boolean abort() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else if (succeeded \u003d\u003d true \u0026\u0026 commitSucceeded \u003d\u003d false) {\n            // login succeeded but overall authentication failed\n            succeeded \u003d false;\n            username \u003d null;\n            if (password !\u003d null) {\n                for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n                password \u003d null;\n            }\n            userPrincipal \u003d null;\n            rolePrincipal \u003d null;\n        } else {\n            // overall authentication succeeded and commit succeeded,\n            // but someone else\u0027s commit failed\n            logout();\n        }\n        return true;\n    }\n\n    /**\n     * Logout the user.\n     *\n     * \u003cp\u003e This method removes the \u003ccode\u003eAACSPrincipal\u003c/code\u003e\n     * that was added by the \u003ccode\u003ecommit\u003c/code\u003e method.\n     *\n     * \u003cp\u003e\n     *\n     * @exception LoginException if the logout fails.\n     *\n     * @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     *          should not be ignored.\n     */\n    public boolean logout() throws LoginException {\n        subject.getPrincipals().remove(userPrincipal);\n        succeeded \u003d false;\n        succeeded \u003d commitSucceeded;\n        username \u003d null;\n        if (password !\u003d null) {\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n        }\n        userPrincipal \u003d null;\n        rolePrincipal \u003d null;\n        user \u003d null;\n        login \u003d null;\n        return true;\n    }\n}\n",
    "package": "com.browsersoft.jaas",
    "classname": "AACSLoginModule",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/jaas/AACSLoginModule_2Test.java",
    "test_prompt": "// AACSLoginModule_2Test.java\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link AACSLoginModule}.\n* It contains ten unit test cases for the {@link AACSLoginModule#abort()} method.\n*/\nclass AACSLoginModule_2Test {",
    "method_signature": "abort()",
    "suffix": "2"
  },
  {
    "numberTests": "ten",
    "original_code": "// AACSLoginModule.java\n/*\n *   CVS $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n * \n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *                 Open Source Health Records Exchange\n *   \u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n *\n *   Copyright (C) 2005 Browsersoft Inc.\n *\n *   This program is free software; you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License, version 2, \n *   as published by the Free Software Foundation.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   The GNU General Public License is available at\n *   http://www.fsf.org/licensing/licenses/gpl.html\n *\n *   Email: info@openhre.org\n *   Web:   http://www.openhre.org\n */\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\n\n/**\n * \u003cp\u003e This sample LoginModule authenticates users with a password.\n *\n * \u003cp\u003e This LoginModule only recognizes one user:\ttestUser\n * \u003cp\u003e testUser\u0027s password is:\ttestPassword\n *\n * \u003cp\u003e If testUser successfully authenticates itself,\n * an \u003ccode\u003eAACSPrincipal\u003c/code\u003e with the testUser\u0027s user name\n * is added to the Subject.\n *\n * \u003cp\u003e This LoginModule recognizes the debug option.\n * If set to true in the login Configuration,\n * debug messages will be output to the output stream, System.out.\n *\n * \u003cp\u003e The config option specifies the AACS Properties file,\n * without the assumed \".properties\" suffix.\n *\n * @version $Id: AACSLoginModule.java,v 1.1 2006/11/06 19:52:19 grodecki Exp $\n */\npublic class AACSLoginModule implements LoginModule {\n\n    // initial state\n    private Subject subject;\n\n    private CallbackHandler callbackHandler;\n\n    // shared between the LoginModules\n    private Map sharedState;\n\n    private Map options;\n\n    // configurable option\n    private boolean debug \u003d false;\n\n    // the authentication status\n    private boolean succeeded \u003d false;\n\n    private boolean commitSucceeded \u003d false;\n\n    // username and password\n    private String username;\n\n    private char[] password;\n\n    // Principals\n    private AACSUserPrincipal userPrincipal;\n\n    private AACSRolePrincipal rolePrincipal;\n\n    // AACS Beans\n    private User user;\n\n    private Login login;\n\n    // Default and actual AACS properties file\n    private final static String aacsProps \u003d \"/AACS\";\n\n    private static String propsfile \u003d null;\n\n    /**\n     *  Initialize this \u003ccode\u003eLoginModule\u003c/code\u003e.\n     *\n     *  \u003cp\u003e\n     *\n     *  @param subject the \u003ccode\u003eSubject\u003c/code\u003e to be authenticated. \u003cp\u003e\n     *\n     *  @param callbackHandler a \u003ccode\u003eCallbackHandler\u003c/code\u003e for communicating\n     * \t\t\twith the end user (prompting for user names and\n     * \t\t\tpasswords, for example). \u003cp\u003e\n     *\n     *  @param sharedState shared \u003ccode\u003eLoginModule\u003c/code\u003e state. \u003cp\u003e\n     *\n     *  @param options options specified in the login\n     * \t\t\t\u003ccode\u003eConfiguration\u003c/code\u003e for this particular\n     * \t\t\t\u003ccode\u003eLoginModule\u003c/code\u003e.\n     */\n    public void initialize(Subject subject, CallbackHandler callbackHandler, Map sharedState, Map options) {\n        this.subject \u003d subject;\n        this.callbackHandler \u003d callbackHandler;\n        this.sharedState \u003d sharedState;\n        this.options \u003d options;\n        user \u003d null;\n        login \u003d null;\n        // initialize any configured options\n        debug \u003d \"true\".equalsIgnoreCase((String) options.get(\"debug\"));\n        if (propsfile \u003d\u003d null) {\n            // only do the first time\n            propsfile \u003d (String) options.get(\"config\");\n            if (propsfile \u003d\u003d null)\n                propsfile \u003d aacsProps;\n            Login.setConfigFile(propsfile);\n            Login.init();\n        }\n        if (debug)\n            System.out.println(\"AACSLoginModule initialized\");\n    }\n\n    /**\n     *  Authenticate the user with a user name and password.\n     *\n     *  \u003cp\u003e\n     *\n     *  @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tshould not be ignored.\n     *\n     *  @exception FailedLoginException if the authentication fails. \u003cp\u003e\n     *\n     *  @exception LoginException if this \u003ccode\u003eLoginModule\u003c/code\u003e\n     * \t\tis unable to perform the authentication.\n     */\n    public boolean login() throws LoginException {\n        if (debug)\n            System.out.println(\"AACSLoginModule login() called\");\n        // prompt for a user name and password\n        if (callbackHandler \u003d\u003d null)\n            throw new LoginException(\"Error: no CallbackHandler available \" + \"to garner authentication information from the user\");\n        Callback[] callbacks \u003d new Callback[2];\n        callbacks[0] \u003d new NameCallback(\"user name: \");\n        callbacks[1] \u003d new PasswordCallback(\"password: \", false);\n        try {\n            callbackHandler.handle(callbacks);\n            username \u003d ((NameCallback) callbacks[0]).getName();\n            char[] tmpPassword \u003d ((PasswordCallback) callbacks[1]).getPassword();\n            if (tmpPassword \u003d\u003d null) {\n                // treat a NULL password as an empty password\n                tmpPassword \u003d new char[0];\n            }\n            password \u003d new char[tmpPassword.length];\n            System.arraycopy(tmpPassword, 0, password, 0, tmpPassword.length);\n            ((PasswordCallback) callbacks[1]).clearPassword();\n        } catch (java.io.IOException ioe) {\n            throw new LoginException(ioe.toString());\n        } catch (UnsupportedCallbackException uce) {\n            throw new LoginException(\"Error: \" + uce.getCallback().toString() + \" not available to garner authentication information \" + \"from the user\");\n        }\n        // print debugging information\n        if (debug) {\n            System.out.println(\"\\t\\t[AACSLoginModule] \" + \"user entered user name: \" + username);\n            System.out.print(\"\\t\\t[AACSLoginModule] \" + \"user entered password: \");\n            for (int i \u003d 0; i \u003c password.length; i++) System.out.print(password[i]);\n            System.out.println();\n        }\n        // verify the username/password\n        login \u003d new Login(username);\n        login.setPassword(new String(password));\n        user \u003d login.authenticate();\n        if (user !\u003d null) {\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication succeeded\");\n            succeeded \u003d true;\n            return true;\n        } else {\n            // authentication failed -- clean out state\n            if (debug)\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"authentication failed\");\n            succeeded \u003d false;\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            throw new FailedLoginException(\"Login Incorrect\");\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication succeeded\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  succeeded).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e method), then this method associates a\n     *  \u003ccode\u003eAACSUserPrincipal\u003c/code\u003e and \u003ccode\u003eAACSRolePrincipal\u003c/code\u003e\n     *  with the \u003ccode\u003eSubject\u003c/code\u003e located in the\n     *  \u003ccode\u003eLoginModule\u003c/code\u003e.  If this LoginModule\u0027s own\n     *  authentication attempted failed, then this method removes\n     *  any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the commit fails.\n     *\n     *  @return true if this LoginModule\u0027s own login and commit\n     * \t\tattempts succeeded, or false otherwise.\n     */\n    public boolean commit() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else {\n            // add a Principal (authenticated identity)\n            // to the Subject\n            // add an AACSUserPrincipal to the Subject\n            userPrincipal \u003d new AACSUserPrincipal(username);\n            if (!subject.getPrincipals().contains(userPrincipal))\n                subject.getPrincipals().add(userPrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSUserPrincipal [\" + userPrincipal + \"] to Subject\");\n            }\n            // add the \"aacs_role\" to the Subject\n            rolePrincipal \u003d new AACSRolePrincipal(\"aacs_role\");\n            if (!subject.getPrincipals().contains(rolePrincipal))\n                subject.getPrincipals().add(rolePrincipal);\n            if (debug) {\n                System.out.println(\"\\t\\t[AACSLoginModule] \" + \"added AACSRolePrincipal [\" + rolePrincipal + \"] to Subject\");\n            }\n            // in any case, clean out state\n            username \u003d null;\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n            commitSucceeded \u003d true;\n            return true;\n        }\n    }\n\n    /**\n     *  \u003cp\u003e This method is called if the LoginContext\u0027s\n     *  overall authentication failed.\n     *  (the relevant REQUIRED, REQUISITE, SUFFICIENT and OPTIONAL LoginModules\n     *  did not succeed).\n     *\n     *  \u003cp\u003e If this LoginModule\u0027s own authentication attempt\n     *  succeeded (checked by retrieving the private state saved by the\n     *  \u003ccode\u003elogin\u003c/code\u003e and \u003ccode\u003ecommit\u003c/code\u003e methods),\n     *  then this method cleans up any state that was originally saved.\n     *\n     *  \u003cp\u003e\n     *\n     *  @exception LoginException if the abort fails.\n     *\n     *  @return false if this LoginModule\u0027s own login and/or commit attempts\n     * \t\tfailed, and true otherwise.\n     */\n    public boolean abort() throws LoginException {\n        if (succeeded \u003d\u003d false) {\n            return false;\n        } else if (succeeded \u003d\u003d true \u0026\u0026 commitSucceeded \u003d\u003d false) {\n            // login succeeded but overall authentication failed\n            succeeded \u003d false;\n            username \u003d null;\n            if (password !\u003d null) {\n                for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n                password \u003d null;\n            }\n            userPrincipal \u003d null;\n            rolePrincipal \u003d null;\n        } else {\n            // overall authentication succeeded and commit succeeded,\n            // but someone else\u0027s commit failed\n            logout();\n        }\n        return true;\n    }\n\n    /**\n     * Logout the user.\n     *\n     * \u003cp\u003e This method removes the \u003ccode\u003eAACSPrincipal\u003c/code\u003e\n     * that was added by the \u003ccode\u003ecommit\u003c/code\u003e method.\n     *\n     * \u003cp\u003e\n     *\n     * @exception LoginException if the logout fails.\n     *\n     * @return true in all cases since this \u003ccode\u003eLoginModule\u003c/code\u003e\n     *          should not be ignored.\n     */\n    public boolean logout() throws LoginException {\n        subject.getPrincipals().remove(userPrincipal);\n        succeeded \u003d false;\n        succeeded \u003d commitSucceeded;\n        username \u003d null;\n        if (password !\u003d null) {\n            for (int i \u003d 0; i \u003c password.length; i++) password[i] \u003d \u0027 \u0027;\n            password \u003d null;\n        }\n        userPrincipal \u003d null;\n        rolePrincipal \u003d null;\n        user \u003d null;\n        login \u003d null;\n        return true;\n    }\n}\n",
    "package": "com.browsersoft.jaas",
    "classname": "AACSLoginModule",
    "id": "/EvoSuiteBenchmark/original/75_openhre/src/main/java/com/browsersoft/jaas/AACSLoginModule_3Test.java",
    "test_prompt": "// AACSLoginModule_3Test.java\npackage com.browsersoft.jaas;\n\nimport java.util.*;\nimport java.io.IOException;\nimport javax.security.auth.*;\nimport javax.security.auth.callback.*;\nimport javax.security.auth.login.*;\nimport javax.security.auth.spi.*;\nimport com.browsersoft.aacs.Login;\nimport com.browsersoft.aacs.User;\nimport org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\n/**\n* Test class of {@link AACSLoginModule}.\n* It contains ten unit test cases for the {@link AACSLoginModule#logout()} method.\n*/\nclass AACSLoginModule_3Test {",
    "method_signature": "logout()",
    "suffix": "3"
  }
]